[0m02:55:47.208840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2159d70d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2159f4d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d215c265100>]}


============================== 02:55:47.218269 | 298d2937-bc34-41d5-8646-995e069abc2d ==============================
[0m02:55:47.218269 [info ] [MainThread]: Running with dbt=1.11.6
[0m02:55:47.219263 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/root/.dbt', 'printer_width': '80', 'empty': 'None', 'no_print': 'None', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': 'logs', 'indirect_selection': 'eager', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True'}
[0m02:55:47.247550 [info ] [MainThread]: dbt version: 1.11.6
[0m02:55:47.248363 [info ] [MainThread]: python version: 3.12.12
[0m02:55:47.249774 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m02:55:47.250949 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m02:55:47.252733 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m02:55:47.254140 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m02:55:47.255289 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m02:55:47.256766 [info ] [MainThread]: Configuration:
[0m02:55:47.257724 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m02:55:47.258518 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m02:55:47.259634 [info ] [MainThread]: Required dependencies:
[0m02:55:47.260405 [debug] [MainThread]: Executing "git --help"
[0m02:55:47.262543 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m02:55:47.263328 [info ] [MainThread]: Connection test skipped since no profile was found
[0m02:55:47.264155 [info ] [MainThread]: [31m3 checks failed:[0m
[0m02:55:47.265063 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m02:55:47.265979 [info ] [MainThread]: Project loading failed for the following reason:
 project path </usr/app/dbt_project.yml> not found

[0m02:55:47.266722 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m02:55:47.270432 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13130242, "process_in_blocks": "22632", "process_kernel_time": 0.221221, "process_mem_max_rss": "103052", "process_out_blocks": "0", "process_user_time": 1.998891}
[0m02:55:47.271799 [debug] [MainThread]: Command `dbt debug` failed at 02:55:47.271604 after 0.13 seconds
[0m02:55:47.272639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2159b595b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d215946bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d215db92960>]}
[0m02:55:47.273570 [debug] [MainThread]: Flushing usage events
[0m02:55:48.213130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:59:41.633081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca722609e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca7212bda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca72379f9b0>]}


============================== 02:59:41.639679 | 5b9f9749-3ca1-4284-83f5-1dab12d1c477 ==============================
[0m02:59:41.639679 [info ] [MainThread]: Running with dbt=1.11.6
[0m02:59:41.640803 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'empty': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'quiet': 'False'}
[0m02:59:41.651387 [info ] [MainThread]: dbt version: 1.11.6
[0m02:59:41.652202 [info ] [MainThread]: python version: 3.12.12
[0m02:59:41.652990 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m02:59:41.653993 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m02:59:41.770647 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m02:59:41.771464 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m02:59:41.772103 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m02:59:41.773098 [info ] [MainThread]: adapter type: duckdb
[0m02:59:41.773682 [info ] [MainThread]: adapter version: 1.8.0
[0m02:59:41.886654 [info ] [MainThread]: Configuration:
[0m02:59:41.887461 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:59:41.888200 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:59:41.888928 [info ] [MainThread]: Required dependencies:
[0m02:59:41.889661 [debug] [MainThread]: Executing "git --help"
[0m02:59:41.891185 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m02:59:41.891891 [info ] [MainThread]: Connection:
[0m02:59:41.892475 [info ] [MainThread]:   database: mydb
[0m02:59:41.893219 [info ] [MainThread]:   schema: main
[0m02:59:41.893939 [info ] [MainThread]:   path: /duckdb/mydb.duckdb
[0m02:59:41.894649 [info ] [MainThread]:   config_options: None
[0m02:59:41.895365 [info ] [MainThread]:   extensions: None
[0m02:59:41.896038 [info ] [MainThread]:   settings: None
[0m02:59:41.896794 [info ] [MainThread]:   external_root: .
[0m02:59:41.897699 [info ] [MainThread]:   use_credential_provider: None
[0m02:59:41.898525 [info ] [MainThread]:   attach: None
[0m02:59:41.899446 [info ] [MainThread]:   filesystems: None
[0m02:59:41.900173 [info ] [MainThread]:   remote: None
[0m02:59:41.900812 [info ] [MainThread]:   plugins: None
[0m02:59:41.901490 [info ] [MainThread]:   disable_transactions: False
[0m02:59:41.902306 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m02:59:42.002205 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:59:42.053859 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:59:42.054567 [debug] [MainThread]: On debug: select 1 as id
[0m02:59:42.055206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:59:42.096655 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m02:59:42.097918 [debug] [MainThread]: On debug: Close
[0m02:59:42.102984 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:59:42.103785 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:59:42.104554 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m02:59:42.106270 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.57344925, "process_in_blocks": "6784", "process_kernel_time": 0.299643, "process_mem_max_rss": "141148", "process_out_blocks": "0", "process_user_time": 2.22535}
[0m02:59:42.107058 [debug] [MainThread]: Command `dbt debug` failed at 02:59:42.106941 after 0.57 seconds
[0m02:59:42.107701 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:59:42.108381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca7216bda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca7216bf170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca721006060>]}
[0m02:59:42.109020 [debug] [MainThread]: Flushing usage events
[0m02:59:42.914751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:03:04.171776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d3ddf7ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d3e02251c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d3e035fa70>]}


============================== 03:03:04.178914 | 91fb7ada-ff8d-42c8-9d91-e40ee97b4d3b ==============================
[0m03:03:04.178914 [info ] [MainThread]: Running with dbt=1.11.6
[0m03:03:04.179941 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/root/.dbt', 'no_print': 'None', 'target_path': 'None', 'introspect': 'True', 'empty': 'None', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'log_format': 'default'}
[0m03:03:04.192219 [info ] [MainThread]: dbt version: 1.11.6
[0m03:03:04.193011 [info ] [MainThread]: python version: 3.12.12
[0m03:03:04.194143 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m03:03:04.195262 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m03:03:04.321370 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m03:03:04.322211 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m03:03:04.322856 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m03:03:04.323833 [info ] [MainThread]: adapter type: duckdb
[0m03:03:04.324572 [info ] [MainThread]: adapter version: 1.8.0
[0m03:03:04.452762 [info ] [MainThread]: Configuration:
[0m03:03:04.453734 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:03:04.454420 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:03:04.455311 [info ] [MainThread]: Required dependencies:
[0m03:03:04.456203 [debug] [MainThread]: Executing "git --help"
[0m03:03:04.458013 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m03:03:04.458722 [info ] [MainThread]: Connection:
[0m03:03:04.459436 [info ] [MainThread]:   database: mydb
[0m03:03:04.460366 [info ] [MainThread]:   schema: main
[0m03:03:04.461403 [info ] [MainThread]:   path: /duckdb/mydb.duckdb
[0m03:03:04.462111 [info ] [MainThread]:   config_options: None
[0m03:03:04.462824 [info ] [MainThread]:   extensions: None
[0m03:03:04.463718 [info ] [MainThread]:   settings: None
[0m03:03:04.464567 [info ] [MainThread]:   external_root: .
[0m03:03:04.465488 [info ] [MainThread]:   use_credential_provider: None
[0m03:03:04.466460 [info ] [MainThread]:   attach: None
[0m03:03:04.467637 [info ] [MainThread]:   filesystems: None
[0m03:03:04.468650 [info ] [MainThread]:   remote: None
[0m03:03:04.469477 [info ] [MainThread]:   plugins: None
[0m03:03:04.470279 [info ] [MainThread]:   disable_transactions: False
[0m03:03:04.471411 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m03:03:04.588720 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:03:04.645495 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:03:04.647445 [debug] [MainThread]: On debug: select 1 as id
[0m03:03:04.648304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:03:04.684269 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m03:03:04.685750 [debug] [MainThread]: On debug: Close
[0m03:03:04.690740 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:03:04.691640 [info ] [MainThread]: [31m1 check failed:[0m
[0m03:03:04.692597 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m03:03:04.694682 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6102228, "process_in_blocks": "0", "process_kernel_time": 0.445172, "process_mem_max_rss": "141444", "process_out_blocks": "0", "process_user_time": 2.375638}
[0m03:03:04.695499 [debug] [MainThread]: Command `dbt debug` failed at 03:03:04.695352 after 0.61 seconds
[0m03:03:04.696198 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:03:04.696790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d3de3560c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d3dd3a8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d3ddb8ba40>]}
[0m03:03:04.697386 [debug] [MainThread]: Flushing usage events
[0m03:03:05.370780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:10:47.467087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728b6ab799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728b68c69fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728b68c69b80>]}


============================== 03:10:47.474565 | cfe4a136-4cc1-4be4-bbaf-411061c367d3 ==============================
[0m03:10:47.474565 [info ] [MainThread]: Running with dbt=1.11.6
[0m03:10:47.475544 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt debug', 'empty': 'None', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'log_path': '/usr/app/logs', 'warn_error': 'None'}
[0m03:10:47.486676 [info ] [MainThread]: dbt version: 1.11.6
[0m03:10:47.487460 [info ] [MainThread]: python version: 3.12.12
[0m03:10:47.488133 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m03:10:47.489030 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m03:10:47.606472 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m03:10:47.607388 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m03:10:47.608270 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m03:10:47.609360 [info ] [MainThread]: adapter type: duckdb
[0m03:10:47.609993 [info ] [MainThread]: adapter version: 1.8.0
[0m03:10:47.726352 [info ] [MainThread]: Configuration:
[0m03:10:47.727257 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:10:47.728162 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:10:47.729238 [info ] [MainThread]: Required dependencies:
[0m03:10:47.730191 [debug] [MainThread]: Executing "git --help"
[0m03:10:47.734123 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:10:47.734831 [debug] [MainThread]: STDERR: "b''"
[0m03:10:47.735479 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:10:47.736121 [info ] [MainThread]: Connection:
[0m03:10:47.736907 [info ] [MainThread]:   database: mydb
[0m03:10:47.737699 [info ] [MainThread]:   schema: main
[0m03:10:47.738593 [info ] [MainThread]:   path: /duckdb/mydb.duckdb
[0m03:10:47.739474 [info ] [MainThread]:   config_options: None
[0m03:10:47.740435 [info ] [MainThread]:   extensions: None
[0m03:10:47.741162 [info ] [MainThread]:   settings: None
[0m03:10:47.741963 [info ] [MainThread]:   external_root: .
[0m03:10:47.742819 [info ] [MainThread]:   use_credential_provider: None
[0m03:10:47.743859 [info ] [MainThread]:   attach: None
[0m03:10:47.744735 [info ] [MainThread]:   filesystems: None
[0m03:10:47.745452 [info ] [MainThread]:   remote: None
[0m03:10:47.746238 [info ] [MainThread]:   plugins: None
[0m03:10:47.747036 [info ] [MainThread]:   disable_transactions: False
[0m03:10:47.748123 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m03:10:47.835035 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:10:47.880698 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:10:47.881464 [debug] [MainThread]: On debug: select 1 as id
[0m03:10:47.882105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:47.910187 [debug] [MainThread]: SQL status: OK in 0.028 seconds
[0m03:10:47.911570 [debug] [MainThread]: On debug: Close
[0m03:10:47.915534 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:10:47.917164 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:10:47.919369 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5380318, "process_in_blocks": "0", "process_kernel_time": 0.375356, "process_mem_max_rss": "142968", "process_out_blocks": "0", "process_user_time": 2.188246}
[0m03:10:47.920150 [debug] [MainThread]: Command `dbt debug` succeeded at 03:10:47.920034 after 0.54 seconds
[0m03:10:47.920733 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:10:47.921334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728b690327b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728b6ab799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728b6467a990>]}
[0m03:10:47.921989 [debug] [MainThread]: Flushing usage events
[0m03:10:48.716899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:13:22.173992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c184ce55f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c184d5e3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c184d5e0fe0>]}


============================== 03:13:22.180756 | 0edb8357-4c1b-4b80-a35c-e062ac19d64e ==============================
[0m03:13:22.180756 [info ] [MainThread]: Running with dbt=1.11.6
[0m03:13:22.181869 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'log_path': '/usr/app/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'empty': 'None', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'version_check': 'True'}
[0m03:13:22.192863 [info ] [MainThread]: dbt version: 1.11.6
[0m03:13:22.193676 [info ] [MainThread]: python version: 3.12.12
[0m03:13:22.194582 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m03:13:22.195839 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m03:13:22.309984 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m03:13:22.311017 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m03:13:22.311726 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m03:13:22.312665 [info ] [MainThread]: adapter type: duckdb
[0m03:13:22.313291 [info ] [MainThread]: adapter version: 1.8.0
[0m03:13:22.427851 [info ] [MainThread]: Configuration:
[0m03:13:22.428792 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:13:22.429687 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:13:22.430816 [info ] [MainThread]: Required dependencies:
[0m03:13:22.431514 [debug] [MainThread]: Executing "git --help"
[0m03:13:22.434668 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:13:22.435437 [debug] [MainThread]: STDERR: "b''"
[0m03:13:22.436075 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:13:22.436734 [info ] [MainThread]: Connection:
[0m03:13:22.437583 [info ] [MainThread]:   database: taxi_rides_ny
[0m03:13:22.438407 [info ] [MainThread]:   schema: dev
[0m03:13:22.439425 [info ] [MainThread]:   path: taxi_rides_ny.duckdb
[0m03:13:22.440322 [info ] [MainThread]:   config_options: None
[0m03:13:22.441266 [info ] [MainThread]:   extensions: ['parquet']
[0m03:13:22.442175 [info ] [MainThread]:   settings: {'memory_limit': '2GB', 'preserve_insertion_order': False}
[0m03:13:22.442920 [info ] [MainThread]:   external_root: .
[0m03:13:22.443777 [info ] [MainThread]:   use_credential_provider: None
[0m03:13:22.444645 [info ] [MainThread]:   attach: None
[0m03:13:22.445607 [info ] [MainThread]:   filesystems: None
[0m03:13:22.446670 [info ] [MainThread]:   remote: None
[0m03:13:22.447463 [info ] [MainThread]:   plugins: None
[0m03:13:22.448547 [info ] [MainThread]:   disable_transactions: False
[0m03:13:22.449615 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m03:13:22.542533 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:13:22.586067 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:13:22.586849 [debug] [MainThread]: On debug: select 1 as id
[0m03:13:22.587499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:13:24.400524 [debug] [MainThread]: SQL status: OK in 1.813 seconds
[0m03:13:24.401862 [debug] [MainThread]: On debug: Close
[0m03:13:24.405524 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:13:24.406430 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:13:24.407760 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.3287344, "process_in_blocks": "0", "process_kernel_time": 0.624838, "process_mem_max_rss": "181428", "process_out_blocks": "41840", "process_user_time": 2.38539}
[0m03:13:24.408566 [debug] [MainThread]: Command `dbt debug` succeeded at 03:13:24.408449 after 2.33 seconds
[0m03:13:24.409151 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:13:24.409788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c184d3a9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c184c94b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c184f397140>]}
[0m03:13:24.410565 [debug] [MainThread]: Flushing usage events
[0m03:13:25.109374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:18:14.468646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ac9d44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ac560b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ac2910d0>]}


============================== 03:18:14.477517 | c7848129-94b4-49e7-a49e-d9d2f862c455 ==============================
[0m03:18:14.477517 [info ] [MainThread]: Running with dbt=1.11.6
[0m03:18:14.478949 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'target_path': 'None', 'empty': 'None', 'warn_error': 'None', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'log_path': '/usr/app/logs', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False'}
[0m03:18:14.508122 [info ] [MainThread]: dbt version: 1.11.6
[0m03:18:14.509554 [info ] [MainThread]: python version: 3.12.12
[0m03:18:14.511027 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m03:18:14.512050 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m03:18:14.817780 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m03:18:14.818543 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m03:18:14.819204 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m03:18:14.821321 [info ] [MainThread]: adapter type: duckdb
[0m03:18:14.822060 [info ] [MainThread]: adapter version: 1.8.0
[0m03:18:14.937475 [info ] [MainThread]: Configuration:
[0m03:18:14.938323 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:18:14.939221 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:18:14.940060 [info ] [MainThread]: Required dependencies:
[0m03:18:14.940933 [debug] [MainThread]: Executing "git --help"
[0m03:18:14.961112 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:18:14.961949 [debug] [MainThread]: STDERR: "b''"
[0m03:18:14.962556 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:18:14.963281 [info ] [MainThread]: Connection:
[0m03:18:14.963963 [info ] [MainThread]:   database: taxi_rides_ny
[0m03:18:14.964592 [info ] [MainThread]:   schema: dev
[0m03:18:14.965309 [info ] [MainThread]:   path: taxi_rides_ny.duckdb
[0m03:18:14.965946 [info ] [MainThread]:   config_options: None
[0m03:18:14.966932 [info ] [MainThread]:   extensions: ['parquet']
[0m03:18:14.967882 [info ] [MainThread]:   settings: {'memory_limit': '2GB', 'preserve_insertion_order': False}
[0m03:18:14.968640 [info ] [MainThread]:   external_root: .
[0m03:18:14.969458 [info ] [MainThread]:   use_credential_provider: None
[0m03:18:14.970511 [info ] [MainThread]:   attach: None
[0m03:18:14.971702 [info ] [MainThread]:   filesystems: None
[0m03:18:14.972639 [info ] [MainThread]:   remote: None
[0m03:18:14.973442 [info ] [MainThread]:   plugins: None
[0m03:18:14.974804 [info ] [MainThread]:   disable_transactions: False
[0m03:18:14.976761 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m03:18:15.076736 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:18:15.119619 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:18:15.120416 [debug] [MainThread]: On debug: select 1 as id
[0m03:18:15.121069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:18:17.296199 [debug] [MainThread]: SQL status: OK in 2.175 seconds
[0m03:18:17.297960 [debug] [MainThread]: On debug: Close
[0m03:18:17.302207 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:18:17.303053 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:18:17.305866 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.9134436, "process_in_blocks": "161672", "process_kernel_time": 0.636475, "process_mem_max_rss": "180032", "process_out_blocks": "41840", "process_user_time": 2.58593}
[0m03:18:17.306683 [debug] [MainThread]: Command `dbt debug` succeeded at 03:18:17.306574 after 2.91 seconds
[0m03:18:17.307242 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:18:17.307821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ac6ca7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80acdda930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ac79e4e0>]}
[0m03:18:17.308507 [debug] [MainThread]: Flushing usage events
[0m03:18:18.039288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:53:58.335410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793149594f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79314a30ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79314abba2d0>]}


============================== 03:53:58.350288 | 65466dd6-f7db-4cd2-99c8-520a3ac7e167 ==============================
[0m03:53:58.350288 [info ] [MainThread]: Running with dbt=1.11.6
[0m03:53:58.351289 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'target_path': 'None', 'version_check': 'True', 'log_format': 'default', 'log_path': '/usr/app/logs', 'partial_parse': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/root/.dbt', 'invocation_command': 'dbt debug'}
[0m03:53:58.379189 [info ] [MainThread]: dbt version: 1.11.6
[0m03:53:58.380098 [info ] [MainThread]: python version: 3.12.12
[0m03:53:58.380972 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m03:53:58.382334 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m03:53:58.498912 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m03:53:58.499814 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m03:53:58.500542 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m03:53:58.501877 [info ] [MainThread]: adapter type: duckdb
[0m03:53:58.502571 [info ] [MainThread]: adapter version: 1.8.0
[0m03:53:58.617281 [info ] [MainThread]: Configuration:
[0m03:53:58.618215 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:53:58.618877 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:53:58.619786 [info ] [MainThread]: Required dependencies:
[0m03:53:58.620636 [debug] [MainThread]: Executing "git --help"
[0m03:53:58.643533 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:53:58.644509 [debug] [MainThread]: STDERR: "b''"
[0m03:53:58.645105 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:53:58.645737 [info ] [MainThread]: Connection:
[0m03:53:58.646603 [info ] [MainThread]:   database: taxi_rides_ny
[0m03:53:58.647490 [info ] [MainThread]:   schema: dev
[0m03:53:58.648438 [info ] [MainThread]:   path: taxi_rides_ny.duckdb
[0m03:53:58.649241 [info ] [MainThread]:   config_options: None
[0m03:53:58.649943 [info ] [MainThread]:   extensions: ['parquet']
[0m03:53:58.650778 [info ] [MainThread]:   settings: {'memory_limit': '2GB', 'preserve_insertion_order': False}
[0m03:53:58.651570 [info ] [MainThread]:   external_root: .
[0m03:53:58.652450 [info ] [MainThread]:   use_credential_provider: None
[0m03:53:58.653540 [info ] [MainThread]:   attach: None
[0m03:53:58.654376 [info ] [MainThread]:   filesystems: None
[0m03:53:58.655194 [info ] [MainThread]:   remote: None
[0m03:53:58.656016 [info ] [MainThread]:   plugins: None
[0m03:53:58.657008 [info ] [MainThread]:   disable_transactions: False
[0m03:53:58.658668 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m03:53:58.752475 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:53:58.802194 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:53:58.802952 [debug] [MainThread]: On debug: select 1 as id
[0m03:53:58.803546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:53:58.864469 [debug] [MainThread]: SQL status: OK in 0.061 seconds
[0m03:53:58.865949 [debug] [MainThread]: On debug: Close
[0m03:53:58.869468 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:53:58.870252 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:53:58.872590 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.66080457, "process_in_blocks": "72688", "process_kernel_time": 0.356718, "process_mem_max_rss": "141848", "process_out_blocks": "0", "process_user_time": 2.3511}
[0m03:53:58.873421 [debug] [MainThread]: Command `dbt debug` succeeded at 03:53:58.873308 after 0.66 seconds
[0m03:53:58.874073 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:53:58.874658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793149594f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931496f0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79314526cd10>]}
[0m03:53:58.875328 [debug] [MainThread]: Flushing usage events
[0m03:53:59.705241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:00.055676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7002a95e5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7002a90de0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7002a912c620>]}


============================== 15:10:00.066077 | f9c31d81-12d8-4f96-9a23-87d8ebdbb0d2 ==============================
[0m15:10:00.066077 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:10:00.067338 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'empty': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_path': '/usr/app/logs', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'invocation_command': 'dbt debug'}
[0m15:10:00.092059 [info ] [MainThread]: dbt version: 1.11.6
[0m15:10:00.092947 [info ] [MainThread]: python version: 3.12.12
[0m15:10:00.093648 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m15:10:00.094366 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m15:10:00.326686 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m15:10:00.327942 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m15:10:00.328978 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m15:10:00.330987 [info ] [MainThread]: adapter type: duckdb
[0m15:10:00.332327 [info ] [MainThread]: adapter version: 1.8.0
[0m15:10:00.497743 [info ] [MainThread]: Configuration:
[0m15:10:00.499151 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:10:00.500505 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:10:00.501759 [info ] [MainThread]: Required dependencies:
[0m15:10:00.503245 [debug] [MainThread]: Executing "git --help"
[0m15:10:00.525421 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:10:00.526318 [debug] [MainThread]: STDERR: "b''"
[0m15:10:00.527151 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:10:00.528006 [info ] [MainThread]: Connection:
[0m15:10:00.528923 [info ] [MainThread]:   database: taxi_rides_ny
[0m15:10:00.529804 [info ] [MainThread]:   schema: dev
[0m15:10:00.532081 [info ] [MainThread]:   path: taxi_rides_ny.duckdb
[0m15:10:00.533575 [info ] [MainThread]:   config_options: None
[0m15:10:00.534885 [info ] [MainThread]:   extensions: ['parquet']
[0m15:10:00.536538 [info ] [MainThread]:   settings: {'memory_limit': '2GB', 'preserve_insertion_order': False}
[0m15:10:00.538086 [info ] [MainThread]:   external_root: .
[0m15:10:00.539948 [info ] [MainThread]:   use_credential_provider: None
[0m15:10:00.541202 [info ] [MainThread]:   attach: None
[0m15:10:00.542280 [info ] [MainThread]:   filesystems: None
[0m15:10:00.543239 [info ] [MainThread]:   remote: None
[0m15:10:00.544293 [info ] [MainThread]:   plugins: None
[0m15:10:00.545255 [info ] [MainThread]:   disable_transactions: False
[0m15:10:00.546609 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m15:10:00.652175 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m15:10:00.702862 [debug] [MainThread]: Using duckdb connection "debug"
[0m15:10:00.704167 [debug] [MainThread]: On debug: select 1 as id
[0m15:10:00.705414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:01.743280 [debug] [MainThread]: SQL status: OK in 1.042 seconds
[0m15:10:01.746282 [debug] [MainThread]: On debug: Close
[0m15:10:01.752099 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:10:01.753555 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:10:01.756698 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.818936, "process_in_blocks": "122952", "process_kernel_time": 0.537677, "process_mem_max_rss": "179784", "process_out_blocks": "41840", "process_user_time": 2.99334}
[0m15:10:01.758193 [debug] [MainThread]: Command `dbt debug` succeeded at 15:10:01.757879 after 1.82 seconds
[0m15:10:01.759494 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:10:01.760861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7002a86bd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7002a8eb7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7002a93ae840>]}
[0m15:10:01.762343 [debug] [MainThread]: Flushing usage events
[0m15:10:02.540864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:37.965480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc65d3c2b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc65dc4e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc65d3c2090>]}


============================== 16:17:37.977775 | 2ae258f7-72ba-4b1b-99b6-7a66400acac2 ==============================
[0m16:17:37.977775 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:17:37.979238 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt run --select staging/stg_green_tripdata.sql', 'log_cache_events': 'False', 'version_check': 'True', 'printer_width': '80', 'introspect': 'True', 'log_path': '/usr/app/logs', 'empty': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'write_json': 'True'}
[0m16:17:38.408968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ae258f7-72ba-4b1b-99b6-7a66400acac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc65d0afcb0>]}
[0m16:17:38.486768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ae258f7-72ba-4b1b-99b6-7a66400acac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc65d4236b0>]}
[0m16:17:38.489482 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m16:17:38.625001 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:17:38.632156 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:17:38.633098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ae258f7-72ba-4b1b-99b6-7a66400acac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc654f6fdd0>]}
[0m16:17:40.439414 [error] [MainThread]: Encountered an error:
Parsing Error in model check_duckdb (models/check_duckdb.py)
  dbt allows exactly one model defined per python file, found 0
[0m16:17:40.442606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5846663, "process_in_blocks": "155496", "process_kernel_time": 0.512208, "process_mem_max_rss": "140284", "process_out_blocks": "0", "process_user_time": 4.065657}
[0m16:17:40.443968 [debug] [MainThread]: Command `dbt run` failed at 16:17:40.443701 after 2.59 seconds
[0m16:17:40.444965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc65d3c2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc63fcfc200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc63fce37a0>]}
[0m16:17:40.445834 [debug] [MainThread]: Flushing usage events
[0m16:17:41.096230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:12.739006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8f38406ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8f38374d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8f38ab7ce0>]}


============================== 16:19:12.746759 | da16ba8d-85de-4608-a6ef-ab3b54c07f62 ==============================
[0m16:19:12.746759 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:19:12.748404 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select staging/stg_green_tripdata.sql', 'introspect': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_path': '/usr/app/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m16:19:13.030046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da16ba8d-85de-4608-a6ef-ab3b54c07f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8f3a8b4ef0>]}
[0m16:19:13.112946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da16ba8d-85de-4608-a6ef-ab3b54c07f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8f3a002d80>]}
[0m16:19:13.114898 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m16:19:13.228719 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:19:13.237278 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:19:13.238219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da16ba8d-85de-4608-a6ef-ab3b54c07f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8f38050e00>]}
[0m16:19:15.727965 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_vendors' in the 'models' section of file 'models/marts/schema.yml'
[0m16:19:16.016233 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.int_trips' (models/intermediate/int_trips.sql) depends on a node named 'payment_type_lookup' which was not found
[0m16:19:16.019180 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3919199, "process_in_blocks": "0", "process_kernel_time": 0.486268, "process_mem_max_rss": "141564", "process_out_blocks": "0", "process_user_time": 5.835217}
[0m16:19:16.020938 [debug] [MainThread]: Command `dbt run` failed at 16:19:16.020619 after 3.39 seconds
[0m16:19:16.022258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8f38406ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8f2ed22570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8f2ed47830>]}
[0m16:19:16.023523 [debug] [MainThread]: Flushing usage events
[0m16:19:16.696457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:19.828682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfd873b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfd5fcf320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfd67752b0>]}


============================== 16:22:19.837844 | b2974905-8641-46ca-9492-11c480b85c1e ==============================
[0m16:22:19.837844 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:22:19.838923 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'log_path': '/usr/app/logs', 'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'printer_width': '80', 'profiles_dir': '/root/.dbt', 'no_print': 'None', 'invocation_command': 'dbt run --select staging/stg_green_tripdata.sql', 'debug': 'False', 'log_format': 'default'}
[0m16:22:20.179832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2974905-8641-46ca-9492-11c480b85c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfd679ade0>]}
[0m16:22:20.340992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2974905-8641-46ca-9492-11c480b85c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfd5f236b0>]}
[0m16:22:20.342166 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m16:22:20.459066 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:22:20.468013 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:22:20.469921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2974905-8641-46ca-9492-11c480b85c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfcdb3cfe0>]}
[0m16:22:22.409237 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_vendors' in the 'models' section of file 'models/marts/schema.yml'
[0m16:22:22.619691 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.dim_zones' (models/marts/dim_zones.sql) depends on a node named 'taxi_zone_lookup' which was not found
[0m16:22:22.621674 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.927758, "process_in_blocks": "0", "process_kernel_time": 0.313942, "process_mem_max_rss": "143392", "process_out_blocks": "0", "process_user_time": 4.958683}
[0m16:22:22.622815 [debug] [MainThread]: Command `dbt run` failed at 16:22:22.622677 after 2.93 seconds
[0m16:22:22.623594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfd679a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfcc95c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfcc928aa0>]}
[0m16:22:22.624388 [debug] [MainThread]: Flushing usage events
[0m16:22:23.259001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:11.019354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c74a0ede80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c749f06660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c749bd52b0>]}


============================== 16:23:11.031113 | 2a804a9e-709f-4a7f-99e2-ddb03db53d5e ==============================
[0m16:23:11.031113 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:23:11.032445 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging/stg_green_tripdata.sql', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/app/logs', 'empty': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False'}
[0m16:23:11.337809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a804a9e-709f-4a7f-99e2-ddb03db53d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c745530ec0>]}
[0m16:23:11.417819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a804a9e-709f-4a7f-99e2-ddb03db53d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c74999d1c0>]}
[0m16:23:11.419478 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m16:23:11.531143 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:23:11.540145 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:23:11.541033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a804a9e-709f-4a7f-99e2-ddb03db53d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c74b072240>]}
[0m16:23:15.681432 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_vendors' in the 'models' section of file 'models/marts/schema.yml'
[0m16:23:16.949129 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141' (models/marts/schema.yml) depends on a node named 'dim_vendors' in package '' which was not found
[0m16:23:16.952093 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580' (models/marts/schema.yml) depends on a node named 'dim_vendors' in package '' which was not found
[0m16:23:17.342744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a804a9e-709f-4a7f-99e2-ddb03db53d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c7401a8c80>]}
[0m16:23:17.762326 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:23:17.781455 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:23:17.907710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a804a9e-709f-4a7f-99e2-ddb03db53d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c740103d70>]}
[0m16:23:17.910050 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 455 macros
[0m16:23:17.912569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a804a9e-709f-4a7f-99e2-ddb03db53d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c73ad85dc0>]}
[0m16:23:17.925803 [warn ] [MainThread]: The selection criterion 'staging/stg_green_tripdata.sql' does not match any enabled nodes
[0m16:23:17.933851 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:23:17.936462 [debug] [MainThread]: Command end result
[0m16:23:18.113803 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:23:18.132918 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:23:18.153554 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:23:18.156156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2515545, "process_in_blocks": "1136", "process_kernel_time": 0.425654, "process_mem_max_rss": "147440", "process_out_blocks": "0", "process_user_time": 8.647945}
[0m16:23:18.157968 [debug] [MainThread]: Command `dbt run` succeeded at 16:23:18.157645 after 7.25 seconds
[0m16:23:18.159301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c749000bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c73adfb5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c73adb60f0>]}
[0m16:23:18.161047 [debug] [MainThread]: Flushing usage events
[0m16:23:18.839468 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:45.003519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30999ba000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f309a08dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30999ba030>]}


============================== 16:25:45.011284 | e4880ba3-b559-49aa-932a-7facd4b12257 ==============================
[0m16:25:45.011284 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:25:45.012460 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select staging/stg_green_tripdata.sql', 'version_check': 'True', 'target_path': 'None', 'empty': 'False', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'log_path': '/usr/app/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False'}
[0m16:25:45.283114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4880ba3-b559-49aa-932a-7facd4b12257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f309922eab0>]}
[0m16:25:45.361303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4880ba3-b559-49aa-932a-7facd4b12257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3099736180>]}
[0m16:25:45.362822 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m16:25:45.473844 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:25:45.960358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m16:25:45.961793 [debug] [MainThread]: Partial parsing: added file: dbt_project://macros/macros_properties.yml
[0m16:25:45.963044 [debug] [MainThread]: Partial parsing: added file: dbt_project://macros/safe_cast.sql
[0m16:25:45.964724 [debug] [MainThread]: Partial parsing: added file: dbt_project://macros/get_trip_duration_minutes.sql
[0m16:25:45.966081 [debug] [MainThread]: Partial parsing: added file: dbt_project://macros/get_vendor_data.sql
[0m16:25:46.149836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4880ba3-b559-49aa-932a-7facd4b12257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3091128bc0>]}
[0m16:25:46.328096 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:25:46.338891 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:25:46.381867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4880ba3-b559-49aa-932a-7facd4b12257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30911284a0>]}
[0m16:25:46.383237 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m16:25:46.384249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4880ba3-b559-49aa-932a-7facd4b12257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f309111a180>]}
[0m16:25:46.392292 [warn ] [MainThread]: The selection criterion 'staging/stg_green_tripdata.sql' does not match any enabled nodes
[0m16:25:46.395174 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:25:46.397217 [debug] [MainThread]: Command end result
[0m16:25:46.491632 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:25:46.503686 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:25:46.517698 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:25:46.519440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6323712, "process_in_blocks": "0", "process_kernel_time": 0.301016, "process_mem_max_rss": "141936", "process_out_blocks": "0", "process_user_time": 3.315197}
[0m16:25:46.520389 [debug] [MainThread]: Command `dbt run` succeeded at 16:25:46.520260 after 1.63 seconds
[0m16:25:46.521410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3099214aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30992157f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3091104620>]}
[0m16:25:46.522734 [debug] [MainThread]: Flushing usage events
[0m16:25:47.288500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:15.346329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e2ed574d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e2c54f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e2e243e00>]}


============================== 16:27:15.353548 | 35d24149-b143-4998-85ef-21d135492c29 ==============================
[0m16:27:15.353548 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:27:15.354614 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -s staging/', 'empty': 'False', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'log_path': '/usr/app/logs', 'version_check': 'True', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m16:27:15.594690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35d24149-b143-4998-85ef-21d135492c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e24100f20>]}
[0m16:27:15.663196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35d24149-b143-4998-85ef-21d135492c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e241011f0>]}
[0m16:27:15.664758 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m16:27:15.787332 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:27:16.212082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:27:16.212928 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:27:16.213521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:27:16.282116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35d24149-b143-4998-85ef-21d135492c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e24038fe0>]}
[0m16:27:16.451278 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:27:16.460287 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:27:16.503808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35d24149-b143-4998-85ef-21d135492c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e240392e0>]}
[0m16:27:16.505001 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m16:27:16.505870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d24149-b143-4998-85ef-21d135492c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e23e67920>]}
[0m16:27:16.513503 [warn ] [MainThread]: The selection criterion 'staging/' does not match any enabled nodes
[0m16:27:16.515942 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:27:16.519278 [debug] [MainThread]: Command end result
[0m16:27:16.601669 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:27:16.609992 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:27:16.620214 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:27:16.621384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3726274, "process_in_blocks": "0", "process_kernel_time": 0.267866, "process_mem_max_rss": "141264", "process_out_blocks": "0", "process_user_time": 2.946534}
[0m16:27:16.622271 [debug] [MainThread]: Command `dbt run` succeeded at 16:27:16.622143 after 1.37 seconds
[0m16:27:16.623033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e2c6bbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e2c51d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e2e242870>]}
[0m16:27:16.624062 [debug] [MainThread]: Flushing usage events
[0m16:27:17.284364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:41.701821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dfbc36ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dfc3ca8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dfc3ca900>]}


============================== 16:27:41.709219 | c6ae010b-a996-419d-9f73-37f2f09e3896 ==============================
[0m16:27:41.709219 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:27:41.710340 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/usr/app/logs', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run -s stg_green_tripdata', 'use_experimental_parser': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'write_json': 'True'}
[0m16:27:41.945701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6ae010b-a996-419d-9f73-37f2f09e3896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dfb8320f0>]}
[0m16:27:42.015027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6ae010b-a996-419d-9f73-37f2f09e3896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dfb87ba10>]}
[0m16:27:42.016687 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m16:27:42.119683 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:27:42.540744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:27:42.541453 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:27:42.541987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:27:42.611889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6ae010b-a996-419d-9f73-37f2f09e3896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793df384da60>]}
[0m16:27:42.778659 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:27:42.792015 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:27:42.838749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6ae010b-a996-419d-9f73-37f2f09e3896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793df3637860>]}
[0m16:27:42.839909 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m16:27:42.840812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6ae010b-a996-419d-9f73-37f2f09e3896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793df367d490>]}
[0m16:27:42.844813 [info ] [MainThread]: 
[0m16:27:42.846200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:27:42.847363 [info ] [MainThread]: 
[0m16:27:42.849118 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:27:42.851645 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m16:27:42.933206 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m16:27:42.934393 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m16:27:42.935476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:42.981076 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m16:27:42.983183 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m16:27:42.987488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m16:27:42.988374 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m16:27:42.996167 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m16:27:42.997162 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m16:27:42.998123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:43.021940 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m16:27:43.023939 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m16:27:43.024610 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m16:27:43.025708 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:27:43.026344 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m16:27:43.026948 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m16:27:43.028004 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:27:43.029272 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m16:27:43.029879 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m16:27:43.030479 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m16:27:43.038108 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m16:27:43.038991 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m16:27:43.061257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m16:27:43.067233 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m16:27:43.068128 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m16:27:43.068868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:43.098659 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m16:27:43.099571 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m16:27:43.100397 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m16:27:43.115522 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:27:43.117709 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m16:27:43.120650 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m16:27:43.121630 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m16:27:43.126674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6ae010b-a996-419d-9f73-37f2f09e3896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793df3801250>]}
[0m16:27:43.127692 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:43.128565 [debug] [MainThread]: On master: BEGIN
[0m16:27:43.129535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:43.166253 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m16:27:43.167191 [debug] [MainThread]: On master: COMMIT
[0m16:27:43.168019 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:43.168851 [debug] [MainThread]: On master: COMMIT
[0m16:27:43.170395 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:27:43.171475 [debug] [MainThread]: On master: Close
[0m16:27:43.183519 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m16:27:43.184721 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_green_tripdata ............................. [RUN]
[0m16:27:43.185694 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_green_tripdata'
[0m16:27:43.186298 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m16:27:43.200932 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m16:27:43.231944 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m16:27:43.265779 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m16:27:43.311329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m16:27:43.312518 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m16:27:43.313499 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:27:43.452755 [debug] [Thread-1 (]: SQL status: OK in 0.139 seconds
[0m16:27:43.454033 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m16:27:43.455120 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m16:27:43.484566 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m16:27:43.486262 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:27:43.487458 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: ROLLBACK
[0m16:27:43.500273 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.stg_green_tripdata'
[0m16:27:43.501367 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m16:27:43.507882 [debug] [Thread-1 (]: Runtime Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)
  Catalog Error: Table with name green_tripdata does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 6:     select * from "taxi_rides_ny"."prod"."green_tripdata"
                            ^
[0m16:27:43.512003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6ae010b-a996-419d-9f73-37f2f09e3896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dfc338b30>]}
[0m16:27:43.513426 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev.stg_green_tripdata .................... [[31mERROR[0m in 0.32s]
[0m16:27:43.514683 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m16:27:43.515914 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stg_green_tripdata' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)
  Catalog Error: Table with name green_tripdata does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 6:     select * from "taxi_rides_ny"."prod"."green_tripdata"
                            ^.
[0m16:27:43.519585 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:43.520420 [debug] [MainThread]: On master: BEGIN
[0m16:27:43.521133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:43.560796 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m16:27:43.562228 [debug] [MainThread]: On master: COMMIT
[0m16:27:43.563422 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:43.564338 [debug] [MainThread]: On master: COMMIT
[0m16:27:43.565854 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:27:43.566655 [debug] [MainThread]: On master: Close
[0m16:27:43.570555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:43.571232 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m16:27:43.571893 [debug] [MainThread]: Connection 'model.dbt_project.stg_green_tripdata' was properly closed.
[0m16:27:43.572524 [info ] [MainThread]: 
[0m16:27:43.573179 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m16:27:43.574434 [debug] [MainThread]: Command end result
[0m16:27:43.648012 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:27:43.655475 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:27:43.675432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:27:43.676591 [info ] [MainThread]: 
[0m16:27:43.677581 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:27:43.678553 [info ] [MainThread]: 
[0m16:27:43.679841 [error] [MainThread]: [31mFailure in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)[0m
[0m16:27:43.681395 [error] [MainThread]:   Runtime Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)
  Catalog Error: Table with name green_tripdata does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 6:     select * from "taxi_rides_ny"."prod"."green_tripdata"
                            ^
[0m16:27:43.682730 [info ] [MainThread]: 
[0m16:27:43.684484 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/staging/stg_green_tripdata.sql
[0m16:27:43.685784 [info ] [MainThread]: 
[0m16:27:43.687562 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:27:43.689942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0926998, "process_in_blocks": "14704", "process_kernel_time": 0.330723, "process_mem_max_rss": "153860", "process_out_blocks": "0", "process_user_time": 3.254802}
[0m16:27:43.691462 [debug] [MainThread]: Command `dbt run` failed at 16:27:43.691238 after 2.09 seconds
[0m16:27:43.692534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dfbbff830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dfb878b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793df25e6a20>]}
[0m16:27:43.693613 [debug] [MainThread]: Flushing usage events
[0m16:27:44.277072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:54.328544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fc7879010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fc7748b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fc7878530>]}


============================== 16:29:54.339927 | c8dac1ad-4068-4d96-866b-dcfbf0458b84 ==============================
[0m16:29:54.339927 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:29:54.341839 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'invocation_command': 'dbt debug', 'version_check': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/root/.dbt', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'no_print': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'target_path': 'None', 'log_path': '/usr/app/logs', 'warn_error': 'None'}
[0m16:29:54.362136 [info ] [MainThread]: dbt version: 1.11.6
[0m16:29:54.363640 [info ] [MainThread]: python version: 3.12.12
[0m16:29:54.366350 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m16:29:54.367411 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m16:29:54.511047 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m16:29:54.512447 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m16:29:54.513998 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m16:29:54.515322 [info ] [MainThread]: adapter type: duckdb
[0m16:29:54.516553 [info ] [MainThread]: adapter version: 1.8.0
[0m16:29:54.662268 [info ] [MainThread]: Configuration:
[0m16:29:54.663320 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:29:54.664000 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:29:54.664687 [info ] [MainThread]: Required dependencies:
[0m16:29:54.665739 [debug] [MainThread]: Executing "git --help"
[0m16:29:54.683441 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:29:54.684405 [debug] [MainThread]: STDERR: "b''"
[0m16:29:54.685075 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:29:54.685919 [info ] [MainThread]: Connection:
[0m16:29:54.687015 [info ] [MainThread]:   database: taxi_rides_ny
[0m16:29:54.688200 [info ] [MainThread]:   schema: dev
[0m16:29:54.689623 [info ] [MainThread]:   path: taxi_rides_ny.duckdb
[0m16:29:54.691215 [info ] [MainThread]:   config_options: None
[0m16:29:54.692486 [info ] [MainThread]:   extensions: ['parquet']
[0m16:29:54.693586 [info ] [MainThread]:   settings: {'memory_limit': '2GB', 'preserve_insertion_order': False}
[0m16:29:54.694692 [info ] [MainThread]:   external_root: .
[0m16:29:54.696128 [info ] [MainThread]:   use_credential_provider: None
[0m16:29:54.697305 [info ] [MainThread]:   attach: None
[0m16:29:54.698586 [info ] [MainThread]:   filesystems: None
[0m16:29:54.699912 [info ] [MainThread]:   remote: None
[0m16:29:54.702120 [info ] [MainThread]:   plugins: None
[0m16:29:54.703919 [info ] [MainThread]:   disable_transactions: False
[0m16:29:54.706611 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m16:29:54.806527 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:29:54.839473 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:29:54.840837 [debug] [MainThread]: On debug: select 1 as id
[0m16:29:54.841850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:54.877761 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m16:29:54.879687 [debug] [MainThread]: On debug: Close
[0m16:29:54.884481 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:29:54.885774 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:29:54.888367 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6573152, "process_in_blocks": "96", "process_kernel_time": 0.275644, "process_mem_max_rss": "141664", "process_out_blocks": "0", "process_user_time": 2.404899}
[0m16:29:54.889799 [debug] [MainThread]: Command `dbt debug` succeeded at 16:29:54.889516 after 0.66 seconds
[0m16:29:54.890848 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:29:54.891827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fc7499f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fc9eb4ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbf59a060>]}
[0m16:29:54.892997 [debug] [MainThread]: Flushing usage events
[0m16:29:55.691132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:44.649698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf4011ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf4d896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf4d8ca70>]}


============================== 16:55:44.659357 | 4f830228-bed2-4f0d-87ba-82979a23b8fc ==============================
[0m16:55:44.659357 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:55:44.661011 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_green_tripdata', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'empty': 'False', 'version_check': 'True', 'printer_width': '80', 'log_cache_events': 'False'}
[0m16:55:45.043430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f830228-bed2-4f0d-87ba-82979a23b8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf2f8b9e0>]}
[0m16:55:45.121946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f830228-bed2-4f0d-87ba-82979a23b8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf2f8b890>]}
[0m16:55:45.124782 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m16:55:45.270099 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:55:45.573368 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:55:45.574882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f830228-bed2-4f0d-87ba-82979a23b8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf36e3500>]}
[0m16:55:47.552208 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_vendors' in the 'models' section of file 'models/marts/schema.yml'
[0m16:55:47.824558 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141' (models/marts/schema.yml) depends on a node named 'dim_vendors' in package '' which was not found
[0m16:55:47.826064 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580' (models/marts/schema.yml) depends on a node named 'dim_vendors' in package '' which was not found
[0m16:55:47.969040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f830228-bed2-4f0d-87ba-82979a23b8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde9fecbf0>]}
[0m16:55:48.193192 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:55:48.201240 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:55:48.252972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f830228-bed2-4f0d-87ba-82979a23b8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde8ce55e0>]}
[0m16:55:48.253887 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m16:55:48.254585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f830228-bed2-4f0d-87ba-82979a23b8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde8b58f80>]}
[0m16:55:48.257863 [info ] [MainThread]: 
[0m16:55:48.258799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:48.259891 [info ] [MainThread]: 
[0m16:55:48.261247 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:55:48.263860 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m16:55:48.321149 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m16:55:48.322118 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m16:55:48.323082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:48.374284 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m16:55:48.376317 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m16:55:48.381593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m16:55:48.382685 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m16:55:48.390783 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m16:55:48.391816 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m16:55:48.392540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:48.420930 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m16:55:48.422780 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m16:55:48.423356 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m16:55:48.424256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:48.424761 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m16:55:48.425276 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m16:55:48.426077 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:48.427293 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m16:55:48.427994 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m16:55:48.428616 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m16:55:48.436232 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m16:55:48.437192 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m16:55:48.462486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m16:55:48.468584 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m16:55:48.469363 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m16:55:48.470069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:48.504401 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m16:55:48.505312 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m16:55:48.506121 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m16:55:48.521712 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m16:55:48.523729 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m16:55:48.526866 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m16:55:48.527662 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m16:55:48.532569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f830228-bed2-4f0d-87ba-82979a23b8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde8c73ef0>]}
[0m16:55:48.533543 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:48.534209 [debug] [MainThread]: On master: BEGIN
[0m16:55:48.534927 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:48.561572 [debug] [MainThread]: SQL status: OK in 0.027 seconds
[0m16:55:48.562381 [debug] [MainThread]: On master: COMMIT
[0m16:55:48.563021 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:48.563607 [debug] [MainThread]: On master: COMMIT
[0m16:55:48.564759 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:48.565486 [debug] [MainThread]: On master: Close
[0m16:55:48.573950 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m16:55:48.574991 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_green_tripdata ............................. [RUN]
[0m16:55:48.576148 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_green_tripdata'
[0m16:55:48.577387 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m16:55:48.592795 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m16:55:48.617835 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m16:55:48.789031 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m16:55:48.850745 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m16:55:48.854128 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m16:55:48.856036 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:48.899766 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m16:55:48.901026 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m16:55:48.901940 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m16:55:48.925795 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m16:55:48.926626 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:55:48.927341 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: ROLLBACK
[0m16:55:48.935802 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.stg_green_tripdata'
[0m16:55:48.936536 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m16:55:48.943524 [debug] [Thread-1 (]: Runtime Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)
  Catalog Error: Table with name green_tripdata does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 6:     select * from "taxi_rides_ny"."prod"."green_tripdata"
                            ^
[0m16:55:48.946597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f830228-bed2-4f0d-87ba-82979a23b8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf74fb1a0>]}
[0m16:55:48.948043 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev.stg_green_tripdata .................... [[31mERROR[0m in 0.37s]
[0m16:55:48.949629 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m16:55:48.951381 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stg_green_tripdata' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)
  Catalog Error: Table with name green_tripdata does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 6:     select * from "taxi_rides_ny"."prod"."green_tripdata"
                            ^.
[0m16:55:48.955380 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:48.956232 [debug] [MainThread]: On master: BEGIN
[0m16:55:48.956973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:48.989167 [debug] [MainThread]: SQL status: OK in 0.032 seconds
[0m16:55:48.990329 [debug] [MainThread]: On master: COMMIT
[0m16:55:48.991250 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:48.992043 [debug] [MainThread]: On master: COMMIT
[0m16:55:48.993193 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:48.994017 [debug] [MainThread]: On master: Close
[0m16:55:48.999266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:49.000399 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m16:55:49.001441 [debug] [MainThread]: Connection 'model.dbt_project.stg_green_tripdata' was properly closed.
[0m16:55:49.002391 [info ] [MainThread]: 
[0m16:55:49.003355 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m16:55:49.005194 [debug] [MainThread]: Command end result
[0m16:55:49.107583 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:55:49.117536 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:55:49.134709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:55:49.135855 [info ] [MainThread]: 
[0m16:55:49.137007 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:55:49.137957 [info ] [MainThread]: 
[0m16:55:49.139184 [error] [MainThread]: [31mFailure in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)[0m
[0m16:55:49.140773 [error] [MainThread]:   Runtime Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)
  Catalog Error: Table with name green_tripdata does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 6:     select * from "taxi_rides_ny"."prod"."green_tripdata"
                            ^
[0m16:55:49.142211 [info ] [MainThread]: 
[0m16:55:49.143624 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/staging/stg_green_tripdata.sql
[0m16:55:49.145130 [info ] [MainThread]: 
[0m16:55:49.146781 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:55:49.151400 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.593173, "process_in_blocks": "171560", "process_kernel_time": 0.470211, "process_mem_max_rss": "160708", "process_out_blocks": "0", "process_user_time": 5.586754}
[0m16:55:49.153416 [debug] [MainThread]: Command `dbt run` failed at 16:55:49.153169 after 4.60 seconds
[0m16:55:49.154836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf34580e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde9e3d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde9e3d4c0>]}
[0m16:55:49.156564 [debug] [MainThread]: Flushing usage events
[0m16:55:50.097900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:04.529876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700aefbaaae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700aef355730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700aefbaab40>]}


============================== 17:15:04.545453 | 5074a72a-661d-4e4c-8ed2-c06d14b94085 ==============================
[0m17:15:04.545453 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:15:04.547237 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_cache_events': 'False', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt run -s stg_green_tripdata', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'target_path': 'None', 'quiet': 'False', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/usr/app/logs', 'use_colors': 'True', 'log_format': 'default'}
[0m17:15:05.256545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5074a72a-661d-4e4c-8ed2-c06d14b94085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700aeec9a810>]}
[0m17:15:05.416973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5074a72a-661d-4e4c-8ed2-c06d14b94085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700af1694980>]}
[0m17:15:05.420685 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:15:05.648059 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m17:15:06.840072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:06.841633 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:15:06.842750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:06.967520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5074a72a-661d-4e4c-8ed2-c06d14b94085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700ae614dd90>]}
[0m17:15:07.235710 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:15:07.252254 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:15:07.350883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5074a72a-661d-4e4c-8ed2-c06d14b94085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700ae5f759a0>]}
[0m17:15:07.352349 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m17:15:07.353553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5074a72a-661d-4e4c-8ed2-c06d14b94085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700ae5d12600>]}
[0m17:15:07.357423 [info ] [MainThread]: 
[0m17:15:07.358956 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:07.360904 [info ] [MainThread]: 
[0m17:15:07.363190 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:15:07.366069 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m17:15:07.468641 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m17:15:07.470486 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m17:15:07.471942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:07.555510 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m17:15:07.559332 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m17:15:07.567214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m17:15:07.568891 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m17:15:07.581902 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m17:15:07.583767 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m17:15:07.585201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:07.664747 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m17:15:07.667956 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m17:15:07.669428 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m17:15:07.671906 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:15:07.672876 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m17:15:07.674003 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m17:15:07.676458 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:15:07.679068 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m17:15:07.680274 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m17:15:07.681414 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m17:15:07.683364 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:15:07.684621 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m17:15:07.703151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m17:15:07.716552 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m17:15:07.717834 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m17:15:07.718738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:07.788735 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m17:15:07.790168 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m17:15:07.791240 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m17:15:07.826761 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m17:15:07.830052 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m17:15:07.833594 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m17:15:07.834744 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m17:15:07.841446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5074a72a-661d-4e4c-8ed2-c06d14b94085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700ae536a900>]}
[0m17:15:07.842870 [debug] [MainThread]: Using duckdb connection "master"
[0m17:15:07.844045 [debug] [MainThread]: On master: BEGIN
[0m17:15:07.844955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:07.908511 [debug] [MainThread]: SQL status: OK in 0.063 seconds
[0m17:15:07.910195 [debug] [MainThread]: On master: COMMIT
[0m17:15:07.911388 [debug] [MainThread]: Using duckdb connection "master"
[0m17:15:07.912533 [debug] [MainThread]: On master: COMMIT
[0m17:15:07.914417 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:15:07.915596 [debug] [MainThread]: On master: Close
[0m17:15:07.935573 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m17:15:07.937395 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_green_tripdata ............................. [RUN]
[0m17:15:07.939005 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_green_tripdata'
[0m17:15:07.940456 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m17:15:07.962993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m17:15:07.995756 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m17:15:08.064139 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m17:15:08.099264 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m17:15:08.100580 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m17:15:08.101953 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:15:08.191727 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m17:15:08.195245 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m17:15:08.196916 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m17:15:08.201200 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:15:08.215347 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m17:15:08.217226 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m17:15:08.221278 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:15:08.255264 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m17:15:08.257408 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m17:15:08.259348 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m17:15:08.277703 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m17:15:08.290319 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m17:15:08.292525 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_backup" cascade
[0m17:15:08.296205 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:15:08.301346 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m17:15:26.282318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5074a72a-661d-4e4c-8ed2-c06d14b94085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700aeedca000>]}
[0m17:15:26.284740 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.stg_green_tripdata ........................ [[32mOK[0m in 18.34s]
[0m17:15:26.286581 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m17:15:26.291920 [debug] [MainThread]: Using duckdb connection "master"
[0m17:15:26.293424 [debug] [MainThread]: On master: BEGIN
[0m17:15:26.294737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:26.382825 [debug] [MainThread]: SQL status: OK in 0.088 seconds
[0m17:15:26.384079 [debug] [MainThread]: On master: COMMIT
[0m17:15:26.385320 [debug] [MainThread]: Using duckdb connection "master"
[0m17:15:26.386792 [debug] [MainThread]: On master: COMMIT
[0m17:15:26.388959 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:15:26.390436 [debug] [MainThread]: On master: Close
[0m17:15:26.397754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:26.399194 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m17:15:26.400448 [debug] [MainThread]: Connection 'model.dbt_project.stg_green_tripdata' was properly closed.
[0m17:15:26.402267 [info ] [MainThread]: 
[0m17:15:26.403780 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 19.04 seconds (19.04s).
[0m17:15:26.405970 [debug] [MainThread]: Command end result
[0m17:15:26.541972 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:15:26.561612 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:15:26.591776 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:15:26.593261 [info ] [MainThread]: 
[0m17:15:26.594621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:26.595885 [info ] [MainThread]: 
[0m17:15:26.597339 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:15:26.602023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.264112, "process_in_blocks": "59328", "process_kernel_time": 11.8989, "process_mem_max_rss": "934080", "process_out_blocks": "0", "process_user_time": 61.375973}
[0m17:15:26.603978 [debug] [MainThread]: Command `dbt run` succeeded at 17:15:26.603503 after 22.27 seconds
[0m17:15:26.606585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700aef1c2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700aef1c2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700aef1c33e0>]}
[0m17:15:26.608147 [debug] [MainThread]: Flushing usage events
[0m17:15:27.410183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:05.263239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b123c0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b13901f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b12ace030>]}


============================== 17:16:05.277411 | 27456f9d-d20b-4888-b115-8fe6cbb6c767 ==============================
[0m17:16:05.277411 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:16:05.279946 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'log_format': 'default', 'quiet': 'False', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s stg_yellow_tripdata', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/logs'}
[0m17:16:05.764320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27456f9d-d20b-4888-b115-8fe6cbb6c767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b11e43f50>]}
[0m17:16:05.909147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27456f9d-d20b-4888-b115-8fe6cbb6c767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b11e89c40>]}
[0m17:16:05.911677 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:16:06.081999 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m17:16:07.157031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:07.158568 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:16:07.160105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:07.274619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27456f9d-d20b-4888-b115-8fe6cbb6c767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b11abe030>]}
[0m17:16:07.539787 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:16:07.554120 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:16:07.620259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27456f9d-d20b-4888-b115-8fe6cbb6c767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b08a3eea0>]}
[0m17:16:07.621711 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m17:16:07.622975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27456f9d-d20b-4888-b115-8fe6cbb6c767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b08cae090>]}
[0m17:16:07.627501 [info ] [MainThread]: 
[0m17:16:07.628616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:07.629665 [info ] [MainThread]: 
[0m17:16:07.631315 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:16:07.633809 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m17:16:07.713021 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m17:16:07.714673 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m17:16:07.715888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:07.794879 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m17:16:07.797776 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m17:16:07.805872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m17:16:07.807594 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m17:16:07.824460 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m17:16:07.826250 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m17:16:07.827634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:07.905820 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m17:16:07.909466 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m17:16:07.910823 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m17:16:07.912781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:16:07.914304 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m17:16:07.915636 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m17:16:07.917298 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:16:07.919540 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m17:16:07.920686 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m17:16:07.922083 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m17:16:07.924154 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:16:07.925516 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m17:16:07.944470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m17:16:07.957469 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m17:16:07.958993 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m17:16:07.960195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:08.031566 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m17:16:08.033054 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m17:16:08.034428 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m17:16:08.059759 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:16:08.062913 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m17:16:08.065528 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m17:16:08.066841 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m17:16:08.073601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27456f9d-d20b-4888-b115-8fe6cbb6c767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4aebfa6e10>]}
[0m17:16:08.075124 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:08.076109 [debug] [MainThread]: On master: BEGIN
[0m17:16:08.077224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:08.161992 [debug] [MainThread]: SQL status: OK in 0.085 seconds
[0m17:16:08.163535 [debug] [MainThread]: On master: COMMIT
[0m17:16:08.164892 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:08.166005 [debug] [MainThread]: On master: COMMIT
[0m17:16:08.169061 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:16:08.170721 [debug] [MainThread]: On master: Close
[0m17:16:08.186923 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m17:16:08.189394 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_yellow_tripdata ............................ [RUN]
[0m17:16:08.191786 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_yellow_tripdata'
[0m17:16:08.193074 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m17:16:08.213830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m17:16:08.241564 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m17:16:08.300402 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m17:16:08.330887 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m17:16:08.332319 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m17:16:08.333849 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:16:08.420816 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m17:16:08.422322 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m17:16:08.423570 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m17:16:08.426673 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:16:08.440177 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m17:16:08.441802 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m17:16:08.444175 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:16:08.474215 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m17:16:08.475735 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m17:16:08.477124 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m17:16:08.490719 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:16:08.504437 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m17:16:08.506907 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_backup" cascade
[0m17:16:08.509170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:16:08.514871 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m17:16:20.854986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27456f9d-d20b-4888-b115-8fe6cbb6c767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b11925e80>]}
[0m17:16:20.859558 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.stg_yellow_tripdata ....................... [[32mOK[0m in 12.66s]
[0m17:16:20.865510 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m17:16:20.875266 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:20.877753 [debug] [MainThread]: On master: BEGIN
[0m17:16:20.879708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:21.018890 [debug] [MainThread]: SQL status: OK in 0.139 seconds
[0m17:16:21.021159 [debug] [MainThread]: On master: COMMIT
[0m17:16:21.023016 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:21.024480 [debug] [MainThread]: On master: COMMIT
[0m17:16:21.027431 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:16:21.029161 [debug] [MainThread]: On master: Close
[0m17:16:21.040134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:21.042231 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m17:16:21.045564 [debug] [MainThread]: Connection 'model.dbt_project.stg_yellow_tripdata' was properly closed.
[0m17:16:21.047548 [info ] [MainThread]: 
[0m17:16:21.051123 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 13.42 seconds (13.42s).
[0m17:16:21.055413 [debug] [MainThread]: Command end result
[0m17:16:21.239443 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:16:21.256250 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:16:21.288309 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:16:21.289745 [info ] [MainThread]: 
[0m17:16:21.291987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:21.293775 [info ] [MainThread]: 
[0m17:16:21.295617 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:16:21.299691 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.227638, "process_in_blocks": "0", "process_kernel_time": 7.83577, "process_mem_max_rss": "826844", "process_out_blocks": "0", "process_user_time": 39.290146}
[0m17:16:21.302557 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:21.301972 after 16.23 seconds
[0m17:16:21.304575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b12207ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b13889640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4b13839190>]}
[0m17:16:21.306661 [debug] [MainThread]: Flushing usage events
[0m17:16:21.948505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:01.389309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7a7b0e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7a4cc27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7a3f90e90>]}


============================== 17:21:01.407042 | b08eab92-011e-450b-98b0-4fc791f5fff1 ==============================
[0m17:21:01.407042 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:21:01.408579 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'None', 'use_colors': 'True', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/usr/app/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test --select fct_trips', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'no_print': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'quiet': 'False'}
[0m17:21:01.901075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b08eab92-011e-450b-98b0-4fc791f5fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7a3804830>]}
[0m17:21:02.041525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b08eab92-011e-450b-98b0-4fc791f5fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7a37f2780>]}
[0m17:21:02.043809 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:21:02.204339 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m17:21:03.204111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:21:03.205758 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:21:03.207527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:21:03.318115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b08eab92-011e-450b-98b0-4fc791f5fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a79bb24e90>]}
[0m17:21:03.559131 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:21:03.577523 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:21:03.670936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b08eab92-011e-450b-98b0-4fc791f5fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a79a847920>]}
[0m17:21:03.672349 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m17:21:03.674067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b08eab92-011e-450b-98b0-4fc791f5fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a79fd716a0>]}
[0m17:21:03.678560 [info ] [MainThread]: 
[0m17:21:03.679817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:03.680897 [info ] [MainThread]: 
[0m17:21:03.682787 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:21:03.695889 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny_dev'
[0m17:21:03.768497 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m17:21:03.770198 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m17:21:03.771402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:03.877040 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m17:21:03.878597 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m17:21:03.879970 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m17:21:03.902531 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:21:03.906769 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m17:21:03.909343 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m17:21:03.910697 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m17:21:03.919553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b08eab92-011e-450b-98b0-4fc791f5fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a79fd72960>]}
[0m17:21:03.920955 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:03.922194 [debug] [MainThread]: On master: BEGIN
[0m17:21:03.923234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:04.016263 [debug] [MainThread]: SQL status: OK in 0.093 seconds
[0m17:21:04.017886 [debug] [MainThread]: On master: COMMIT
[0m17:21:04.019400 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:04.020794 [debug] [MainThread]: On master: COMMIT
[0m17:21:04.022810 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:21:04.024139 [debug] [MainThread]: On master: Close
[0m17:21:04.037849 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m17:21:04.039978 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_fct_trips_service_type__Green__Yellow ........ [RUN]
[0m17:21:04.041754 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c'
[0m17:21:04.043091 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m17:21:04.078551 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m17:21:04.158334 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m17:21:04.195269 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m17:21:04.276198 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m17:21:04.277774 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: BEGIN
[0m17:21:04.279070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:21:04.372336 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m17:21:04.373798 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m17:21:04.375386 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."dev"."fct_trips"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m17:21:04.418806 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."dev"."fct_trips"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m17:21:04.421487 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:21:04.423482 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: ROLLBACK
[0m17:21:04.439288 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c'
[0m17:21:04.440982 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: Close
[0m17:21:04.452074 [debug] [Thread-1 (]: Runtime Error in test accepted_values_fct_trips_service_type__Green__Yellow (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 20:     from "taxi_rides_ny"."dev"."fct_trips"
                    ^
[0m17:21:04.453658 [error] [Thread-1 (]: 1 of 9 ERROR accepted_values_fct_trips_service_type__Green__Yellow ............. [[31mERROR[0m in 0.41s]
[0m17:21:04.455459 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m17:21:04.457147 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83
[0m17:21:04.458440 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c' to be skipped because of status 'error'.  Reason: Runtime Error in test accepted_values_fct_trips_service_type__Green__Yellow (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 20:     from "taxi_rides_ny"."dev"."fct_trips"
                    ^.
[0m17:21:04.459319 [info ] [Thread-1 (]: 2 of 9 START test not_null_fct_trips_pickup_datetime ........................... [RUN]
[0m17:21:04.462522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c, now test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m17:21:04.463539 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83
[0m17:21:04.479682 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m17:21:04.514714 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83
[0m17:21:04.521063 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m17:21:04.555913 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m17:21:04.557482 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m17:21:04.558731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:04.656799 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m17:21:04.659347 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m17:21:04.660462 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."dev"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m17:21:04.677843 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."dev"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m17:21:04.679752 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:21:04.681417 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m17:21:04.686148 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m17:21:04.687713 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m17:21:04.698836 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_trips_pickup_datetime (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:04.700552 [error] [Thread-1 (]: 2 of 9 ERROR not_null_fct_trips_pickup_datetime ................................ [[31mERROR[0m in 0.24s]
[0m17:21:04.702331 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83
[0m17:21:04.703446 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f
[0m17:21:04.705227 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_trips_pickup_datetime (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^.
[0m17:21:04.706430 [info ] [Thread-1 (]: 3 of 9 START test not_null_fct_trips_service_type .............................. [RUN]
[0m17:21:04.708700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83, now test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f)
[0m17:21:04.709811 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f
[0m17:21:04.717488 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f"
[0m17:21:04.747468 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f
[0m17:21:04.752185 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f"
[0m17:21:04.780392 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f"
[0m17:21:04.781820 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f: BEGIN
[0m17:21:04.783161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:04.860061 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m17:21:04.861427 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f"
[0m17:21:04.862491 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."dev"."fct_trips"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m17:21:04.880640 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."dev"."fct_trips"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m17:21:04.882449 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:21:04.884020 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f: ROLLBACK
[0m17:21:04.890223 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f'
[0m17:21:04.891494 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f: Close
[0m17:21:04.906998 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_trips_service_type (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:04.910626 [error] [Thread-1 (]: 3 of 9 ERROR not_null_fct_trips_service_type ................................... [[31mERROR[0m in 0.20s]
[0m17:21:04.915155 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f
[0m17:21:04.918551 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d
[0m17:21:04.920159 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_trips_service_type (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^.
[0m17:21:04.923843 [info ] [Thread-1 (]: 4 of 9 START test not_null_fct_trips_total_amount .............................. [RUN]
[0m17:21:04.933039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f, now test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d)
[0m17:21:04.942035 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d
[0m17:21:04.950966 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d"
[0m17:21:04.980145 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d
[0m17:21:04.986037 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d"
[0m17:21:05.014737 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d"
[0m17:21:05.016142 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m17:21:05.017398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:05.102934 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m17:21:05.104401 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d"
[0m17:21:05.105754 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "taxi_rides_ny"."dev"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m17:21:05.129168 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "taxi_rides_ny"."dev"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m17:21:05.130903 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:21:05.132373 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m17:21:05.137522 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d'
[0m17:21:05.139075 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m17:21:05.149672 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_trips_total_amount (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:05.151743 [error] [Thread-1 (]: 4 of 9 ERROR not_null_fct_trips_total_amount ................................... [[31mERROR[0m in 0.22s]
[0m17:21:05.153503 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d
[0m17:21:05.155257 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d
[0m17:21:05.156524 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_trips_total_amount (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^.
[0m17:21:05.157536 [info ] [Thread-1 (]: 5 of 9 START test not_null_fct_trips_trip_id ................................... [RUN]
[0m17:21:05.159836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d, now test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d)
[0m17:21:05.160957 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d
[0m17:21:05.168748 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d"
[0m17:21:05.201379 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d
[0m17:21:05.207549 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d"
[0m17:21:05.249494 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d"
[0m17:21:05.251512 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m17:21:05.253267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:05.334420 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m17:21:05.335987 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d"
[0m17:21:05.337226 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."dev"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:05.355463 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."dev"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:05.357131 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:21:05.358727 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m17:21:05.364705 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d'
[0m17:21:05.366331 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m17:21:05.380952 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_trips_trip_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:05.382815 [error] [Thread-1 (]: 5 of 9 ERROR not_null_fct_trips_trip_id ........................................ [[31mERROR[0m in 0.22s]
[0m17:21:05.384603 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d
[0m17:21:05.386401 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:21:05.388079 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_trips_trip_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^.
[0m17:21:05.389859 [info ] [Thread-1 (]: 6 of 9 START test not_null_fct_trips_vendor_id ................................. [RUN]
[0m17:21:05.393307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d, now test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m17:21:05.394836 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:21:05.404116 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:21:05.440029 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:21:05.446722 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:21:05.485513 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:21:05.487297 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb: BEGIN
[0m17:21:05.489625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:05.570300 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m17:21:05.571642 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:21:05.574085 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."dev"."fct_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:05.597733 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."dev"."fct_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m17:21:05.599422 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:21:05.601150 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb: ROLLBACK
[0m17:21:05.609193 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb'
[0m17:21:05.610942 [debug] [Thread-1 (]: On test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb: Close
[0m17:21:05.621742 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_trips_vendor_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:05.624342 [error] [Thread-1 (]: 6 of 9 ERROR not_null_fct_trips_vendor_id ...................................... [[31mERROR[0m in 0.23s]
[0m17:21:05.627582 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:21:05.629277 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m17:21:05.630740 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_trips_vendor_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^.
[0m17:21:05.631679 [info ] [Thread-1 (]: 7 of 9 START test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_  [RUN]
[0m17:21:05.634087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb, now test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68)
[0m17:21:05.636398 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m17:21:05.664710 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m17:21:05.692361 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m17:21:05.699818 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m17:21:05.729319 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m17:21:05.730679 [debug] [Thread-1 (]: On test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: BEGIN
[0m17:21:05.731896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:05.818744 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m17:21:05.820788 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m17:21:05.823812 [debug] [Thread-1 (]: On test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "taxi_rides_ny"."dev"."fct_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "taxi_rides_ny"."dev"."dim_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:21:05.848034 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "taxi_rides_ny"."dev"."fct_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "taxi_rides_ny"."dev"."dim_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:21:05.849717 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:21:05.851233 [debug] [Thread-1 (]: On test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: ROLLBACK
[0m17:21:05.859301 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68'
[0m17:21:05.860943 [debug] [Thread-1 (]: On test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: Close
[0m17:21:05.873728 [debug] [Thread-1 (]: Runtime Error in test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_ (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 16:     from "taxi_rides_ny"."dev"."fct_trips"
                    ^
[0m17:21:05.876180 [error] [Thread-1 (]: 7 of 9 ERROR relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_  [[31mERROR[0m in 0.24s]
[0m17:21:05.878822 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m17:21:05.880367 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m17:21:05.881722 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68' to be skipped because of status 'error'.  Reason: Runtime Error in test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_ (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 16:     from "taxi_rides_ny"."dev"."fct_trips"
                    ^.
[0m17:21:05.883289 [info ] [Thread-1 (]: 8 of 9 START test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_  [RUN]
[0m17:21:05.886469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68, now test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4)
[0m17:21:05.887977 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m17:21:05.900642 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m17:21:05.926017 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m17:21:05.931694 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m17:21:05.961624 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m17:21:05.962946 [debug] [Thread-1 (]: On test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: BEGIN
[0m17:21:05.964130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:06.056443 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m17:21:06.058277 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m17:21:06.059521 [debug] [Thread-1 (]: On test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "taxi_rides_ny"."dev"."fct_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "taxi_rides_ny"."dev"."dim_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:21:06.083846 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "taxi_rides_ny"."dev"."fct_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "taxi_rides_ny"."dev"."dim_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:21:06.085961 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:21:06.087604 [debug] [Thread-1 (]: On test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: ROLLBACK
[0m17:21:06.097656 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4'
[0m17:21:06.099145 [debug] [Thread-1 (]: On test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: Close
[0m17:21:06.112112 [debug] [Thread-1 (]: Runtime Error in test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_ (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 16:     from "taxi_rides_ny"."dev"."fct_trips"
                    ^
[0m17:21:06.114414 [error] [Thread-1 (]: 8 of 9 ERROR relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_  [[31mERROR[0m in 0.23s]
[0m17:21:06.117076 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m17:21:06.118627 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab
[0m17:21:06.119782 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4' to be skipped because of status 'error'.  Reason: Runtime Error in test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_ (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 16:     from "taxi_rides_ny"."dev"."fct_trips"
                    ^.
[0m17:21:06.120705 [info ] [Thread-1 (]: 9 of 9 START test unique_fct_trips_trip_id ..................................... [RUN]
[0m17:21:06.125044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4, now test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab)
[0m17:21:06.126863 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab
[0m17:21:06.142478 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:21:06.170675 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab
[0m17:21:06.177358 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:21:06.207116 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:21:06.208542 [debug] [Thread-1 (]: On test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m17:21:06.209870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:06.309200 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m17:21:06.311330 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:21:06.312625 [debug] [Thread-1 (]: On test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."dev"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:06.337463 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."dev"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:21:06.340112 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:21:06.341763 [debug] [Thread-1 (]: On test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m17:21:06.347728 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab'
[0m17:21:06.349352 [debug] [Thread-1 (]: On test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m17:21:06.361894 [debug] [Thread-1 (]: Runtime Error in test unique_fct_trips_trip_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 18: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:06.363892 [error] [Thread-1 (]: 9 of 9 ERROR unique_fct_trips_trip_id .......................................... [[31mERROR[0m in 0.24s]
[0m17:21:06.365761 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab
[0m17:21:06.367731 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_fct_trips_trip_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 18: from "taxi_rides_ny"."dev"."fct_trips"
                ^.
[0m17:21:06.371779 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:06.373137 [debug] [MainThread]: On master: BEGIN
[0m17:21:06.374463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:06.463776 [debug] [MainThread]: SQL status: OK in 0.089 seconds
[0m17:21:06.465361 [debug] [MainThread]: On master: COMMIT
[0m17:21:06.466478 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:06.467454 [debug] [MainThread]: On master: COMMIT
[0m17:21:06.469106 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:21:06.470068 [debug] [MainThread]: On master: Close
[0m17:21:06.478837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:06.480446 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m17:21:06.481665 [debug] [MainThread]: Connection 'test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m17:21:06.483058 [info ] [MainThread]: 
[0m17:21:06.484527 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m17:21:06.493179 [debug] [MainThread]: Command end result
[0m17:21:06.725183 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:21:06.740954 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:21:06.773665 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:21:06.775708 [info ] [MainThread]: 
[0m17:21:06.778221 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m17:21:06.779923 [info ] [MainThread]: 
[0m17:21:06.781570 [error] [MainThread]: [31mFailure in test accepted_values_fct_trips_service_type__Green__Yellow (models/marts/schema.yml)[0m
[0m17:21:06.783033 [error] [MainThread]:   Runtime Error in test accepted_values_fct_trips_service_type__Green__Yellow (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 20:     from "taxi_rides_ny"."dev"."fct_trips"
                    ^
[0m17:21:06.784256 [info ] [MainThread]: 
[0m17:21:06.785910 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/accepted_values_fct_trips_service_type__Green__Yellow.sql
[0m17:21:06.787734 [info ] [MainThread]: 
[0m17:21:06.789645 [error] [MainThread]: [31mFailure in test not_null_fct_trips_pickup_datetime (models/marts/schema.yml)[0m
[0m17:21:06.791513 [error] [MainThread]:   Runtime Error in test not_null_fct_trips_pickup_datetime (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:06.793509 [info ] [MainThread]: 
[0m17:21:06.795215 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_fct_trips_pickup_datetime.sql
[0m17:21:06.796559 [info ] [MainThread]: 
[0m17:21:06.798154 [error] [MainThread]: [31mFailure in test not_null_fct_trips_service_type (models/marts/schema.yml)[0m
[0m17:21:06.799648 [error] [MainThread]:   Runtime Error in test not_null_fct_trips_service_type (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:06.801872 [info ] [MainThread]: 
[0m17:21:06.804123 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_fct_trips_service_type.sql
[0m17:21:06.808131 [info ] [MainThread]: 
[0m17:21:06.810159 [error] [MainThread]: [31mFailure in test not_null_fct_trips_total_amount (models/marts/schema.yml)[0m
[0m17:21:06.811791 [error] [MainThread]:   Runtime Error in test not_null_fct_trips_total_amount (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:06.813403 [info ] [MainThread]: 
[0m17:21:06.815781 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_fct_trips_total_amount.sql
[0m17:21:06.817164 [info ] [MainThread]: 
[0m17:21:06.819626 [error] [MainThread]: [31mFailure in test not_null_fct_trips_trip_id (models/marts/schema.yml)[0m
[0m17:21:06.823620 [error] [MainThread]:   Runtime Error in test not_null_fct_trips_trip_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:06.826258 [info ] [MainThread]: 
[0m17:21:06.828363 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_fct_trips_trip_id.sql
[0m17:21:06.829959 [info ] [MainThread]: 
[0m17:21:06.831930 [error] [MainThread]: [31mFailure in test not_null_fct_trips_vendor_id (models/marts/schema.yml)[0m
[0m17:21:06.833682 [error] [MainThread]:   Runtime Error in test not_null_fct_trips_vendor_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 17: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:06.836601 [info ] [MainThread]: 
[0m17:21:06.841554 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/not_null_fct_trips_vendor_id.sql
[0m17:21:06.843517 [info ] [MainThread]: 
[0m17:21:06.846405 [error] [MainThread]: [31mFailure in test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_ (models/marts/schema.yml)[0m
[0m17:21:06.848078 [error] [MainThread]:   Runtime Error in test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_ (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 16:     from "taxi_rides_ny"."dev"."fct_trips"
                    ^
[0m17:21:06.849627 [info ] [MainThread]: 
[0m17:21:06.853796 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/relationships_fct_trips_ad3060576ca78bd47560ec9e21a96e3f.sql
[0m17:21:06.858413 [info ] [MainThread]: 
[0m17:21:06.860390 [error] [MainThread]: [31mFailure in test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_ (models/marts/schema.yml)[0m
[0m17:21:06.863065 [error] [MainThread]:   Runtime Error in test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_ (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 16:     from "taxi_rides_ny"."dev"."fct_trips"
                    ^
[0m17:21:06.865784 [info ] [MainThread]: 
[0m17:21:06.868400 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/relationships_fct_trips_d47e97bfe07500b11a10d61b874aa24c.sql
[0m17:21:06.874264 [info ] [MainThread]: 
[0m17:21:06.876212 [error] [MainThread]: [31mFailure in test unique_fct_trips_trip_id (models/marts/schema.yml)[0m
[0m17:21:06.877886 [error] [MainThread]:   Runtime Error in test unique_fct_trips_trip_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 18: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m17:21:06.879420 [info ] [MainThread]: 
[0m17:21:06.882904 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/schema.yml/unique_fct_trips_trip_id.sql
[0m17:21:06.884964 [info ] [MainThread]: 
[0m17:21:06.890244 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=9 SKIP=0 NO-OP=0 TOTAL=9
[0m17:21:06.894545 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.694488, "process_in_blocks": "6856", "process_kernel_time": 0.717395, "process_mem_max_rss": "159052", "process_out_blocks": "0", "process_user_time": 6.420693}
[0m17:21:06.896848 [debug] [MainThread]: Command `dbt test` failed at 17:21:06.896455 after 5.70 seconds
[0m17:21:06.898474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7a48551c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7a4856c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a79a611640>]}
[0m17:21:06.899643 [debug] [MainThread]: Flushing usage events
[0m17:21:07.593516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:37:25.264228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c44184bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c441868d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c44184ce0>]}


============================== 18:37:25.279814 | a8082071-b6a8-4732-ad89-03d8aee3ef3a ==============================
[0m18:37:25.279814 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:37:25.281413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'invocation_command': 'dbt run -s fct_monthly_zone_revenue', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'empty': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:37:25.747642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8082071-b6a8-4732-ad89-03d8aee3ef3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c42fd09e0>]}
[0m18:37:25.876734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8082071-b6a8-4732-ad89-03d8aee3ef3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c43060170>]}
[0m18:37:25.880220 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:37:26.040056 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m18:37:27.104875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:27.107015 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:37:27.108695 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:27.251836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8082071-b6a8-4732-ad89-03d8aee3ef3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c3b430980>]}
[0m18:37:27.558408 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:37:27.575768 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:37:27.677563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8082071-b6a8-4732-ad89-03d8aee3ef3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c3a31bf50>]}
[0m18:37:27.679300 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m18:37:27.680870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8082071-b6a8-4732-ad89-03d8aee3ef3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c3a30aea0>]}
[0m18:37:27.685758 [info ] [MainThread]: 
[0m18:37:27.687189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:27.690150 [info ] [MainThread]: 
[0m18:37:27.693367 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:37:27.696412 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m18:37:27.807961 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m18:37:27.809511 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m18:37:27.810674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:30.289444 [debug] [ThreadPool]: SQL status: OK in 2.477 seconds
[0m18:37:30.293865 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m18:37:30.306976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m18:37:30.309022 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m18:37:30.333504 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:37:30.335175 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m18:37:30.336753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:30.456534 [debug] [ThreadPool]: SQL status: OK in 0.120 seconds
[0m18:37:30.461117 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:37:30.462637 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m18:37:30.464865 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:37:30.466473 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:37:30.468100 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m18:37:30.470500 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:37:30.474154 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m18:37:30.475575 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:37:30.476783 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m18:37:30.479078 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:37:30.481146 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m18:37:30.510790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m18:37:30.526758 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m18:37:30.528391 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m18:37:30.529979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:30.646516 [debug] [ThreadPool]: SQL status: OK in 0.116 seconds
[0m18:37:30.648621 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m18:37:30.650238 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m18:37:30.693776 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m18:37:30.699039 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m18:37:30.704867 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m18:37:30.706944 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m18:37:30.720575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8082071-b6a8-4732-ad89-03d8aee3ef3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c45c19010>]}
[0m18:37:30.723603 [debug] [MainThread]: Using duckdb connection "master"
[0m18:37:30.725478 [debug] [MainThread]: On master: BEGIN
[0m18:37:30.726920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:37:30.859628 [debug] [MainThread]: SQL status: OK in 0.133 seconds
[0m18:37:30.862292 [debug] [MainThread]: On master: COMMIT
[0m18:37:30.864364 [debug] [MainThread]: Using duckdb connection "master"
[0m18:37:30.867221 [debug] [MainThread]: On master: COMMIT
[0m18:37:30.871125 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:37:30.873159 [debug] [MainThread]: On master: Close
[0m18:37:30.901945 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m18:37:30.904892 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.fct_monthly_zone_revenue ....................... [RUN]
[0m18:37:30.908936 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.fct_monthly_zone_revenue'
[0m18:37:30.912966 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_monthly_zone_revenue
[0m18:37:30.954240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_monthly_zone_revenue"
[0m18:37:31.017834 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_monthly_zone_revenue
[0m18:37:31.233194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_monthly_zone_revenue"
[0m18:37:31.309450 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m18:37:31.313312 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: BEGIN
[0m18:37:31.316141 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:37:31.654277 [debug] [Thread-1 (]: SQL status: OK in 0.338 seconds
[0m18:37:31.657863 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m18:37:31.660585 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */

  
  create view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" as (
    -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime)
     as revenue_month,
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."dev"."fct_trips"
group by pickup_zone, revenue_month, service_type
  );

[0m18:37:31.731516 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */

  
  create view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" as (
    -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime)
     as revenue_month,
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."dev"."fct_trips"
group by pickup_zone, revenue_month, service_type
  );

[0m18:37:31.734899 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:37:31.738455 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: ROLLBACK
[0m18:37:31.765990 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.fct_monthly_zone_revenue'
[0m18:37:31.768890 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: Close
[0m18:37:31.793595 [debug] [Thread-1 (]: Runtime Error in model fct_monthly_zone_revenue (models/marts/reporting/fct_monthly_zone_revenue.sql)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 31: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m18:37:31.807389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8082071-b6a8-4732-ad89-03d8aee3ef3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c43fd0ad0>]}
[0m18:37:31.810820 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev.fct_monthly_zone_revenue .............. [[31mERROR[0m in 0.89s]
[0m18:37:31.814154 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m18:37:31.818010 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_monthly_zone_revenue' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_monthly_zone_revenue (models/marts/reporting/fct_monthly_zone_revenue.sql)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 31: from "taxi_rides_ny"."dev"."fct_trips"
                ^.
[0m18:37:31.827815 [debug] [MainThread]: Using duckdb connection "master"
[0m18:37:31.830684 [debug] [MainThread]: On master: BEGIN
[0m18:37:31.833350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:37:31.970167 [debug] [MainThread]: SQL status: OK in 0.137 seconds
[0m18:37:31.972733 [debug] [MainThread]: On master: COMMIT
[0m18:37:31.974126 [debug] [MainThread]: Using duckdb connection "master"
[0m18:37:31.975576 [debug] [MainThread]: On master: COMMIT
[0m18:37:31.978564 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:37:31.980392 [debug] [MainThread]: On master: Close
[0m18:37:31.991618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:31.993521 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m18:37:31.995240 [debug] [MainThread]: Connection 'model.dbt_project.fct_monthly_zone_revenue' was properly closed.
[0m18:37:31.997061 [info ] [MainThread]: 
[0m18:37:31.999694 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m18:37:32.005035 [debug] [MainThread]: Command end result
[0m18:37:32.169323 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:37:32.184241 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:37:32.213587 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m18:37:32.215207 [info ] [MainThread]: 
[0m18:37:32.217330 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:37:32.219231 [info ] [MainThread]: 
[0m18:37:32.221564 [error] [MainThread]: [31mFailure in model fct_monthly_zone_revenue (models/marts/reporting/fct_monthly_zone_revenue.sql)[0m
[0m18:37:32.223511 [error] [MainThread]:   Runtime Error in model fct_monthly_zone_revenue (models/marts/reporting/fct_monthly_zone_revenue.sql)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 31: from "taxi_rides_ny"."dev"."fct_trips"
                ^
[0m18:37:32.225289 [info ] [MainThread]: 
[0m18:37:32.227375 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/reporting/fct_monthly_zone_revenue.sql
[0m18:37:32.229322 [info ] [MainThread]: 
[0m18:37:32.231983 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:37:32.239347 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.1964407, "process_in_blocks": "14008", "process_kernel_time": 1.122068, "process_mem_max_rss": "206484", "process_out_blocks": "41840", "process_user_time": 7.915683}
[0m18:37:32.241272 [debug] [MainThread]: Command `dbt run` failed at 18:37:32.240976 after 7.20 seconds
[0m18:37:32.242953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c44594da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c397e4e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768c4405ea20>]}
[0m18:37:32.245566 [debug] [MainThread]: Flushing usage events
[0m18:37:33.018062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:37:52.102876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0813503980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0810916240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08109176b0>]}


============================== 18:37:52.119166 | 40304cc4-5c08-4389-bbc1-245a928b1021 ==============================
[0m18:37:52.119166 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:37:52.120714 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'log_path': '/usr/app/logs', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'invocation_command': 'dbt run -s +fct_monthly_zone_revenue', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'empty': 'False', 'static_parser': 'True', 'log_cache_events': 'False'}
[0m18:37:52.613092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40304cc4-5c08-4389-bbc1-245a928b1021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0810547170>]}
[0m18:37:52.753484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40304cc4-5c08-4389-bbc1-245a928b1021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0810df4bc0>]}
[0m18:37:52.756002 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:37:52.930172 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m18:37:53.931636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:53.933408 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:37:53.934821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:54.057246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40304cc4-5c08-4389-bbc1-245a928b1021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0808999ca0>]}
[0m18:37:54.331188 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:37:54.348319 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:37:54.424964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40304cc4-5c08-4389-bbc1-245a928b1021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0803864560>]}
[0m18:37:54.426647 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m18:37:54.428079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40304cc4-5c08-4389-bbc1-245a928b1021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08105e7a40>]}
[0m18:37:54.434063 [info ] [MainThread]: 
[0m18:37:54.435894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:54.437115 [info ] [MainThread]: 
[0m18:37:54.438747 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:37:54.451075 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m18:37:54.548602 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m18:37:54.549981 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m18:37:54.551284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:54.653131 [debug] [ThreadPool]: SQL status: OK in 0.102 seconds
[0m18:37:54.656459 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m18:37:54.664583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m18:37:54.666231 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m18:37:54.679835 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:37:54.681104 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m18:37:54.682101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:54.779572 [debug] [ThreadPool]: SQL status: OK in 0.097 seconds
[0m18:37:54.782929 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:37:54.784117 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m18:37:54.786237 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:37:54.787464 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:37:54.788612 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m18:37:54.790569 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:37:54.793874 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m18:37:54.795061 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:37:54.796154 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m18:37:54.797959 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:37:54.799030 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m18:37:54.808439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m18:37:54.818845 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m18:37:54.820193 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m18:37:54.821314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:54.912239 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m18:37:54.913709 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m18:37:54.914824 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m18:37:54.936323 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m18:37:54.939617 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m18:37:54.942766 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m18:37:54.944067 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m18:37:54.954210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40304cc4-5c08-4389-bbc1-245a928b1021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081301cc80>]}
[0m18:37:54.955421 [debug] [MainThread]: Using duckdb connection "master"
[0m18:37:54.956506 [debug] [MainThread]: On master: BEGIN
[0m18:37:54.957970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:37:55.046604 [debug] [MainThread]: SQL status: OK in 0.089 seconds
[0m18:37:55.048231 [debug] [MainThread]: On master: COMMIT
[0m18:37:55.049421 [debug] [MainThread]: Using duckdb connection "master"
[0m18:37:55.050298 [debug] [MainThread]: On master: COMMIT
[0m18:37:55.052739 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:37:55.053904 [debug] [MainThread]: On master: Close
[0m18:37:55.068991 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m18:37:55.070723 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.dim_zones ...................................... [RUN]
[0m18:37:55.072419 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m18:37:55.073582 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m18:37:55.097480 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m18:37:55.122192 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m18:37:55.195370 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m18:37:55.226073 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m18:37:55.227747 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m18:37:55.229263 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:37:55.339104 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m18:37:55.341223 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m18:37:55.342979 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m18:37:55.362149 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m18:37:55.363715 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:37:55.365279 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: ROLLBACK
[0m18:37:55.372427 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.dim_zones'
[0m18:37:55.373778 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m18:37:55.387759 [debug] [Thread-1 (]: Runtime Error in model dim_zones (models/marts/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^
[0m18:37:55.392585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40304cc4-5c08-4389-bbc1-245a928b1021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0802a974d0>]}
[0m18:37:55.394271 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model dev.dim_zones ............................. [[31mERROR[0m in 0.32s]
[0m18:37:55.395718 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m18:37:55.397195 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m18:37:55.398113 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.dim_zones' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_zones (models/marts/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^.
[0m18:37:55.398992 [info ] [Thread-1 (]: 2 of 4 START sql view model dev.int_trips ...................................... [RUN]
[0m18:37:55.402648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.int_trips)
[0m18:37:55.403672 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m18:37:55.423757 [debug] [Thread-1 (]: Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:37:55.426550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40304cc4-5c08-4389-bbc1-245a928b1021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08001a56d0>]}
[0m18:37:55.428639 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model dev.int_trips ............................. [[31mERROR[0m in 0.02s]
[0m18:37:55.430402 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m18:37:55.432150 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.int_trips' to be skipped because of status 'error'.  Reason: Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:37:55.435065 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m18:37:55.436333 [info ] [Thread-1 (]: 3 of 4 SKIP relation dev.fct_trips ............................................. [[33mSKIP[0m]
[0m18:37:55.437656 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m18:37:55.440215 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m18:37:55.441699 [info ] [Thread-1 (]: 4 of 4 SKIP relation dev.fct_monthly_zone_revenue .............................. [[33mSKIP[0m]
[0m18:37:55.443342 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m18:37:55.447205 [debug] [MainThread]: Using duckdb connection "master"
[0m18:37:55.448675 [debug] [MainThread]: On master: BEGIN
[0m18:37:55.449949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:37:55.536416 [debug] [MainThread]: SQL status: OK in 0.086 seconds
[0m18:37:55.538194 [debug] [MainThread]: On master: COMMIT
[0m18:37:55.539627 [debug] [MainThread]: Using duckdb connection "master"
[0m18:37:55.540805 [debug] [MainThread]: On master: COMMIT
[0m18:37:55.543235 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:37:55.544657 [debug] [MainThread]: On master: Close
[0m18:37:55.552328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:55.553608 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m18:37:55.554656 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was properly closed.
[0m18:37:55.555901 [info ] [MainThread]: 
[0m18:37:55.557127 [info ] [MainThread]: Finished running 1 incremental model, 3 view models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m18:37:55.561543 [debug] [MainThread]: Command end result
[0m18:37:55.694329 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:37:55.712058 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:37:55.733131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m18:37:55.734242 [info ] [MainThread]: 
[0m18:37:55.735494 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:37:55.737098 [info ] [MainThread]: 
[0m18:37:55.738577 [error] [MainThread]: [31mFailure in model dim_zones (models/marts/dim_zones.sql)[0m
[0m18:37:55.740193 [error] [MainThread]:   Runtime Error in model dim_zones (models/marts/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^
[0m18:37:55.742986 [info ] [MainThread]: 
[0m18:37:55.747643 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/dim_zones.sql
[0m18:37:55.749358 [info ] [MainThread]: 
[0m18:37:55.750940 [error] [MainThread]: [31mFailure in model int_trips (models/intermediate/int_trips.sql)[0m
[0m18:37:55.752539 [error] [MainThread]:   Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:37:55.754155 [info ] [MainThread]: 
[0m18:37:55.755554 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m18:37:55.761405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.8460188, "process_in_blocks": "232", "process_kernel_time": 0.624265, "process_mem_max_rss": "158920", "process_out_blocks": "0", "process_user_time": 6.068347}
[0m18:37:55.762936 [debug] [MainThread]: Command `dbt run` failed at 18:37:55.762688 after 3.85 seconds
[0m18:37:55.764276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08114fa540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081044bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081054b6b0>]}
[0m18:37:55.765754 [debug] [MainThread]: Flushing usage events
[0m18:37:56.402846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:04.219986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fa7799100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fa7798fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fa7798740>]}


============================== 18:38:04.232364 | 593d1da3-513f-4861-8fe4-83ef22ebbd3d ==============================
[0m18:38:04.232364 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:38:04.233865 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run -s +fct_monthly_zone_revenue+', 'indirect_selection': 'eager', 'target_path': 'None', 'printer_width': '80'}
[0m18:38:04.693960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '593d1da3-513f-4861-8fe4-83ef22ebbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fa6fe5c70>]}
[0m18:38:04.843662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '593d1da3-513f-4861-8fe4-83ef22ebbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fa9e594c0>]}
[0m18:38:04.845938 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:38:05.014015 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m18:38:05.985488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:05.987044 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:38:05.988295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:06.111413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '593d1da3-513f-4861-8fe4-83ef22ebbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8f9f388080>]}
[0m18:38:06.389689 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:38:06.407686 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:38:06.473055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '593d1da3-513f-4861-8fe4-83ef22ebbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8f9e2bc7d0>]}
[0m18:38:06.474772 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m18:38:06.476113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '593d1da3-513f-4861-8fe4-83ef22ebbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8f9e20b290>]}
[0m18:38:06.481218 [info ] [MainThread]: 
[0m18:38:06.482677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:06.483982 [info ] [MainThread]: 
[0m18:38:06.485767 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:38:06.496871 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m18:38:06.574171 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m18:38:06.575900 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m18:38:06.577251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:06.674738 [debug] [ThreadPool]: SQL status: OK in 0.097 seconds
[0m18:38:06.678149 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m18:38:06.686910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m18:38:06.688803 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m18:38:06.702585 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:38:06.704116 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m18:38:06.705474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:06.811941 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m18:38:06.815341 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:38:06.816502 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m18:38:06.818449 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:38:06.819483 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:38:06.820679 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m18:38:06.822647 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:38:06.824768 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m18:38:06.825990 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:38:06.827346 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m18:38:06.829633 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:38:06.830855 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m18:38:06.842166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m18:38:06.852958 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m18:38:06.854575 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m18:38:06.855656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:06.956002 [debug] [ThreadPool]: SQL status: OK in 0.100 seconds
[0m18:38:06.957656 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m18:38:06.959037 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m18:38:06.986086 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m18:38:06.989696 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m18:38:06.992908 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m18:38:06.994601 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m18:38:07.006175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '593d1da3-513f-4861-8fe4-83ef22ebbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8f9f30b4a0>]}
[0m18:38:07.007819 [debug] [MainThread]: Using duckdb connection "master"
[0m18:38:07.008941 [debug] [MainThread]: On master: BEGIN
[0m18:38:07.010233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:07.110415 [debug] [MainThread]: SQL status: OK in 0.100 seconds
[0m18:38:07.112573 [debug] [MainThread]: On master: COMMIT
[0m18:38:07.113785 [debug] [MainThread]: Using duckdb connection "master"
[0m18:38:07.114930 [debug] [MainThread]: On master: COMMIT
[0m18:38:07.117063 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:38:07.118170 [debug] [MainThread]: On master: Close
[0m18:38:07.132390 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m18:38:07.134078 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.dim_zones ...................................... [RUN]
[0m18:38:07.135869 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m18:38:07.138173 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m18:38:07.154882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m18:38:07.179139 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m18:38:07.245602 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m18:38:07.269159 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m18:38:07.270847 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m18:38:07.272198 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:07.368483 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m18:38:07.370292 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m18:38:07.371703 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m18:38:07.390626 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m18:38:07.392288 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:38:07.393835 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: ROLLBACK
[0m18:38:07.401020 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.dim_zones'
[0m18:38:07.403280 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m18:38:07.414758 [debug] [Thread-1 (]: Runtime Error in model dim_zones (models/marts/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^
[0m18:38:07.419911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '593d1da3-513f-4861-8fe4-83ef22ebbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8f9f30b4a0>]}
[0m18:38:07.421935 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model dev.dim_zones ............................. [[31mERROR[0m in 0.28s]
[0m18:38:07.424130 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m18:38:07.425438 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m18:38:07.426427 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.dim_zones' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_zones (models/marts/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^.
[0m18:38:07.427354 [info ] [Thread-1 (]: 2 of 4 START sql view model dev.int_trips ...................................... [RUN]
[0m18:38:07.431737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.int_trips)
[0m18:38:07.433229 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m18:38:07.445085 [debug] [Thread-1 (]: Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:38:07.447020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '593d1da3-513f-4861-8fe4-83ef22ebbd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8f9c0b1610>]}
[0m18:38:07.448948 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model dev.int_trips ............................. [[31mERROR[0m in 0.02s]
[0m18:38:07.450722 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m18:38:07.452443 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.int_trips' to be skipped because of status 'error'.  Reason: Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:38:07.455539 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m18:38:07.456854 [info ] [Thread-1 (]: 3 of 4 SKIP relation dev.fct_trips ............................................. [[33mSKIP[0m]
[0m18:38:07.458542 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m18:38:07.461248 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m18:38:07.462492 [info ] [Thread-1 (]: 4 of 4 SKIP relation dev.fct_monthly_zone_revenue .............................. [[33mSKIP[0m]
[0m18:38:07.463948 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m18:38:07.467615 [debug] [MainThread]: Using duckdb connection "master"
[0m18:38:07.469024 [debug] [MainThread]: On master: BEGIN
[0m18:38:07.470392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:38:07.559740 [debug] [MainThread]: SQL status: OK in 0.089 seconds
[0m18:38:07.561311 [debug] [MainThread]: On master: COMMIT
[0m18:38:07.562453 [debug] [MainThread]: Using duckdb connection "master"
[0m18:38:07.563514 [debug] [MainThread]: On master: COMMIT
[0m18:38:07.565187 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:38:07.566390 [debug] [MainThread]: On master: Close
[0m18:38:07.573919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:07.575226 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m18:38:07.576289 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was properly closed.
[0m18:38:07.577612 [info ] [MainThread]: 
[0m18:38:07.578792 [info ] [MainThread]: Finished running 1 incremental model, 3 view models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m18:38:07.581558 [debug] [MainThread]: Command end result
[0m18:38:07.719032 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:38:07.739381 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:38:07.769658 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m18:38:07.771029 [info ] [MainThread]: 
[0m18:38:07.772324 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:38:07.774149 [info ] [MainThread]: 
[0m18:38:07.775719 [error] [MainThread]: [31mFailure in model dim_zones (models/marts/dim_zones.sql)[0m
[0m18:38:07.777530 [error] [MainThread]:   Runtime Error in model dim_zones (models/marts/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^
[0m18:38:07.778777 [info ] [MainThread]: 
[0m18:38:07.780137 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/dim_zones.sql
[0m18:38:07.781618 [info ] [MainThread]: 
[0m18:38:07.782903 [error] [MainThread]: [31mFailure in model int_trips (models/intermediate/int_trips.sql)[0m
[0m18:38:07.784273 [error] [MainThread]:   Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:38:07.786013 [info ] [MainThread]: 
[0m18:38:07.787614 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m18:38:07.791232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.735804, "process_in_blocks": "0", "process_kernel_time": 0.470113, "process_mem_max_rss": "158564", "process_out_blocks": "0", "process_user_time": 5.61323}
[0m18:38:07.792737 [debug] [MainThread]: Command `dbt run` failed at 18:38:07.792491 after 3.74 seconds
[0m18:38:07.794052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8f9d5ee5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8f9d693fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fa97a75c0>]}
[0m18:38:07.795291 [debug] [MainThread]: Flushing usage events
[0m18:38:08.572673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:37.757385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76228d82acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76228d829d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76228d828d40>]}


============================== 18:38:37.769042 | 34787480-58ea-4e1b-91cd-0f3333868f64 ==============================
[0m18:38:37.769042 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:38:37.771890 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'empty': 'False', 'log_path': '/usr/app/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -s +dim_zones+', 'version_check': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m18:38:38.143522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34787480-58ea-4e1b-91cd-0f3333868f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622895391c0>]}
[0m18:38:38.262027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34787480-58ea-4e1b-91cd-0f3333868f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76228958a600>]}
[0m18:38:38.263961 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:38:38.419006 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m18:38:39.305382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:39.307093 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:38:39.308474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:39.436030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34787480-58ea-4e1b-91cd-0f3333868f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622853896d0>]}
[0m18:38:39.705075 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:38:39.721991 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:38:39.786354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34787480-58ea-4e1b-91cd-0f3333868f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762285388890>]}
[0m18:38:39.788279 [info ] [MainThread]: Found 7 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m18:38:39.789434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34787480-58ea-4e1b-91cd-0f3333868f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622895dd670>]}
[0m18:38:39.794330 [info ] [MainThread]: 
[0m18:38:39.795550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:39.796447 [info ] [MainThread]: 
[0m18:38:39.798304 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:38:39.809476 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m18:38:39.883320 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m18:38:39.884809 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m18:38:39.886431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:40.016376 [debug] [ThreadPool]: SQL status: OK in 0.130 seconds
[0m18:38:40.019950 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m18:38:40.029179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m18:38:40.030947 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m18:38:40.043104 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:38:40.044870 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m18:38:40.046412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:40.153871 [debug] [ThreadPool]: SQL status: OK in 0.107 seconds
[0m18:38:40.156768 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:38:40.158314 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m18:38:40.160099 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:38:40.161330 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:38:40.162848 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m18:38:40.164875 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:38:40.167231 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m18:38:40.168577 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m18:38:40.169830 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m18:38:40.171963 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:38:40.173441 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m18:38:40.184491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m18:38:40.196485 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m18:38:40.198192 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m18:38:40.199479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:40.299538 [debug] [ThreadPool]: SQL status: OK in 0.100 seconds
[0m18:38:40.301062 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m18:38:40.302352 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m18:38:40.324850 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m18:38:40.328088 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m18:38:40.330711 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m18:38:40.331937 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m18:38:40.341012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34787480-58ea-4e1b-91cd-0f3333868f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76228fadcb30>]}
[0m18:38:40.342448 [debug] [MainThread]: Using duckdb connection "master"
[0m18:38:40.343583 [debug] [MainThread]: On master: BEGIN
[0m18:38:40.344503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:40.452451 [debug] [MainThread]: SQL status: OK in 0.108 seconds
[0m18:38:40.454103 [debug] [MainThread]: On master: COMMIT
[0m18:38:40.455113 [debug] [MainThread]: Using duckdb connection "master"
[0m18:38:40.456222 [debug] [MainThread]: On master: COMMIT
[0m18:38:40.458142 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:38:40.459350 [debug] [MainThread]: On master: Close
[0m18:38:40.473376 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m18:38:40.475152 [info ] [Thread-1 (]: 1 of 3 START sql view model dev.dim_zones ...................................... [RUN]
[0m18:38:40.476508 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m18:38:40.477633 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m18:38:40.491942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m18:38:40.517391 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m18:38:40.578941 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m18:38:40.609322 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m18:38:40.610618 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m18:38:40.611709 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:40.702928 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m18:38:40.704554 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m18:38:40.706128 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m18:38:40.725751 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m18:38:40.727615 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:38:40.729209 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: ROLLBACK
[0m18:38:40.736664 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.dim_zones'
[0m18:38:40.737957 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m18:38:40.748412 [debug] [Thread-1 (]: Runtime Error in model dim_zones (models/marts/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^
[0m18:38:40.751846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34787480-58ea-4e1b-91cd-0f3333868f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76228533acf0>]}
[0m18:38:40.753852 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dev.dim_zones ............................. [[31mERROR[0m in 0.27s]
[0m18:38:40.755785 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m18:38:40.757325 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.dim_zones' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_zones (models/marts/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^.
[0m18:38:40.760720 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m18:38:40.762002 [info ] [Thread-1 (]: 2 of 3 SKIP relation dev.fct_trips ............................................. [[33mSKIP[0m]
[0m18:38:40.763268 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m18:38:40.764933 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m18:38:40.766289 [info ] [Thread-1 (]: 3 of 3 SKIP relation dev.fct_monthly_zone_revenue .............................. [[33mSKIP[0m]
[0m18:38:40.767696 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m18:38:40.771842 [debug] [MainThread]: Using duckdb connection "master"
[0m18:38:40.773206 [debug] [MainThread]: On master: BEGIN
[0m18:38:40.774667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:38:40.872256 [debug] [MainThread]: SQL status: OK in 0.098 seconds
[0m18:38:40.873578 [debug] [MainThread]: On master: COMMIT
[0m18:38:40.874808 [debug] [MainThread]: Using duckdb connection "master"
[0m18:38:40.876082 [debug] [MainThread]: On master: COMMIT
[0m18:38:40.877957 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:38:40.879062 [debug] [MainThread]: On master: Close
[0m18:38:40.887091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:40.888275 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m18:38:40.889306 [debug] [MainThread]: Connection 'model.dbt_project.dim_zones' was properly closed.
[0m18:38:40.890516 [info ] [MainThread]: 
[0m18:38:40.891655 [info ] [MainThread]: Finished running 1 incremental model, 2 view models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m18:38:40.893774 [debug] [MainThread]: Command end result
[0m18:38:41.025581 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:38:41.040572 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:38:41.084680 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m18:38:41.089597 [info ] [MainThread]: 
[0m18:38:41.091734 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:38:41.093975 [info ] [MainThread]: 
[0m18:38:41.095931 [error] [MainThread]: [31mFailure in model dim_zones (models/marts/dim_zones.sql)[0m
[0m18:38:41.097809 [error] [MainThread]:   Runtime Error in model dim_zones (models/marts/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^
[0m18:38:41.100001 [info ] [MainThread]: 
[0m18:38:41.101806 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/dim_zones.sql
[0m18:38:41.103882 [info ] [MainThread]: 
[0m18:38:41.105665 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m18:38:41.115880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5202217, "process_in_blocks": "0", "process_kernel_time": 0.626082, "process_mem_max_rss": "158796", "process_out_blocks": "0", "process_user_time": 5.032583}
[0m18:38:41.118897 [debug] [MainThread]: Command `dbt run` failed at 18:38:41.118376 after 3.52 seconds
[0m18:38:41.120589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622895de360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76228ded0e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76228ded1100>]}
[0m18:38:41.122736 [debug] [MainThread]: Flushing usage events
[0m18:38:41.928213 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:39.316936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c8ee87f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c8f58fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c8ef50320>]}


============================== 18:41:39.331981 | 0f5e026a-219c-4acb-bdc7-d9ea53b60761 ==============================
[0m18:41:39.331981 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:41:39.334069 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'empty': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run -s +dim_zones+', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'printer_width': '80', 'introspect': 'True', 'log_path': '/usr/app/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/root/.dbt', 'target_path': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True'}
[0m18:41:39.806001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f5e026a-219c-4acb-bdc7-d9ea53b60761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c8e5bb9b0>]}
[0m18:41:39.948296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f5e026a-219c-4acb-bdc7-d9ea53b60761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c8e4e4bc0>]}
[0m18:41:39.950996 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:41:40.101758 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m18:41:41.178466 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m18:41:41.180973 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/fct_trips.sql
[0m18:41:41.182289 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/dim_vendors.sql
[0m18:41:41.183563 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/dim_zones.sql
[0m18:41:41.185071 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/intermediate/fct_trips.sql
[0m18:41:41.186650 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models/marts/dim_zones.sql
[0m18:41:41.830554 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fct_trips").
  
  To fix this, change the name of one of these resources:
  - model.dbt_project.fct_trips (models/intermediate/fct_trips.sql)
  - model.dbt_project.fct_trips (models/marts/reporting/fct_trips.sql)
[0m18:41:41.833526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6915977, "process_in_blocks": "384", "process_kernel_time": 0.461401, "process_mem_max_rss": "141264", "process_out_blocks": "0", "process_user_time": 5.380345}
[0m18:41:41.835120 [debug] [MainThread]: Command `dbt run` failed at 18:41:41.834903 after 2.69 seconds
[0m18:41:41.836421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c92d829f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c8698a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c855543e0>]}
[0m18:41:41.837965 [debug] [MainThread]: Flushing usage events
[0m18:41:42.508769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:58.207055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fddf736ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fddf1c4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fddeebf6e0>]}


============================== 18:41:58.219821 | 4798fd85-c9ff-4d14-b545-10fea11290fb ==============================
[0m18:41:58.219821 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:41:58.224259 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run -s +fct_monthly_zone_revenue+', 'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'printer_width': '80', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'log_path': '/usr/app/logs', 'partial_parse': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'indirect_selection': 'eager'}
[0m18:41:58.644993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4798fd85-c9ff-4d14-b545-10fea11290fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdde816e70>]}
[0m18:41:58.777340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4798fd85-c9ff-4d14-b545-10fea11290fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fddeba5ca0>]}
[0m18:41:58.779837 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:41:58.941503 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m18:41:59.842887 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m18:41:59.844947 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/dim_vendors.sql
[0m18:41:59.846378 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/fct_trips.sql
[0m18:41:59.847778 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/dim_zones.sql
[0m18:41:59.849532 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/intermediate/fct_trips.sql
[0m18:41:59.851054 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models/marts/dim_zones.sql
[0m18:42:00.375964 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fct_trips").
  
  To fix this, change the name of one of these resources:
  - model.dbt_project.fct_trips (models/intermediate/fct_trips.sql)
  - model.dbt_project.fct_trips (models/marts/reporting/fct_trips.sql)
[0m18:42:00.379973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3479583, "process_in_blocks": "0", "process_kernel_time": 0.933436, "process_mem_max_rss": "141196", "process_out_blocks": "0", "process_user_time": 10.457328}
[0m18:42:00.381483 [debug] [MainThread]: Command `dbt run` failed at 18:42:00.381218 after 2.35 seconds
[0m18:42:00.382950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fddef15100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdd5974b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fdd582dbe0>]}
[0m18:42:00.384220 [debug] [MainThread]: Flushing usage events
[0m18:42:00.998430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:05.552902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715ceba0bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715ceb8137a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715ceb730ce0>]}


============================== 19:55:05.570345 | 6edd9faf-0980-451b-af4f-2e6bc5027cff ==============================
[0m19:55:05.570345 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:55:05.571689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'target_path': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'introspect': 'True', 'invocation_command': 'dbt run -s +fct_monthly_zone_revenue+', 'log_format': 'default', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'send_anonymous_usage_stats': 'True'}
[0m19:55:05.977537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6edd9faf-0980-451b-af4f-2e6bc5027cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715ceb1d84d0>]}
[0m19:55:06.050291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6edd9faf-0980-451b-af4f-2e6bc5027cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cebb48950>]}
[0m19:55:06.053184 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m19:55:06.177404 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m19:55:06.654008 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m19:55:06.655214 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/dim_zones.sql
[0m19:55:06.655916 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/fct_trips.sql
[0m19:55:06.656607 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/dim_vendors.sql
[0m19:55:06.657337 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/intermediate/fct_trips.sql
[0m19:55:06.658055 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models/marts/dim_zones.sql
[0m19:55:07.084649 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fct_trips").
  
  To fix this, change the name of one of these resources:
  - model.dbt_project.fct_trips (models/intermediate/fct_trips.sql)
  - model.dbt_project.fct_trips (models/marts/reporting/fct_trips.sql)
[0m19:55:07.089629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6562259, "process_in_blocks": "155016", "process_kernel_time": 0.611655, "process_mem_max_rss": "140308", "process_out_blocks": "0", "process_user_time": 3.191069}
[0m19:55:07.091115 [debug] [MainThread]: Command `dbt run` failed at 19:55:07.090843 after 1.66 seconds
[0m19:55:07.092195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cebbc4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715ce2360770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cef7efb60>]}
[0m19:55:07.093293 [debug] [MainThread]: Flushing usage events
[0m19:55:07.753446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:50.699810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cdc78ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cdb5f8ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cd9de4b60>]}


============================== 19:55:50.709772 | 97daad6d-abed-4725-bb49-4b70d6603eb0 ==============================
[0m19:55:50.709772 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:55:50.711950 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'debug': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'version_check': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s +fct_monthly_zone_revenue+', 'log_path': '/usr/app/logs', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'profiles_dir': '/root/.dbt', 'static_parser': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:55:51.043474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97daad6d-abed-4725-bb49-4b70d6603eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cda315c10>]}
[0m19:55:51.152179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97daad6d-abed-4725-bb49-4b70d6603eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cdc1bbf80>]}
[0m19:55:51.154118 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m19:55:51.292260 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m19:55:52.131523 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m19:55:52.133552 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/dim_vendors.sql
[0m19:55:52.134709 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/dim_zones.sql
[0m19:55:52.136011 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/marts/reporting/fct_trips.sql
[0m19:55:52.137603 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models/intermediate/fct_trips.sql
[0m19:55:52.138691 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models/marts/dim_zones.sql
[0m19:55:53.196518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97daad6d-abed-4725-bb49-4b70d6603eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cd011eab0>]}
[0m19:55:53.500272 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:55:53.519409 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:55:53.614722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97daad6d-abed-4725-bb49-4b70d6603eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cab576840>]}
[0m19:55:53.616338 [info ] [MainThread]: Found 8 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m19:55:53.617863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97daad6d-abed-4725-bb49-4b70d6603eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cab43ee40>]}
[0m19:55:53.624298 [info ] [MainThread]: 
[0m19:55:53.626362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:53.627568 [info ] [MainThread]: 
[0m19:55:53.629135 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:55:53.638841 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m19:55:53.748840 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m19:55:53.750118 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m19:55:53.751604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:53.910284 [debug] [ThreadPool]: SQL status: OK in 0.159 seconds
[0m19:55:53.913302 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m19:55:53.922392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m19:55:53.923794 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m19:55:53.933781 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:55:53.935023 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m19:55:53.936627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:54.029498 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m19:55:54.032724 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:55:54.033883 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m19:55:54.035677 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:55:54.036922 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:55:54.038342 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m19:55:54.040308 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:55:54.042243 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m19:55:54.043537 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:55:54.044947 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m19:55:54.046844 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:55:54.048220 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m19:55:54.058180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m19:55:54.066764 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m19:55:54.067927 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m19:55:54.069072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:54.162332 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m19:55:54.163812 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m19:55:54.165032 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m19:55:54.188411 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m19:55:54.191936 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m19:55:54.195578 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m19:55:54.196603 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m19:55:54.205262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97daad6d-abed-4725-bb49-4b70d6603eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cdc2a8b60>]}
[0m19:55:54.206810 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:54.207873 [debug] [MainThread]: On master: BEGIN
[0m19:55:54.208799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:55:54.296111 [debug] [MainThread]: SQL status: OK in 0.087 seconds
[0m19:55:54.297229 [debug] [MainThread]: On master: COMMIT
[0m19:55:54.298467 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:54.299815 [debug] [MainThread]: On master: COMMIT
[0m19:55:54.301769 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:55:54.302775 [debug] [MainThread]: On master: Close
[0m19:55:54.318269 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m19:55:54.319728 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.dim_zones ...................................... [RUN]
[0m19:55:54.321079 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m19:55:54.322144 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m19:55:54.340629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m19:55:54.368404 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m19:55:54.424150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m19:55:54.455717 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m19:55:54.456937 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m19:55:54.458068 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:55:54.548886 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m19:55:54.550426 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m19:55:54.551765 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m19:55:54.584980 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m19:55:54.586619 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:55:54.588085 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: ROLLBACK
[0m19:55:54.604694 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.dim_zones'
[0m19:55:54.605933 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m19:55:54.616737 [debug] [Thread-1 (]: Runtime Error in model dim_zones (models/marts/reporting/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^
[0m19:55:54.621110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97daad6d-abed-4725-bb49-4b70d6603eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cab574ef0>]}
[0m19:55:54.622766 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model dev.dim_zones ............................. [[31mERROR[0m in 0.30s]
[0m19:55:54.624507 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m19:55:54.626058 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m19:55:54.627149 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.dim_zones' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_zones (models/marts/reporting/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^.
[0m19:55:54.628268 [info ] [Thread-1 (]: 2 of 4 START sql view model dev.int_trips ...................................... [RUN]
[0m19:55:54.632317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.int_trips)
[0m19:55:54.633767 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m19:55:54.649589 [debug] [Thread-1 (]: Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:55:54.652566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97daad6d-abed-4725-bb49-4b70d6603eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cab4f6a20>]}
[0m19:55:54.654824 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model dev.int_trips ............................. [[31mERROR[0m in 0.02s]
[0m19:55:54.656617 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m19:55:54.658405 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.int_trips' to be skipped because of status 'error'.  Reason: Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:55:54.661785 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m19:55:54.665892 [info ] [Thread-1 (]: 3 of 4 SKIP relation dev.fct_trips ............................................. [[33mSKIP[0m]
[0m19:55:54.670458 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m19:55:54.673799 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m19:55:54.675616 [info ] [Thread-1 (]: 4 of 4 SKIP relation dev.fct_monthly_zone_revenue .............................. [[33mSKIP[0m]
[0m19:55:54.677880 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m19:55:54.683063 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:54.688135 [debug] [MainThread]: On master: BEGIN
[0m19:55:54.689942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:55:54.809793 [debug] [MainThread]: SQL status: OK in 0.120 seconds
[0m19:55:54.811542 [debug] [MainThread]: On master: COMMIT
[0m19:55:54.812947 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:54.814660 [debug] [MainThread]: On master: COMMIT
[0m19:55:54.820130 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:55:54.822248 [debug] [MainThread]: On master: Close
[0m19:55:54.836002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:54.837787 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m19:55:54.839178 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was properly closed.
[0m19:55:54.840678 [info ] [MainThread]: 
[0m19:55:54.842142 [info ] [MainThread]: Finished running 1 incremental model, 3 view models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m19:55:54.845652 [debug] [MainThread]: Command end result
[0m19:55:55.022436 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:55:55.038450 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:55:55.068702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m19:55:55.070226 [info ] [MainThread]: 
[0m19:55:55.072282 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:55:55.074607 [info ] [MainThread]: 
[0m19:55:55.076795 [error] [MainThread]: [31mFailure in model dim_zones (models/marts/reporting/dim_zones.sql)[0m
[0m19:55:55.078512 [error] [MainThread]:   Runtime Error in model dim_zones (models/marts/reporting/dim_zones.sql)
  Catalog Error: Table with name taxi_zone_lookup does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 14: from "taxi_rides_ny"."dev"."taxi_zone_lookup"
                ^
[0m19:55:55.080249 [info ] [MainThread]: 
[0m19:55:55.086011 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/reporting/dim_zones.sql
[0m19:55:55.088225 [info ] [MainThread]: 
[0m19:55:55.090274 [error] [MainThread]: [31mFailure in model int_trips (models/intermediate/int_trips.sql)[0m
[0m19:55:55.092499 [error] [MainThread]:   Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:55:55.094222 [info ] [MainThread]: 
[0m19:55:55.096462 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m19:55:55.102582 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.549278, "process_in_blocks": "16672", "process_kernel_time": 0.544973, "process_mem_max_rss": "160468", "process_out_blocks": "0", "process_user_time": 5.110638}
[0m19:55:55.105029 [debug] [MainThread]: Command `dbt run` failed at 19:55:55.104603 after 4.55 seconds
[0m19:55:55.107034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cda0b3cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cd08c99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0cd0172c30>]}
[0m19:55:55.109298 [debug] [MainThread]: Flushing usage events
[0m19:55:55.725013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:29.029529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ec07ab2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ec08f2e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ec07ab2d50>]}


============================== 19:57:29.036248 | 6806c329-8d28-46f5-bd53-17a513fbbab0 ==============================
[0m19:57:29.036248 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:57:29.037219 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'empty': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'printer_width': '80', 'warn_error': 'None'}
[0m19:57:29.283627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6806c329-8d28-46f5-bd53-17a513fbbab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ec076f7c20>]}
[0m19:57:29.356609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6806c329-8d28-46f5-bd53-17a513fbbab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ebff72f890>]}
[0m19:57:29.358017 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m19:57:29.494675 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m19:57:29.911002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:57:29.911701 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:57:29.912215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:57:29.972637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6806c329-8d28-46f5-bd53-17a513fbbab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ec0731e780>]}
[0m19:57:30.122067 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:57:30.132451 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:57:30.182153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6806c329-8d28-46f5-bd53-17a513fbbab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ec09276b70>]}
[0m19:57:30.183220 [info ] [MainThread]: Found 8 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m19:57:30.184104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6806c329-8d28-46f5-bd53-17a513fbbab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ebfe33b470>]}
[0m19:57:30.187974 [info ] [MainThread]: 
[0m19:57:30.188896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:30.189943 [info ] [MainThread]: 
[0m19:57:30.191636 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:57:30.203352 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m19:57:30.256863 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m19:57:30.258161 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m19:57:30.259119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:30.330349 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m19:57:30.332781 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m19:57:30.338164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m19:57:30.339015 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m19:57:30.347612 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:57:30.348426 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m19:57:30.349274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:30.397955 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m19:57:30.400698 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:57:30.401472 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m19:57:30.402552 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:57:30.403129 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:57:30.403642 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m19:57:30.404635 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:57:30.405876 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m19:57:30.406478 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:57:30.407127 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m19:57:30.408441 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:57:30.409129 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m19:57:30.415495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m19:57:30.421472 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m19:57:30.422328 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m19:57:30.422967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:30.473550 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m19:57:30.474509 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m19:57:30.475297 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m19:57:30.486946 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m19:57:30.489005 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m19:57:30.490714 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m19:57:30.491643 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m19:57:30.498119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6806c329-8d28-46f5-bd53-17a513fbbab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ebff72d730>]}
[0m19:57:30.499247 [debug] [MainThread]: Using duckdb connection "master"
[0m19:57:30.500094 [debug] [MainThread]: On master: BEGIN
[0m19:57:30.500853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:30.556419 [debug] [MainThread]: SQL status: OK in 0.055 seconds
[0m19:57:30.557229 [debug] [MainThread]: On master: COMMIT
[0m19:57:30.557823 [debug] [MainThread]: Using duckdb connection "master"
[0m19:57:30.558403 [debug] [MainThread]: On master: COMMIT
[0m19:57:30.559345 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:57:30.559961 [debug] [MainThread]: On master: Close
[0m19:57:30.569419 [debug] [Thread-1 (]: Began running node seed.dbt_project.payment_type_lookup
[0m19:57:30.570545 [info ] [Thread-1 (]: 1 of 2 START seed file dev.payment_type_lookup ................................. [RUN]
[0m19:57:30.571588 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.dbt_project.payment_type_lookup'
[0m19:57:30.572371 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.payment_type_lookup
[0m19:57:30.573458 [debug] [Thread-1 (]: Began executing node seed.dbt_project.payment_type_lookup
[0m19:57:30.622729 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m19:57:30.623887 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: BEGIN
[0m19:57:30.625011 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:57:30.689204 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m19:57:30.690534 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m19:57:30.691647 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "seed.dbt_project.payment_type_lookup"} */

    create table "taxi_rides_ny"."dev"."payment_type_lookup" ("payment_type" integer,"description" text)
  
[0m19:57:30.694635 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:57:30.706344 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m19:57:30.707527 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: 
          COPY "taxi_rides_ny"."dev"."payment_type_lookup" FROM '/usr/app/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:57:30.728878 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m19:57:30.735596 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.payment_type_lookup"
[0m19:57:30.782389 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: COMMIT
[0m19:57:30.783470 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m19:57:30.784449 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: COMMIT
[0m19:57:30.798219 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m19:57:30.800727 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: Close
[0m19:57:39.695147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6806c329-8d28-46f5-bd53-17a513fbbab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ec0732b1a0>]}
[0m19:57:39.697337 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dev.payment_type_lookup ............................. [[32mINSERT 7[0m in 9.12s]
[0m19:57:39.699226 [debug] [Thread-1 (]: Finished running node seed.dbt_project.payment_type_lookup
[0m19:57:39.700324 [debug] [Thread-1 (]: Began running node seed.dbt_project.taxi_zone_lookup
[0m19:57:39.701742 [info ] [Thread-1 (]: 2 of 2 START seed file dev.taxi_zone_lookup .................................... [RUN]
[0m19:57:39.704009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_project.payment_type_lookup, now seed.dbt_project.taxi_zone_lookup)
[0m19:57:39.705381 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.taxi_zone_lookup
[0m19:57:39.706721 [debug] [Thread-1 (]: Began executing node seed.dbt_project.taxi_zone_lookup
[0m19:57:39.737917 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m19:57:39.739449 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: BEGIN
[0m19:57:39.740631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:39.807591 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m19:57:39.808956 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m19:57:39.809939 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "seed.dbt_project.taxi_zone_lookup"} */

    create table "taxi_rides_ny"."dev"."taxi_zone_lookup" ("locationid" integer,"borough" text,"zone" text,"service_zone" text)
  
[0m19:57:39.811490 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:57:39.813333 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m19:57:39.814198 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: 
          COPY "taxi_rides_ny"."dev"."taxi_zone_lookup" FROM '/usr/app/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:57:39.829807 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m19:57:39.831766 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.taxi_zone_lookup"
[0m19:57:39.850753 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: COMMIT
[0m19:57:39.852399 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m19:57:39.853769 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: COMMIT
[0m19:57:39.867443 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m19:57:39.869759 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: Close
[0m19:57:55.222474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6806c329-8d28-46f5-bd53-17a513fbbab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ebfd777980>]}
[0m19:57:55.224600 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file dev.taxi_zone_lookup ................................ [[32mINSERT 265[0m in 15.52s]
[0m19:57:55.227234 [debug] [Thread-1 (]: Finished running node seed.dbt_project.taxi_zone_lookup
[0m19:57:55.231253 [debug] [MainThread]: Using duckdb connection "master"
[0m19:57:55.232921 [debug] [MainThread]: On master: BEGIN
[0m19:57:55.234411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:57:55.328389 [debug] [MainThread]: SQL status: OK in 0.094 seconds
[0m19:57:55.329646 [debug] [MainThread]: On master: COMMIT
[0m19:57:55.330588 [debug] [MainThread]: Using duckdb connection "master"
[0m19:57:55.332053 [debug] [MainThread]: On master: COMMIT
[0m19:57:55.334393 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:57:55.335429 [debug] [MainThread]: On master: Close
[0m19:57:55.342452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:55.343580 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m19:57:55.344508 [debug] [MainThread]: Connection 'seed.dbt_project.taxi_zone_lookup' was properly closed.
[0m19:57:55.345513 [info ] [MainThread]: 
[0m19:57:55.346884 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 25.15 seconds (25.15s).
[0m19:57:55.350941 [debug] [MainThread]: Command end result
[0m19:57:55.479680 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:57:55.498487 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:57:55.527777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m19:57:55.529288 [info ] [MainThread]: 
[0m19:57:55.530960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:57:55.534425 [info ] [MainThread]: 
[0m19:57:55.536132 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m19:57:55.538935 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 26.626856, "process_in_blocks": "2448", "process_kernel_time": 13.821151, "process_mem_max_rss": "930392", "process_out_blocks": "0", "process_user_time": 75.35559}
[0m19:57:55.540454 [debug] [MainThread]: Command `dbt seed` succeeded at 19:57:55.540146 after 26.63 seconds
[0m19:57:55.541936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ec076f7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ec08358fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ec08359310>]}
[0m19:57:55.543086 [debug] [MainThread]: Flushing usage events
[0m19:57:56.241309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:58:03.707693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da6928df1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da691e381d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da6928dec60>]}


============================== 19:58:03.719013 | 49eb46ce-241f-4e3a-bcce-7c5d5b9a13c3 ==============================
[0m19:58:03.719013 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:58:03.720524 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/app/logs', 'partial_parse': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt run -s +fct_monthly_zone_revenue+', 'static_parser': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80'}
[0m19:58:04.088303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49eb46ce-241f-4e3a-bcce-7c5d5b9a13c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da691da2360>]}
[0m19:58:04.194072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49eb46ce-241f-4e3a-bcce-7c5d5b9a13c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da68df096d0>]}
[0m19:58:04.195971 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m19:58:04.330609 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m19:58:05.268811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:58:05.270310 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:58:05.271864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:58:05.370299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49eb46ce-241f-4e3a-bcce-7c5d5b9a13c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da68df54080>]}
[0m19:58:05.616939 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:58:05.631809 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:58:05.689601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49eb46ce-241f-4e3a-bcce-7c5d5b9a13c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da688a563f0>]}
[0m19:58:05.690874 [info ] [MainThread]: Found 8 models, 2 seeds, 31 data tests, 2 sources, 458 macros
[0m19:58:05.691969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49eb46ce-241f-4e3a-bcce-7c5d5b9a13c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da688a43290>]}
[0m19:58:05.696105 [info ] [MainThread]: 
[0m19:58:05.697157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:58:05.698044 [info ] [MainThread]: 
[0m19:58:05.699495 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:58:05.709572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m19:58:05.769721 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m19:58:05.771451 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m19:58:05.772478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:05.871380 [debug] [ThreadPool]: SQL status: OK in 0.099 seconds
[0m19:58:05.874214 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m19:58:05.882993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m19:58:05.884602 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m19:58:05.895100 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:58:05.896453 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m19:58:05.897423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:58:05.984930 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m19:58:05.988891 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:58:05.990069 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m19:58:05.992069 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:58:05.993209 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:58:05.994315 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m19:58:05.995796 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:58:05.997845 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m19:58:05.998990 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m19:58:06.000276 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m19:58:06.002428 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:58:06.003746 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m19:58:06.018850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m19:58:06.027624 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m19:58:06.029191 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m19:58:06.030169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:58:06.108793 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m19:58:06.110141 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m19:58:06.111266 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m19:58:06.129322 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m19:58:06.132318 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m19:58:06.134695 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m19:58:06.135811 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m19:58:06.143785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49eb46ce-241f-4e3a-bcce-7c5d5b9a13c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da6946174a0>]}
[0m19:58:06.145188 [debug] [MainThread]: Using duckdb connection "master"
[0m19:58:06.146160 [debug] [MainThread]: On master: BEGIN
[0m19:58:06.147112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:58:06.229728 [debug] [MainThread]: SQL status: OK in 0.083 seconds
[0m19:58:06.231357 [debug] [MainThread]: On master: COMMIT
[0m19:58:06.232673 [debug] [MainThread]: Using duckdb connection "master"
[0m19:58:06.233810 [debug] [MainThread]: On master: COMMIT
[0m19:58:06.235366 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:58:06.236509 [debug] [MainThread]: On master: Close
[0m19:58:06.248419 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m19:58:06.250014 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.dim_zones ...................................... [RUN]
[0m19:58:06.253307 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m19:58:06.255765 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m19:58:06.272988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m19:58:06.298652 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m19:58:06.354399 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m19:58:06.386626 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m19:58:06.387985 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m19:58:06.389252 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:58:06.465938 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m19:58:06.467417 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m19:58:06.468679 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m19:58:06.470869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:58:06.481472 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m19:58:06.483051 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m19:58:06.485152 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:58:06.511257 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m19:58:06.512976 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m19:58:06.514359 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m19:58:06.530751 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m19:58:06.542134 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m19:58:06.543658 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."dev"."dim_zones__dbt_backup" cascade
[0m19:58:06.545959 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:58:06.550132 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m19:58:19.195897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49eb46ce-241f-4e3a-bcce-7c5d5b9a13c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da66bdc7770>]}
[0m19:58:19.199051 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dev.dim_zones ................................. [[32mOK[0m in 12.94s]
[0m19:58:19.202410 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m19:58:19.204894 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m19:58:19.207562 [info ] [Thread-1 (]: 2 of 4 START sql view model dev.int_trips ...................................... [RUN]
[0m19:58:19.209725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.int_trips)
[0m19:58:19.211400 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m19:58:19.241705 [debug] [Thread-1 (]: Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:58:19.243908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49eb46ce-241f-4e3a-bcce-7c5d5b9a13c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da66beb6420>]}
[0m19:58:19.245973 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model dev.int_trips ............................. [[31mERROR[0m in 0.03s]
[0m19:58:19.247984 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m19:58:19.251006 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.int_trips' to be skipped because of status 'error'.  Reason: Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:58:19.259895 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m19:58:19.261823 [info ] [Thread-1 (]: 3 of 4 SKIP relation dev.fct_trips ............................................. [[33mSKIP[0m]
[0m19:58:19.263776 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m19:58:19.266941 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m19:58:19.268665 [info ] [Thread-1 (]: 4 of 4 SKIP relation dev.fct_monthly_zone_revenue .............................. [[33mSKIP[0m]
[0m19:58:19.271941 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m19:58:19.278283 [debug] [MainThread]: Using duckdb connection "master"
[0m19:58:19.279760 [debug] [MainThread]: On master: BEGIN
[0m19:58:19.280764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:58:19.407853 [debug] [MainThread]: SQL status: OK in 0.127 seconds
[0m19:58:19.409795 [debug] [MainThread]: On master: COMMIT
[0m19:58:19.411445 [debug] [MainThread]: Using duckdb connection "master"
[0m19:58:19.414322 [debug] [MainThread]: On master: COMMIT
[0m19:58:19.417334 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:58:19.420196 [debug] [MainThread]: On master: Close
[0m19:58:19.430507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:19.432590 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m19:58:19.439737 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was properly closed.
[0m19:58:19.442687 [info ] [MainThread]: 
[0m19:58:19.445106 [info ] [MainThread]: Finished running 1 incremental model, 3 view models in 0 hours 0 minutes and 13.74 seconds (13.74s).
[0m19:58:19.448882 [debug] [MainThread]: Command end result
[0m19:58:19.638049 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m19:58:19.663938 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m19:58:19.701502 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m19:58:19.704969 [info ] [MainThread]: 
[0m19:58:19.707060 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:58:19.709428 [info ] [MainThread]: 
[0m19:58:19.712403 [error] [MainThread]: [31mFailure in model int_trips (models/intermediate/int_trips.sql)[0m
[0m19:58:19.716369 [error] [MainThread]:   Compilation Error in model int_trips (models/intermediate/int_trips.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:58:19.721618 [info ] [MainThread]: 
[0m19:58:19.724162 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m19:58:19.729490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.174309, "process_in_blocks": "0", "process_kernel_time": 8.31023, "process_mem_max_rss": "798328", "process_out_blocks": "0", "process_user_time": 41.95999}
[0m19:58:19.732049 [debug] [MainThread]: Command `dbt run` failed at 19:58:19.731552 after 16.18 seconds
[0m19:58:19.733896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da692986540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da692986a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da692986600>]}
[0m19:58:19.740139 [debug] [MainThread]: Flushing usage events
[0m19:58:20.459539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:47.047347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d001214da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d00147ecf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0012336330>]}


============================== 20:04:47.060608 | 749f3599-ef68-41cb-bebe-10fbb0c36301 ==============================
[0m20:04:47.060608 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:04:47.062016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': '/root/.dbt', 'target_path': 'None', 'quiet': 'False', 'empty': 'None', 'debug': 'False', 'no_print': 'None', 'log_path': '/usr/app/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'introspect': 'True'}
[0m20:04:47.282031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '749f3599-ef68-41cb-bebe-10fbb0c36301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d001235eed0>]}
[0m20:04:47.323703 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:04:47.330713 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:04:47.333783 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44586703, "process_in_blocks": "184", "process_kernel_time": 0.41817, "process_mem_max_rss": "104376", "process_out_blocks": "0", "process_user_time": 3.482076}
[0m20:04:47.335472 [debug] [MainThread]: Command `dbt deps` succeeded at 20:04:47.335160 after 0.45 seconds
[0m20:04:47.336704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d001214da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0011e3b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0011dcdc40>]}
[0m20:04:47.337774 [debug] [MainThread]: Flushing usage events
[0m20:04:48.328043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:06:44.524331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88d3edb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88d6e8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88dd28ad0>]}


============================== 20:06:44.535685 | 6fe85e52-997f-482b-8a0a-c50de3367026 ==============================
[0m20:06:44.535685 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:06:44.536970 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True'}
[0m20:06:44.773303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fe85e52-997f-482b-8a0a-c50de3367026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88d6e8800>]}
[0m20:06:44.810258 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e8w6qif1'
[0m20:06:44.812277 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:06:45.109786 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:06:45.112768 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:06:45.194617 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:06:45.210005 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m20:06:45.305058 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m20:06:45.335352 [info ] [MainThread]: Updating lock file in file path: /usr/app/package-lock.yml
[0m20:06:45.360006 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b_0suvmv'
[0m20:06:45.369921 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:06:59.265054 [info ] [MainThread]: Installed from version 1.3.3
[0m20:06:59.266607 [info ] [MainThread]: Up to date!
[0m20:06:59.268403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6fe85e52-997f-482b-8a0a-c50de3367026', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88d9c2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88c8d4320>]}
[0m20:06:59.269624 [info ] [MainThread]: Installing dbt-labs/codegen
[0m20:07:03.896977 [info ] [MainThread]: Installed from version 0.14.0
[0m20:07:03.898466 [info ] [MainThread]: Up to date!
[0m20:07:03.900128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6fe85e52-997f-482b-8a0a-c50de3367026', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88c923fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88f4e7530>]}
[0m20:07:03.903998 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 19.571291, "process_in_blocks": "312", "process_kernel_time": 1.367124, "process_mem_max_rss": "106724", "process_out_blocks": "248", "process_user_time": 3.722288}
[0m20:07:03.905471 [debug] [MainThread]: Command `dbt deps` succeeded at 20:07:03.905189 after 19.57 seconds
[0m20:07:03.906568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88cea0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88cfe54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c88c88b6e0>]}
[0m20:07:03.907764 [debug] [MainThread]: Flushing usage events
[0m20:07:04.801202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:12.683213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717830348e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7178304412b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71782fb8a840>]}


============================== 20:07:12.695630 | 87912d55-800c-4b0e-9b4b-d9643ee525ad ==============================
[0m20:07:12.695630 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:07:12.697142 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'False', 'version_check': 'True', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -s +fct_monthly_zone_revenue+', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80'}
[0m20:07:13.133360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87912d55-800c-4b0e-9b4b-d9643ee525ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71782f4d69c0>]}
[0m20:07:13.298057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87912d55-800c-4b0e-9b4b-d9643ee525ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71782792c740>]}
[0m20:07:13.299998 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:07:13.597725 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:07:13.912311 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m20:07:13.913792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '87912d55-800c-4b0e-9b4b-d9643ee525ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7178267da3c0>]}
[0m20:07:21.255204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87912d55-800c-4b0e-9b4b-d9643ee525ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7178254b5250>]}
[0m20:07:21.572251 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:07:21.589467 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:07:21.659412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87912d55-800c-4b0e-9b4b-d9643ee525ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717825340410>]}
[0m20:07:21.661127 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:07:21.662403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87912d55-800c-4b0e-9b4b-d9643ee525ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717825321d60>]}
[0m20:07:21.668876 [info ] [MainThread]: 
[0m20:07:21.672673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:21.674255 [info ] [MainThread]: 
[0m20:07:21.676223 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:07:21.690446 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:07:21.863368 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:07:21.864960 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:07:21.866334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:21.955128 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m20:07:21.958187 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:07:21.966250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m20:07:21.968270 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m20:07:21.984250 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:07:21.985928 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:07:21.987159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:22.090217 [debug] [ThreadPool]: SQL status: OK in 0.103 seconds
[0m20:07:22.093946 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:07:22.095375 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m20:07:22.097514 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:22.098832 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:07:22.100243 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m20:07:22.102395 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:22.104833 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:07:22.106374 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:07:22.107785 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:07:22.110055 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:22.111440 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m20:07:22.123300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m20:07:22.136529 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:07:22.138267 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m20:07:22.139756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:22.232199 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m20:07:22.233468 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:07:22.234588 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:07:22.261436 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m20:07:22.265037 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m20:07:22.267530 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m20:07:22.269973 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m20:07:22.282440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87912d55-800c-4b0e-9b4b-d9643ee525ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71782f4f3920>]}
[0m20:07:22.283854 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:22.284966 [debug] [MainThread]: On master: BEGIN
[0m20:07:22.286049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:22.380288 [debug] [MainThread]: SQL status: OK in 0.094 seconds
[0m20:07:22.381805 [debug] [MainThread]: On master: COMMIT
[0m20:07:22.382834 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:22.383845 [debug] [MainThread]: On master: COMMIT
[0m20:07:22.387249 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:07:22.388461 [debug] [MainThread]: On master: Close
[0m20:07:22.404093 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m20:07:22.405575 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.dim_zones ...................................... [RUN]
[0m20:07:22.407238 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m20:07:22.408536 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m20:07:22.425916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m20:07:22.450196 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m20:07:22.517431 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m20:07:22.544084 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:07:22.545899 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m20:07:22.547397 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:07:22.645033 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m20:07:22.646662 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:07:22.648112 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m20:07:22.650345 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:22.663236 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:07:22.665208 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones" rename to "dim_zones__dbt_backup"
[0m20:07:22.668293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:22.676411 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:07:22.678157 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m20:07:22.680342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:22.717953 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:07:22.719781 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:07:22.721062 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:07:22.737699 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:07:22.747463 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:07:22.748615 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."dev"."dim_zones__dbt_backup" cascade
[0m20:07:22.754112 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:07:22.759387 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m20:07:33.132860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87912d55-800c-4b0e-9b4b-d9643ee525ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7178321044a0>]}
[0m20:07:33.136041 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dev.dim_zones ................................. [[32mOK[0m in 10.72s]
[0m20:07:33.138319 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m20:07:33.140079 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m20:07:33.141940 [info ] [Thread-1 (]: 2 of 4 START sql view model dev.int_trips ...................................... [RUN]
[0m20:07:33.144886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.int_trips)
[0m20:07:33.146524 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m20:07:33.158337 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m20:07:33.196818 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m20:07:33.207896 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m20:07:33.245571 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:07:33.246904 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m20:07:33.248214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:33.338440 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m20:07:33.340228 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:07:33.345561 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:07:33.371587 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:07:33.374058 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:07:33.376850 [debug] [Thread-1 (]: On model.dbt_project.int_trips: ROLLBACK
[0m20:07:33.386244 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_trips'
[0m20:07:33.388308 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m20:07:33.403360 [debug] [Thread-1 (]: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Catalog Error: Table with name int_trips_unioned does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 10:     select * from "taxi_rides_ny"."dev"."int_trips_unioned"
                             ^
[0m20:07:33.405250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87912d55-800c-4b0e-9b4b-d9643ee525ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717824f07e60>]}
[0m20:07:33.407277 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model dev.int_trips ............................. [[31mERROR[0m in 0.26s]
[0m20:07:33.413098 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m20:07:33.415703 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.int_trips' to be skipped because of status 'error'.  Reason: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Catalog Error: Table with name int_trips_unioned does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 10:     select * from "taxi_rides_ny"."dev"."int_trips_unioned"
                             ^.
[0m20:07:33.419180 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m20:07:33.421381 [info ] [Thread-1 (]: 3 of 4 SKIP relation dev.fct_trips ............................................. [[33mSKIP[0m]
[0m20:07:33.423043 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m20:07:33.426462 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m20:07:33.430381 [info ] [Thread-1 (]: 4 of 4 SKIP relation dev.fct_monthly_zone_revenue .............................. [[33mSKIP[0m]
[0m20:07:33.433132 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m20:07:33.439016 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:33.441475 [debug] [MainThread]: On master: BEGIN
[0m20:07:33.445052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:33.524499 [debug] [MainThread]: SQL status: OK in 0.079 seconds
[0m20:07:33.526108 [debug] [MainThread]: On master: COMMIT
[0m20:07:33.527671 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:33.529571 [debug] [MainThread]: On master: COMMIT
[0m20:07:33.532278 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:07:33.534726 [debug] [MainThread]: On master: Close
[0m20:07:33.546639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:33.548737 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m20:07:33.550471 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was properly closed.
[0m20:07:33.552194 [info ] [MainThread]: 
[0m20:07:33.554148 [info ] [MainThread]: Finished running 1 incremental model, 3 view models in 0 hours 0 minutes and 11.88 seconds (11.88s).
[0m20:07:33.558349 [debug] [MainThread]: Command end result
[0m20:07:33.750621 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:07:33.768949 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:07:33.798260 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:07:33.799834 [info ] [MainThread]: 
[0m20:07:33.802069 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:07:33.804633 [info ] [MainThread]: 
[0m20:07:33.806660 [error] [MainThread]: [31mFailure in model int_trips (models/intermediate/int_trips.sql)[0m
[0m20:07:33.812615 [error] [MainThread]:   Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Catalog Error: Table with name int_trips_unioned does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 10:     select * from "taxi_rides_ny"."dev"."int_trips_unioned"
                             ^
[0m20:07:33.814492 [info ] [MainThread]: 
[0m20:07:33.816905 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/int_trips.sql
[0m20:07:33.818496 [info ] [MainThread]: 
[0m20:07:33.820298 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m20:07:33.823583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 21.315685, "process_in_blocks": "336", "process_kernel_time": 7.426731, "process_mem_max_rss": "811520", "process_out_blocks": "0", "process_user_time": 41.62714}
[0m20:07:33.825495 [debug] [MainThread]: Command `dbt run` failed at 20:07:33.825104 after 21.32 seconds
[0m20:07:33.828732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71782fef14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7178253435f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71782fc77830>]}
[0m20:07:33.830048 [debug] [MainThread]: Flushing usage events
[0m20:07:34.510833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:44.005545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e13c204f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e13e844e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e13d65a0f0>]}


============================== 20:08:44.021447 | c97c8893-9ec2-44de-9826-05121f40405b ==============================
[0m20:08:44.021447 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:08:44.023178 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'target_path': 'None', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False'}
[0m20:08:44.544889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c97c8893-9ec2-44de-9826-05121f40405b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e137ee4cb0>]}
[0m20:08:44.709254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c97c8893-9ec2-44de-9826-05121f40405b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e13ba66300>]}
[0m20:08:44.712199 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:08:45.046309 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:08:48.031529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:08:48.035733 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:08:48.037616 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:08:48.218330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c97c8893-9ec2-44de-9826-05121f40405b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e133d1b6e0>]}
[0m20:08:48.573337 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:08:48.589815 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:08:48.668087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c97c8893-9ec2-44de-9826-05121f40405b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e132cc10a0>]}
[0m20:08:48.669824 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:08:48.671280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c97c8893-9ec2-44de-9826-05121f40405b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e133da15e0>]}
[0m20:08:48.677342 [info ] [MainThread]: 
[0m20:08:48.679281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:08:48.682542 [info ] [MainThread]: 
[0m20:08:48.684740 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:08:48.697435 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:08:48.781087 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:08:48.782937 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:08:48.785116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:48.867584 [debug] [ThreadPool]: SQL status: OK in 0.082 seconds
[0m20:08:48.871052 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:08:48.881122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m20:08:48.883882 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m20:08:48.906474 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:08:48.907872 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:08:48.909916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:49.001838 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m20:08:49.005435 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:08:49.006745 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m20:08:49.008823 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:08:49.010099 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:08:49.011205 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m20:08:49.013011 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:08:49.015793 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:08:49.017195 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:08:49.018404 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:08:49.021313 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:08:49.022382 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m20:08:49.036102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m20:08:49.056868 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:08:49.058580 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m20:08:49.060195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:49.137488 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m20:08:49.138969 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:08:49.140422 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:08:49.175796 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m20:08:49.181247 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m20:08:49.186751 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m20:08:49.189861 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m20:08:49.202367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c97c8893-9ec2-44de-9826-05121f40405b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e1320f0ec0>]}
[0m20:08:49.204218 [debug] [MainThread]: Using duckdb connection "master"
[0m20:08:49.205256 [debug] [MainThread]: On master: BEGIN
[0m20:08:49.206368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:08:49.294194 [debug] [MainThread]: SQL status: OK in 0.088 seconds
[0m20:08:49.295592 [debug] [MainThread]: On master: COMMIT
[0m20:08:49.297114 [debug] [MainThread]: Using duckdb connection "master"
[0m20:08:49.298247 [debug] [MainThread]: On master: COMMIT
[0m20:08:49.301080 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:08:49.302414 [debug] [MainThread]: On master: Close
[0m20:08:49.319680 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m20:08:49.321644 [info ] [Thread-1 (]: 1 of 7 START sql view model dev.dim_zones ...................................... [RUN]
[0m20:08:49.323972 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m20:08:49.325511 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m20:08:49.347690 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m20:08:49.377945 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m20:08:49.460612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m20:08:49.496588 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:08:49.498368 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m20:08:49.501285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:08:49.594873 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m20:08:49.597505 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:08:49.601819 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m20:08:49.604765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:08:49.622446 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:08:49.624285 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones" rename to "dim_zones__dbt_backup"
[0m20:08:49.627030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:08:49.635402 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:08:49.637429 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m20:08:49.640130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:08:49.680301 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:08:49.682363 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:08:49.683733 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:08:49.699213 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:08:49.710801 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:08:49.712353 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."dev"."dim_zones__dbt_backup" cascade
[0m20:08:49.719564 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:08:49.725540 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m20:08:59.522150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c97c8893-9ec2-44de-9826-05121f40405b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e131e34950>]}
[0m20:08:59.524949 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dev.dim_zones ................................. [[32mOK[0m in 10.19s]
[0m20:08:59.527185 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m20:08:59.528652 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m20:08:59.531075 [info ] [Thread-1 (]: 2 of 7 START sql view model dev.int_trips ...................................... [RUN]
[0m20:08:59.533382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.int_trips)
[0m20:08:59.534895 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m20:08:59.573978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m20:08:59.600180 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m20:08:59.612290 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m20:08:59.638167 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:08:59.639484 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m20:08:59.640688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:59.718554 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m20:08:59.720752 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:08:59.722415 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:08:59.745074 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:08:59.747316 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:08:59.749331 [debug] [Thread-1 (]: On model.dbt_project.int_trips: ROLLBACK
[0m20:08:59.763778 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_trips'
[0m20:08:59.766276 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m20:08:59.778526 [debug] [Thread-1 (]: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Catalog Error: Table with name int_trips_unioned does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 10:     select * from "taxi_rides_ny"."dev"."int_trips_unioned"
                             ^
[0m20:08:59.780998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c97c8893-9ec2-44de-9826-05121f40405b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e131ef61b0>]}
[0m20:08:59.799553 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model dev.int_trips ............................. [[31mERROR[0m in 0.25s]
[0m20:08:59.807608 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m20:08:59.811029 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m20:08:59.812432 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.int_trips' to be skipped because of status 'error'.  Reason: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Catalog Error: Table with name int_trips_unioned does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 10:     select * from "taxi_rides_ny"."dev"."int_trips_unioned"
                             ^.
[0m20:08:59.820440 [info ] [Thread-1 (]: 3 of 7 START sql view model dev.stg_green_tripdata ............................. [RUN]
[0m20:08:59.825432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now model.dbt_project.stg_green_tripdata)
[0m20:08:59.826666 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m20:08:59.841190 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m20:08:59.870626 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m20:08:59.877609 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m20:08:59.899716 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:08:59.902043 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m20:08:59.903606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:59.988873 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m20:08:59.990286 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:08:59.992175 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:08:59.996605 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:09:00.004504 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:09:00.006096 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m20:09:00.008529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:09:00.019012 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:09:00.021303 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m20:09:00.024536 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:09:00.028196 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:09:00.030367 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:09:00.032301 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:09:00.051936 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m20:09:00.057574 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:09:00.058986 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_backup" cascade
[0m20:09:00.067228 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:09:00.072029 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m20:09:08.994753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c97c8893-9ec2-44de-9826-05121f40405b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e131ef3c20>]}
[0m20:09:08.997054 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dev.stg_green_tripdata ........................ [[32mOK[0m in 9.17s]
[0m20:09:08.999175 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m20:09:09.000632 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m20:09:09.002091 [info ] [Thread-1 (]: 4 of 7 START sql view model dev.stg_yellow_tripdata ............................ [RUN]
[0m20:09:09.003667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m20:09:09.004899 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m20:09:09.016624 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m20:09:09.048355 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m20:09:09.057943 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m20:09:09.083319 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:09:09.085030 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m20:09:09.086392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:09.179856 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m20:09:09.181538 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:09:09.183601 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:09:09.188497 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:09:09.315541 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:09:09.318321 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m20:09:09.321018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:09:09.331178 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:09:09.332564 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m20:09:09.334939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:09:09.338143 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:09:09.339584 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:09:09.341267 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:09:09.360821 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:09:09.367274 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:09:09.368803 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_backup" cascade
[0m20:09:09.376530 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:09:09.379781 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m20:09:18.905619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c97c8893-9ec2-44de-9826-05121f40405b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e1329a7fb0>]}
[0m20:09:18.907985 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dev.stg_yellow_tripdata ....................... [[32mOK[0m in 9.90s]
[0m20:09:18.910269 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m20:09:18.912063 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m20:09:18.913416 [info ] [Thread-1 (]: 5 of 7 SKIP relation dev.fct_trips ............................................. [[33mSKIP[0m]
[0m20:09:18.915031 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m20:09:18.918640 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m20:09:18.920146 [info ] [Thread-1 (]: 6 of 7 SKIP relation dev.dim_vendors ........................................... [[33mSKIP[0m]
[0m20:09:18.921869 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m20:09:18.923593 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m20:09:18.925423 [info ] [Thread-1 (]: 7 of 7 SKIP relation dev.fct_monthly_zone_revenue .............................. [[33mSKIP[0m]
[0m20:09:18.928653 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m20:09:18.934662 [debug] [MainThread]: Using duckdb connection "master"
[0m20:09:18.935755 [debug] [MainThread]: On master: BEGIN
[0m20:09:18.937167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:19.039747 [debug] [MainThread]: SQL status: OK in 0.103 seconds
[0m20:09:19.041656 [debug] [MainThread]: On master: COMMIT
[0m20:09:19.043172 [debug] [MainThread]: Using duckdb connection "master"
[0m20:09:19.044334 [debug] [MainThread]: On master: COMMIT
[0m20:09:19.046301 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:09:19.047496 [debug] [MainThread]: On master: Close
[0m20:09:19.056314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:19.058513 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m20:09:19.059568 [debug] [MainThread]: Connection 'model.dbt_project.stg_yellow_tripdata' was properly closed.
[0m20:09:19.060889 [info ] [MainThread]: 
[0m20:09:19.062211 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 30.38 seconds (30.38s).
[0m20:09:19.066020 [debug] [MainThread]: Command end result
[0m20:09:19.270213 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:09:19.287344 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:09:19.313440 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:09:19.314893 [info ] [MainThread]: 
[0m20:09:19.316851 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:09:19.318695 [info ] [MainThread]: 
[0m20:09:19.320607 [error] [MainThread]: [31mFailure in model int_trips (models/intermediate/int_trips.sql)[0m
[0m20:09:19.322710 [error] [MainThread]:   Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Catalog Error: Table with name int_trips_unioned does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 10:     select * from "taxi_rides_ny"."dev"."int_trips_unioned"
                             ^
[0m20:09:19.326815 [info ] [MainThread]: 
[0m20:09:19.328736 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/int_trips.sql
[0m20:09:19.330349 [info ] [MainThread]: 
[0m20:09:19.331876 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=7
[0m20:09:19.335548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 35.54527, "process_in_blocks": "0", "process_kernel_time": 17.634975, "process_mem_max_rss": "785716", "process_out_blocks": "0", "process_user_time": 93.99256}
[0m20:09:19.338021 [debug] [MainThread]: Command `dbt run` failed at 20:09:19.337559 after 35.55 seconds
[0m20:09:19.341272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e13bdd8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e132ae8fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e132ae8cb0>]}
[0m20:09:19.343627 [debug] [MainThread]: Flushing usage events
[0m20:09:20.198987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:26.811873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad08859a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad0881d5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad08998a420>]}


============================== 20:11:26.825457 | 24a4a646-8aba-41f4-9767-cedbdfade4fc ==============================
[0m20:11:26.825457 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:11:26.827884 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'target_path': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run -s +int_trips+', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/app/logs', 'debug': 'False', 'static_parser': 'True', 'empty': 'False', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m20:11:27.315206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24a4a646-8aba-41f4-9767-cedbdfade4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad08859a0c0>]}
[0m20:11:27.458301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24a4a646-8aba-41f4-9767-cedbdfade4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad088331040>]}
[0m20:11:27.460457 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:11:27.759694 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:11:31.110066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:11:31.111617 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:11:31.113101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:11:31.237996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24a4a646-8aba-41f4-9767-cedbdfade4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad07fd79850>]}
[0m20:11:31.516989 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:11:31.532472 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:11:31.596912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24a4a646-8aba-41f4-9767-cedbdfade4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad07eca9400>]}
[0m20:11:31.598423 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:11:31.599953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24a4a646-8aba-41f4-9767-cedbdfade4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad07ea6c770>]}
[0m20:11:31.605034 [info ] [MainThread]: 
[0m20:11:31.606152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:11:31.608137 [info ] [MainThread]: 
[0m20:11:31.609897 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:11:31.622543 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:11:31.820731 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:11:31.822303 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:11:31.823497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:31.931615 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m20:11:31.937068 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:11:31.947087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m20:11:31.949051 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m20:11:31.967525 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:11:31.969169 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:11:31.970410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:32.057035 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m20:11:32.061351 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:11:32.062569 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m20:11:32.064573 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:11:32.065846 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:11:32.067468 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m20:11:32.070353 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:11:32.072643 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:11:32.073812 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:11:32.074820 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:11:32.076905 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:11:32.078159 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m20:11:32.088372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m20:11:32.102167 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:11:32.103594 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m20:11:32.104561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:32.205775 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m20:11:32.207245 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:11:32.208469 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:11:32.234372 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:11:32.237915 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m20:11:32.240411 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m20:11:32.241446 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m20:11:32.252096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24a4a646-8aba-41f4-9767-cedbdfade4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad087a2b920>]}
[0m20:11:32.253844 [debug] [MainThread]: Using duckdb connection "master"
[0m20:11:32.255045 [debug] [MainThread]: On master: BEGIN
[0m20:11:32.256588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:11:32.355145 [debug] [MainThread]: SQL status: OK in 0.099 seconds
[0m20:11:32.356398 [debug] [MainThread]: On master: COMMIT
[0m20:11:32.357597 [debug] [MainThread]: Using duckdb connection "master"
[0m20:11:32.359225 [debug] [MainThread]: On master: COMMIT
[0m20:11:32.361795 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:11:32.363318 [debug] [MainThread]: On master: Close
[0m20:11:32.378000 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m20:11:32.379625 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.int_trips ...................................... [RUN]
[0m20:11:32.381409 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.int_trips'
[0m20:11:32.382990 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m20:11:32.423906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m20:11:32.448998 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m20:11:32.517029 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m20:11:32.547994 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:11:32.549530 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m20:11:32.551080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:11:32.647454 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m20:11:32.648940 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:11:32.650338 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:11:32.670208 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:11:32.672682 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:11:32.674342 [debug] [Thread-1 (]: On model.dbt_project.int_trips: ROLLBACK
[0m20:11:32.684013 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_trips'
[0m20:11:32.685638 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m20:11:32.699199 [debug] [Thread-1 (]: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Catalog Error: Table with name int_trips_unioned does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 10:     select * from "taxi_rides_ny"."dev"."int_trips_unioned"
                             ^
[0m20:11:32.702961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a4a646-8aba-41f4-9767-cedbdfade4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad07deaeab0>]}
[0m20:11:32.704535 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model dev.int_trips ............................. [[31mERROR[0m in 0.32s]
[0m20:11:32.706854 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m20:11:32.708901 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.int_trips' to be skipped because of status 'error'.  Reason: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Catalog Error: Table with name int_trips_unioned does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 10:     select * from "taxi_rides_ny"."dev"."int_trips_unioned"
                             ^.
[0m20:11:32.713562 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m20:11:32.714883 [info ] [Thread-1 (]: 2 of 4 SKIP relation dev.fct_trips ............................................. [[33mSKIP[0m]
[0m20:11:32.716428 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m20:11:32.719307 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m20:11:32.720450 [info ] [Thread-1 (]: 3 of 4 SKIP relation dev.dim_vendors ........................................... [[33mSKIP[0m]
[0m20:11:32.721981 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m20:11:32.723369 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m20:11:32.724782 [info ] [Thread-1 (]: 4 of 4 SKIP relation dev.fct_monthly_zone_revenue .............................. [[33mSKIP[0m]
[0m20:11:32.727973 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m20:11:32.733049 [debug] [MainThread]: Using duckdb connection "master"
[0m20:11:32.734268 [debug] [MainThread]: On master: BEGIN
[0m20:11:32.735366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:32.831700 [debug] [MainThread]: SQL status: OK in 0.096 seconds
[0m20:11:32.832891 [debug] [MainThread]: On master: COMMIT
[0m20:11:32.834082 [debug] [MainThread]: Using duckdb connection "master"
[0m20:11:32.835131 [debug] [MainThread]: On master: COMMIT
[0m20:11:32.836841 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:11:32.838051 [debug] [MainThread]: On master: Close
[0m20:11:32.846543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:32.848200 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m20:11:32.849613 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was properly closed.
[0m20:11:32.851297 [info ] [MainThread]: 
[0m20:11:32.853012 [info ] [MainThread]: Finished running 1 incremental model, 3 view models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m20:11:32.856047 [debug] [MainThread]: Command end result
[0m20:11:32.992041 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:11:33.011083 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:11:33.035373 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:11:33.036449 [info ] [MainThread]: 
[0m20:11:33.037735 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:11:33.039107 [info ] [MainThread]: 
[0m20:11:33.040720 [error] [MainThread]: [31mFailure in model int_trips (models/intermediate/int_trips.sql)[0m
[0m20:11:33.042962 [error] [MainThread]:   Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Catalog Error: Table with name int_trips_unioned does not exist!
  Did you mean "stg_green_tripdata"?
  
  LINE 10:     select * from "taxi_rides_ny"."dev"."int_trips_unioned"
                             ^
[0m20:11:33.044980 [info ] [MainThread]: 
[0m20:11:33.047170 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/int_trips.sql
[0m20:11:33.048520 [info ] [MainThread]: 
[0m20:11:33.050045 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=4
[0m20:11:33.052705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.430558, "process_in_blocks": "0", "process_kernel_time": 0.740578, "process_mem_max_rss": "158836", "process_out_blocks": "0", "process_user_time": 5.900077}
[0m20:11:33.054292 [debug] [MainThread]: Command `dbt run` failed at 20:11:33.054045 after 6.43 seconds
[0m20:11:33.055380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad088880e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad07ecf96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad08a494e60>]}
[0m20:11:33.056609 [debug] [MainThread]: Flushing usage events
[0m20:11:33.838025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:27.647030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754aa3aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754a4b9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754a9bc7d0>]}


============================== 20:12:27.661656 | 4ecab03b-dd1e-4ba0-8de9-c01d33e52d42 ==============================
[0m20:12:27.661656 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:12:27.664067 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'no_print': 'None', 'quiet': 'False', 'warn_error': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s +int_trips+', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'target_path': 'None', 'log_path': '/usr/app/logs', 'use_experimental_parser': 'False', 'use_colors': 'True', 'cache_selected_only': 'False'}
[0m20:12:28.424629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754a138860>]}
[0m20:12:28.601905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754ac45700>]}
[0m20:12:28.604649 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:12:28.934274 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:12:31.897076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:12:31.898846 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/intermediate/int_trips_unioned.sql
[0m20:12:32.643460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e75411ea600>]}
[0m20:12:32.941417 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:12:32.958741 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:12:33.110044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e75410e8ec0>]}
[0m20:12:33.112000 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:12:33.113919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754b0ae330>]}
[0m20:12:33.120361 [info ] [MainThread]: 
[0m20:12:33.121886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:12:33.123442 [info ] [MainThread]: 
[0m20:12:33.125728 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:12:33.139391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:12:33.215394 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:12:33.217034 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:12:33.218827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:33.326688 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m20:12:33.329970 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:12:33.339548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m20:12:33.340753 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m20:12:33.357043 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:12:33.358610 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:12:33.359520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:33.458326 [debug] [ThreadPool]: SQL status: OK in 0.099 seconds
[0m20:12:33.461676 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:12:33.463096 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m20:12:33.464958 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:33.466374 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:12:33.467565 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m20:12:33.470191 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:12:33.473038 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:12:33.474599 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:12:33.476034 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:12:33.478112 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:12:33.479640 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m20:12:33.491453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m20:12:33.506439 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:12:33.507569 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m20:12:33.508485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:33.597759 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m20:12:33.599385 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:12:33.601600 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:12:33.625527 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:12:33.628861 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m20:12:33.631622 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m20:12:33.633333 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m20:12:33.643041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754a8b9910>]}
[0m20:12:33.644395 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:33.645377 [debug] [MainThread]: On master: BEGIN
[0m20:12:33.646578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:33.734025 [debug] [MainThread]: SQL status: OK in 0.087 seconds
[0m20:12:33.735395 [debug] [MainThread]: On master: COMMIT
[0m20:12:33.736485 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:33.737379 [debug] [MainThread]: On master: COMMIT
[0m20:12:33.739155 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:12:33.740100 [debug] [MainThread]: On master: Close
[0m20:12:33.755319 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m20:12:33.756743 [info ] [Thread-1 (]: 1 of 7 START sql view model dev.stg_green_tripdata ............................. [RUN]
[0m20:12:33.759459 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_green_tripdata'
[0m20:12:33.760754 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m20:12:33.790247 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m20:12:33.814032 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m20:12:33.887497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m20:12:33.910720 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:12:33.912194 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m20:12:33.913472 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:12:34.000211 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m20:12:34.002139 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:12:34.003654 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:12:34.007248 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:12:34.022563 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:12:34.024274 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m20:12:34.027444 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:12:34.036255 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:12:34.037700 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m20:12:34.039923 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:12:34.075978 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:12:34.077563 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:12:34.078750 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:12:34.095040 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:12:34.105658 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:12:34.107019 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_backup" cascade
[0m20:12:34.114545 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:12:34.120628 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m20:12:43.920780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754cd103b0>]}
[0m20:12:43.923426 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dev.stg_green_tripdata ........................ [[32mOK[0m in 10.16s]
[0m20:12:43.926349 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m20:12:43.928102 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m20:12:43.930084 [info ] [Thread-1 (]: 2 of 7 START sql view model dev.stg_yellow_tripdata ............................ [RUN]
[0m20:12:43.933108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m20:12:43.934882 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m20:12:43.947497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m20:12:43.974767 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m20:12:43.985058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m20:12:44.012426 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:12:44.014194 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m20:12:44.016149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:44.099160 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m20:12:44.101749 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:12:44.103302 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:12:44.107611 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:12:44.115367 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:12:44.117869 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m20:12:44.120561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:12:44.127412 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:12:44.128681 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m20:12:44.131023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:12:44.136120 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:12:44.137601 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:12:44.138805 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:12:44.160860 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m20:12:44.169024 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:12:44.170408 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_backup" cascade
[0m20:12:44.175692 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:12:44.178864 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m20:12:53.667192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e752b3ca960>]}
[0m20:12:53.669449 [info ] [Thread-1 (]: 2 of 7 OK created sql view model dev.stg_yellow_tripdata ....................... [[32mOK[0m in 9.74s]
[0m20:12:53.672894 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m20:12:53.675726 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m20:12:53.679149 [info ] [Thread-1 (]: 3 of 7 START sql view model dev.int_trips_unioned .............................. [RUN]
[0m20:12:53.682235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now model.dbt_project.int_trips_unioned)
[0m20:12:53.683924 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m20:12:53.693863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m20:12:53.727228 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m20:12:53.736609 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m20:12:53.763097 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:12:53.765233 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m20:12:53.766807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:53.856028 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:12:53.857622 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:12:53.859340 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."dev"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."dev"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m20:12:53.866104 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:12:53.874072 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:12:53.875691 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m20:12:53.878557 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:12:53.883252 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:12:53.885590 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:12:53.886985 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:12:53.906880 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m20:12:53.918610 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:12:53.920886 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."dev"."int_trips_unioned__dbt_backup" cascade
[0m20:12:53.924069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:12:53.927577 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m20:13:03.905436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e752b3f5670>]}
[0m20:13:03.909471 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dev.int_trips_unioned ......................... [[32mOK[0m in 10.22s]
[0m20:13:03.912776 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m20:13:03.916884 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m20:13:03.919388 [info ] [Thread-1 (]: 4 of 7 START sql view model dev.int_trips ...................................... [RUN]
[0m20:13:03.921496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now model.dbt_project.int_trips)
[0m20:13:03.923643 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m20:13:03.976134 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m20:13:04.010488 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m20:13:04.020209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m20:13:04.049858 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:13:04.052404 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m20:13:04.054279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:04.140379 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m20:13:04.142100 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:13:04.143489 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:13:04.154595 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:13:04.166938 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:13:04.170040 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" rename to "int_trips"
[0m20:13:04.174172 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:13:04.177387 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:13:04.178651 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:13:04.179912 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:13:04.196504 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:13:04.204801 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:13:04.206415 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."dev"."int_trips__dbt_backup" cascade
[0m20:13:04.208897 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:13:04.212424 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m20:13:17.136071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754ca7da30>]}
[0m20:13:17.155565 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dev.int_trips ................................. [[32mOK[0m in 13.21s]
[0m20:13:17.164289 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m20:13:17.172606 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m20:13:17.179207 [info ] [Thread-1 (]: 5 of 7 START sql incremental model dev.fct_trips ............................... [RUN]
[0m20:13:17.185444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now model.dbt_project.fct_trips)
[0m20:13:17.189577 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_trips
[0m20:13:17.309324 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_trips"
[0m20:13:17.353483 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_trips
[0m20:13:17.985842 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:13:17.989297 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:13:17.992330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:18.242651 [debug] [Thread-1 (]: SQL status: OK in 0.250 seconds
[0m20:13:18.444941 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m20:13:18.451724 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:13:18.461594 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as TEXT)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as TEXT)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as TEXT)
 as pickup_borough, 
      
    cast(null as TEXT)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as TEXT)
 as dropoff_borough, 
      
    cast(null as TEXT)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as TEXT)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as TEXT)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:13:18.474818 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:13:18.651371 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_trips"
[0m20:13:18.956018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:13:18.974327 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: BEGIN
[0m20:13:18.993121 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:13:19.002694 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:13:19.011293 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."dev"."fct_trips"
  
  (
    trip_id TEXT,
    vendor_id integer,
    service_type TEXT,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough TEXT,
    pickup_zone TEXT,
    dropoff_location_id integer,
    dropoff_borough TEXT,
    dropoff_zone TEXT,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag TEXT,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description TEXT
    
    )
 ;
    insert into "taxi_rides_ny"."dev"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m20:14:03.679729 [debug] [Thread-1 (]: SQL status: OK in 44.675 seconds
[0m20:14:03.694604 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m20:14:03.696975 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:14:03.698167 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m20:14:13.416729 [debug] [Thread-1 (]: SQL status: OK in 9.716 seconds
[0m20:14:13.421138 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: Close
[0m20:14:13.814610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e752b3e7440>]}
[0m20:14:13.817078 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model dev.fct_trips .......................... [[32mOK[0m in 56.63s]
[0m20:14:13.819626 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m20:14:13.823376 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m20:14:13.825360 [info ] [Thread-1 (]: 6 of 7 START sql view model dev.dim_vendors .................................... [RUN]
[0m20:14:13.828469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fct_trips, now model.dbt_project.dim_vendors)
[0m20:14:13.830638 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_vendors
[0m20:14:13.849329 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_vendors"
[0m20:14:13.889252 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_vendors
[0m20:14:13.899112 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_vendors"
[0m20:14:13.933932 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:14:13.935901 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: BEGIN
[0m20:14:13.937481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:14.042732 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:14:14.044880 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:14:14.046355 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */

  
  create view "taxi_rides_ny"."dev"."dim_vendors__dbt_tmp" as (
    -- Dimension table for taxi technology vendors
-- Small static dimension defining vendor codes and their company names

with trips as (
    select * from "taxi_rides_ny"."dev"."fct_trips"
),

vendors as (
    select distinct
        vendor_id,
        



case vendor_id
    
    when 1 then 'Creative Mobile Technologies'
    
    when 2 then 'VeriFone Inc.'
    
    when 4 then 'Unknown/Other'
    
end

 as vendor_name
    from trips
)

select * from vendors
  );

[0m20:14:14.050144 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:14:14.058103 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:14:14.061492 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */
alter view "taxi_rides_ny"."dev"."dim_vendors__dbt_tmp" rename to "dim_vendors"
[0m20:14:14.064304 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:14:14.067823 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: COMMIT
[0m20:14:14.069083 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:14:14.070366 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: COMMIT
[0m20:14:14.087947 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:14:14.102049 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:14:14.106923 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */
drop view if exists "taxi_rides_ny"."dev"."dim_vendors__dbt_backup" cascade
[0m20:14:14.113739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:14:14.121209 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: Close
[0m20:14:27.202718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e752bc57c50>]}
[0m20:14:27.205882 [info ] [Thread-1 (]: 6 of 7 OK created sql view model dev.dim_vendors ............................... [[32mOK[0m in 13.37s]
[0m20:14:27.210672 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m20:14:27.212884 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m20:14:27.215872 [info ] [Thread-1 (]: 7 of 7 START sql view model dev.fct_monthly_zone_revenue ....................... [RUN]
[0m20:14:27.218888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_vendors, now model.dbt_project.fct_monthly_zone_revenue)
[0m20:14:27.220804 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_monthly_zone_revenue
[0m20:14:27.239382 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_monthly_zone_revenue"
[0m20:14:27.270675 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_monthly_zone_revenue
[0m20:14:27.292661 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_monthly_zone_revenue"
[0m20:14:27.321864 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:14:27.325506 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: BEGIN
[0m20:14:27.327376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:27.427705 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m20:14:27.429808 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:14:27.431735 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */

  
  create view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" as (
    -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime)
     as revenue_month,
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."dev"."fct_trips"
group by pickup_zone, revenue_month, service_type
  );

[0m20:14:27.436120 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:14:27.448404 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:14:27.450489 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
alter view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" rename to "fct_monthly_zone_revenue"
[0m20:14:27.454983 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:14:27.460862 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: COMMIT
[0m20:14:27.462814 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:14:27.464173 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: COMMIT
[0m20:14:27.484665 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m20:14:27.493422 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:14:27.496071 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
drop view if exists "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_backup" cascade
[0m20:14:27.499257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:14:27.503282 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: Close
[0m20:14:41.003633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ecab03b-dd1e-4ba0-8de9-c01d33e52d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7528189460>]}
[0m20:14:41.006603 [info ] [Thread-1 (]: 7 of 7 OK created sql view model dev.fct_monthly_zone_revenue .................. [[32mOK[0m in 13.79s]
[0m20:14:41.009310 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m20:14:41.017241 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:41.019193 [debug] [MainThread]: On master: BEGIN
[0m20:14:41.020670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:41.119126 [debug] [MainThread]: SQL status: OK in 0.098 seconds
[0m20:14:41.121115 [debug] [MainThread]: On master: COMMIT
[0m20:14:41.122446 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:41.123843 [debug] [MainThread]: On master: COMMIT
[0m20:14:41.126099 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:14:41.128297 [debug] [MainThread]: On master: Close
[0m20:14:41.144317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:41.146162 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m20:14:41.147953 [debug] [MainThread]: Connection 'model.dbt_project.fct_monthly_zone_revenue' was properly closed.
[0m20:14:41.150723 [info ] [MainThread]: 
[0m20:14:41.152742 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 2 minutes and 8.02 seconds (128.02s).
[0m20:14:41.159615 [debug] [MainThread]: Command end result
[0m20:14:41.359305 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:14:41.377206 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:14:41.413057 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:14:41.416553 [info ] [MainThread]: 
[0m20:14:41.418403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:41.420662 [info ] [MainThread]: 
[0m20:14:41.422435 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m20:14:41.427368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 134.01344, "process_in_blocks": "5456", "process_kernel_time": 91.47178, "process_mem_max_rss": "3375440", "process_out_blocks": "0", "process_user_time": 485.51846}
[0m20:14:41.429355 [debug] [MainThread]: Command `dbt run` succeeded at 20:14:41.428927 after 134.02 seconds
[0m20:14:41.431294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754e87a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754a87f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e754aff18b0>]}
[0m20:14:41.433664 [debug] [MainThread]: Flushing usage events
[0m20:14:42.235840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:09.117188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e1ad6fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e19774320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e18b38710>]}


============================== 20:16:09.138339 | 3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56 ==============================
[0m20:16:09.138339 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:16:09.140351 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'empty': 'False', 'target_path': 'None', 'log_path': '/usr/app/logs', 'introspect': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False'}
[0m20:16:09.656594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e183be8d0>]}
[0m20:16:09.802671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e185082c0>]}
[0m20:16:09.804948 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:16:10.075444 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:16:13.273084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:13.274138 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:16:13.275198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:13.362933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e1073d6a0>]}
[0m20:16:13.628780 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:16:13.647354 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:16:13.711321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e1073d790>]}
[0m20:16:13.713238 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:16:13.714624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5df3519c70>]}
[0m20:16:13.720257 [info ] [MainThread]: 
[0m20:16:13.721637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:13.722850 [info ] [MainThread]: 
[0m20:16:13.724844 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:16:13.738938 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:16:13.813114 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:16:13.814445 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:16:13.815790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:13.907876 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m20:16:13.911414 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:16:13.919536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m20:16:13.921506 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m20:16:13.932813 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:16:13.933978 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:16:13.934959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:14.019315 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m20:16:14.022581 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:16:14.023892 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m20:16:14.025666 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:16:14.026842 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:16:14.028173 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m20:16:14.030249 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:16:14.033001 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:16:14.034589 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:16:14.036107 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:16:14.038277 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:16:14.040089 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m20:16:14.051695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m20:16:14.063181 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:16:14.064590 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m20:16:14.066069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:14.157271 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m20:16:14.158636 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:16:14.159926 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:16:14.179039 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:16:14.182277 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m20:16:14.184524 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m20:16:14.185555 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m20:16:14.196006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e183bf800>]}
[0m20:16:14.197386 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:14.198564 [debug] [MainThread]: On master: BEGIN
[0m20:16:14.199650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:14.290852 [debug] [MainThread]: SQL status: OK in 0.091 seconds
[0m20:16:14.292136 [debug] [MainThread]: On master: COMMIT
[0m20:16:14.293162 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:14.294097 [debug] [MainThread]: On master: COMMIT
[0m20:16:14.295523 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:16:14.296614 [debug] [MainThread]: On master: Close
[0m20:16:14.309406 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m20:16:14.310750 [info ] [Thread-1 (]: 1 of 8 START sql view model dev.dim_zones ...................................... [RUN]
[0m20:16:14.312462 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m20:16:14.313741 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m20:16:14.329590 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m20:16:14.361138 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m20:16:14.417212 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m20:16:14.445262 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:16:14.446571 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m20:16:14.447979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:16:14.537454 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:16:14.538931 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:16:14.540185 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m20:16:14.542253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:14.553643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:16:14.554743 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones" rename to "dim_zones__dbt_backup"
[0m20:16:14.556442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:14.562964 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:16:14.564454 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m20:16:14.566487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:14.599891 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:16:14.601095 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:16:14.602294 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:16:14.617076 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:16:14.628081 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:16:14.629220 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."dev"."dim_zones__dbt_backup" cascade
[0m20:16:14.635676 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:16:14.639815 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m20:16:25.391744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e1b050380>]}
[0m20:16:25.399239 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dev.dim_zones ................................. [[32mOK[0m in 11.08s]
[0m20:16:25.405904 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m20:16:25.412791 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m20:16:25.417783 [info ] [Thread-1 (]: 2 of 8 START sql view model dev.stg_green_tripdata ............................. [RUN]
[0m20:16:25.420174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.stg_green_tripdata)
[0m20:16:25.422397 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m20:16:25.448154 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m20:16:25.470869 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m20:16:25.483207 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m20:16:25.514018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:16:25.515601 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m20:16:25.516930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:25.605894 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:16:25.609912 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:16:25.611555 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:16:25.615637 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:16:25.625942 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:16:25.627710 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m20:16:25.630542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:25.637503 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:16:25.638984 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m20:16:25.643263 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:16:25.647387 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:16:25.650144 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:16:25.651645 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:16:25.668501 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:16:25.677361 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:16:25.679119 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_backup" cascade
[0m20:16:25.687627 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:16:25.692529 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m20:16:36.408508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5df2accf80>]}
[0m20:16:36.415931 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dev.stg_green_tripdata ........................ [[32mOK[0m in 10.98s]
[0m20:16:36.419397 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m20:16:36.422423 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m20:16:36.425325 [info ] [Thread-1 (]: 3 of 8 START sql view model dev.stg_yellow_tripdata ............................ [RUN]
[0m20:16:36.429113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m20:16:36.433594 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m20:16:36.457467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m20:16:36.489346 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m20:16:36.501368 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m20:16:36.535495 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:16:36.537304 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m20:16:36.538759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:36.650983 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:16:36.652735 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:16:36.654368 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:16:36.658067 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:16:36.671425 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:16:36.673406 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m20:16:36.676575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:36.689382 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:16:36.691930 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m20:16:36.695293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:36.700152 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:16:36.701643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:16:36.702961 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:16:36.717571 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:16:36.725088 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:16:36.726772 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_backup" cascade
[0m20:16:36.734314 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:16:36.740228 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m20:16:47.328582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5df29c17c0>]}
[0m20:16:47.331589 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dev.stg_yellow_tripdata ....................... [[32mOK[0m in 10.90s]
[0m20:16:47.333352 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m20:16:47.337196 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m20:16:47.338472 [info ] [Thread-1 (]: 4 of 8 START sql view model dev.int_trips_unioned .............................. [RUN]
[0m20:16:47.339942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now model.dbt_project.int_trips_unioned)
[0m20:16:47.341191 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m20:16:47.353178 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m20:16:47.384597 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m20:16:47.543866 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m20:16:47.578776 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:16:47.580407 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m20:16:47.582018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:47.664766 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m20:16:47.666095 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:16:47.667247 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."dev"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."dev"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m20:16:47.672582 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:16:47.680221 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:16:47.681465 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."dev"."int_trips_unioned" rename to "int_trips_unioned__dbt_backup"
[0m20:16:47.683803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:47.689052 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:16:47.690242 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m20:16:47.692390 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:47.697004 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:16:47.698490 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:16:47.699684 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:16:47.715115 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:16:47.720119 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:16:47.721150 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."dev"."int_trips_unioned__dbt_backup" cascade
[0m20:16:47.727364 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:16:47.732322 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m20:16:57.364448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5df29c01a0>]}
[0m20:16:57.366380 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dev.int_trips_unioned ......................... [[32mOK[0m in 10.02s]
[0m20:16:57.368870 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m20:16:57.371869 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m20:16:57.373434 [info ] [Thread-1 (]: 5 of 8 START sql view model dev.int_trips ...................................... [RUN]
[0m20:16:57.375664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now model.dbt_project.int_trips)
[0m20:16:57.378016 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m20:16:57.418136 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m20:16:57.447832 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m20:16:57.456716 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m20:16:57.478025 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:16:57.479681 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m20:16:57.481630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:57.599958 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m20:16:57.602074 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:16:57.603962 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:16:57.616791 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:16:57.626815 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:16:57.628479 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."dev"."int_trips" rename to "int_trips__dbt_backup"
[0m20:16:57.631877 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:16:57.649265 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:16:57.650861 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" rename to "int_trips"
[0m20:16:57.654135 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:16:57.661974 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:16:57.664301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:16:57.665765 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:16:57.689083 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m20:16:57.698696 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:16:57.700674 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."dev"."int_trips__dbt_backup" cascade
[0m20:16:57.709960 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:16:57.715818 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m20:17:09.421406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5df34a9280>]}
[0m20:17:09.424028 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dev.int_trips ................................. [[32mOK[0m in 12.05s]
[0m20:17:09.426256 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m20:17:09.429521 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m20:17:09.431088 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dev.fct_trips ............................... [RUN]
[0m20:17:09.432943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now model.dbt_project.fct_trips)
[0m20:17:09.435981 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_trips
[0m20:17:09.475200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_trips"
[0m20:17:09.507939 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_trips
[0m20:17:09.717923 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:17:09.720516 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


  -- Only process new trips based on pickup datetime
  where trips.pickup_datetime > (select max(pickup_datetime) from "taxi_rides_ny"."dev"."fct_trips")

    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:17:09.722894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:09.845441 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m20:17:09.896072 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m20:17:09.899362 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:17:09.903040 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as TEXT)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as TEXT)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as TEXT)
 as pickup_borough, 
      
    cast(null as TEXT)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as TEXT)
 as dropoff_borough, 
      
    cast(null as TEXT)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as TEXT)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as TEXT)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:17:09.907295 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:17:09.932068 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:17:09.934719 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

    
  
    
    
      
    

    create temporary table
      "fct_trips__dbt_tmp20260220201709624846"
  
    as (
      

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


  -- Only process new trips based on pickup datetime
  where trips.pickup_datetime > (select max(pickup_datetime) from "taxi_rides_ny"."dev"."fct_trips")

    );
  
  
  
[0m20:17:29.278951 [debug] [Thread-1 (]: SQL status: OK in 19.341 seconds
[0m20:17:29.319596 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:17:29.322124 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: BEGIN
[0m20:17:29.326111 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:17:29.328332 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:17:29.330858 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips__dbt_tmp20260220201709624846'
      
      
      order by ordinal_position

  
[0m20:17:29.383277 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m20:17:29.411867 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:17:29.414597 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips'
      
      and table_schema = 'dev'
      
      
      and table_catalog = 'taxi_rides_ny'
      
      order by ordinal_position

  
[0m20:17:29.424892 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:17:29.482361 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:17:29.485892 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips__dbt_tmp20260220201709624846'
      
      
      order by ordinal_position

  
[0m20:17:29.496492 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:17:29.512098 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:17:29.515489 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips'
      
      and table_schema = 'dev'
      
      
      and table_catalog = 'taxi_rides_ny'
      
      order by ordinal_position

  
[0m20:17:29.525874 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:17:29.570919 [debug] [Thread-1 (]: 
    In "taxi_rides_ny"."dev"."fct_trips":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:17:29.573643 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: ROLLBACK
[0m20:17:29.585572 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.fct_trips'
[0m20:17:29.587179 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: Close
[0m20:17:30.110413 [debug] [Thread-1 (]: Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  The incremental strategy 'merge' is not valid for this adapter
[0m20:17:30.113491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d2853ca-7dad-41cf-be6e-7f8ffb8c8e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e1839fad0>]}
[0m20:17:30.119022 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model dev.fct_trips ...................... [[31mERROR[0m in 20.68s]
[0m20:17:30.121815 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m20:17:30.124751 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_trips' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  The incremental strategy 'merge' is not valid for this adapter.
[0m20:17:30.130374 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m20:17:30.134444 [info ] [Thread-1 (]: 7 of 8 SKIP relation dev.dim_vendors ........................................... [[33mSKIP[0m]
[0m20:17:30.137083 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m20:17:30.139266 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m20:17:30.141089 [info ] [Thread-1 (]: 8 of 8 SKIP relation dev.fct_monthly_zone_revenue .............................. [[33mSKIP[0m]
[0m20:17:30.143672 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m20:17:30.157580 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:30.159600 [debug] [MainThread]: On master: BEGIN
[0m20:17:30.161005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:30.289523 [debug] [MainThread]: SQL status: OK in 0.128 seconds
[0m20:17:30.290991 [debug] [MainThread]: On master: COMMIT
[0m20:17:30.292095 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:30.293099 [debug] [MainThread]: On master: COMMIT
[0m20:17:30.295188 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:17:30.296487 [debug] [MainThread]: On master: Close
[0m20:17:30.306318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:30.308165 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m20:17:30.309942 [debug] [MainThread]: Connection 'model.dbt_project.fct_trips' was properly closed.
[0m20:17:30.312211 [info ] [MainThread]: 
[0m20:17:30.314320 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 1 minutes and 16.59 seconds (76.59s).
[0m20:17:30.321600 [debug] [MainThread]: Command end result
[0m20:17:30.500094 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:17:30.522274 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:17:30.554318 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:17:30.555748 [info ] [MainThread]: 
[0m20:17:30.557107 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:17:30.558572 [info ] [MainThread]: 
[0m20:17:30.560886 [error] [MainThread]: [31mFailure in model fct_trips (models/marts/reporting/fct_trips.sql)[0m
[0m20:17:30.562552 [error] [MainThread]:   Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  The incremental strategy 'merge' is not valid for this adapter
[0m20:17:30.565945 [info ] [MainThread]: 
[0m20:17:30.568227 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/reporting/fct_trips.sql
[0m20:17:30.569708 [info ] [MainThread]: 
[0m20:17:30.571498 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=8
[0m20:17:30.576034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 81.66065, "process_in_blocks": "240", "process_kernel_time": 59.543842, "process_mem_max_rss": "3615992", "process_out_blocks": "0", "process_user_time": 252.2875}
[0m20:17:30.577649 [debug] [MainThread]: Command `dbt run` failed at 20:17:30.577353 after 81.66 seconds
[0m20:17:30.579197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e18a302f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e1a77cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e1b261070>]}
[0m20:17:30.581341 [debug] [MainThread]: Flushing usage events
[0m20:17:31.426826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:55.155954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad1598f1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad158f32f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad15933a9c0>]}


============================== 20:19:55.171322 | efbb85d0-27e9-4cb8-8e5c-4928cec333da ==============================
[0m20:19:55.171322 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:19:55.172794 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'static_parser': 'True', 'write_json': 'True', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'empty': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/app/logs', 'partial_parse': 'True'}
[0m20:19:55.597260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efbb85d0-27e9-4cb8-8e5c-4928cec333da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad159025c70>]}
[0m20:19:55.720950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efbb85d0-27e9-4cb8-8e5c-4928cec333da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad1592d7cb0>]}
[0m20:19:55.723728 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:19:55.977576 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:19:59.256497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:19:59.258242 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/reporting/fct_trips.sql
[0m20:19:59.610553 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m20:19:59.613178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.6208725, "process_in_blocks": "0", "process_kernel_time": 0.520636, "process_mem_max_rss": "141424", "process_out_blocks": "0", "process_user_time": 4.421408}
[0m20:19:59.614770 [debug] [MainThread]: Command `dbt run` failed at 20:19:59.614497 after 4.62 seconds
[0m20:19:59.616166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad158b17d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad143dc0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad143d67e30>]}
[0m20:19:59.617465 [debug] [MainThread]: Flushing usage events
[0m20:20:00.275094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:20:35.887268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702733226060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027332fac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702732313320>]}


============================== 20:20:35.910258 | a779d145-6fb9-48b8-bed7-9ac8653775ec ==============================
[0m20:20:35.910258 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:20:35.913161 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/app/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'indirect_selection': 'eager'}
[0m20:20:36.485391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a779d145-6fb9-48b8-bed7-9ac8653775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702734111070>]}
[0m20:20:36.659840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a779d145-6fb9-48b8-bed7-9ac8653775ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702732007bf0>]}
[0m20:20:36.663668 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:20:37.007011 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:20:40.396537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:20:40.398688 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/reporting/fct_trips.sql
[0m20:20:40.806457 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  expected token ',', got '='
    line 5
      --  incremental_strategy='merge',
[0m20:20:40.809068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.191344, "process_in_blocks": "0", "process_kernel_time": 0.736231, "process_mem_max_rss": "141176", "process_out_blocks": "0", "process_user_time": 6.864749}
[0m20:20:40.810646 [debug] [MainThread]: Command `dbt run` failed at 20:20:40.810413 after 5.19 seconds
[0m20:20:40.812256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702733226060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70272d93dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702728307020>]}
[0m20:20:40.813786 [debug] [MainThread]: Flushing usage events
[0m20:20:41.486551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:22.529666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1952cb5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a195442d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19527a0ef0>]}


============================== 20:21:22.544624 | 4bb3ac02-1a3a-4556-870b-83af505d4267 ==============================
[0m20:21:22.544624 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:21:22.546504 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/logs', 'empty': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'write_json': 'True', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m20:21:23.031087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb3ac02-1a3a-4556-870b-83af505d4267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1951c530b0>]}
[0m20:21:23.167012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb3ac02-1a3a-4556-870b-83af505d4267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a195209f6e0>]}
[0m20:21:23.169260 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:21:23.534933 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:21:27.059592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:21:27.061422 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/reporting/fct_trips.sql
[0m20:21:27.371335 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  expected token ',', got '='
    line 7
      --  incremental_strategy='merge',
[0m20:21:27.373894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.045838, "process_in_blocks": "0", "process_kernel_time": 0.704869, "process_mem_max_rss": "141592", "process_out_blocks": "0", "process_user_time": 5.683517}
[0m20:21:27.375052 [debug] [MainThread]: Command `dbt run` failed at 20:21:27.374875 after 5.05 seconds
[0m20:21:27.375910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1952aeecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1949f83aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1951c6de50>]}
[0m20:21:27.376832 [debug] [MainThread]: Flushing usage events
[0m20:21:27.979310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:08.965117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a28db8e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a28f4cd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a28de51dc0>]}


============================== 20:23:08.983364 | 10e84563-33f3-4720-8f62-f17cb5637618 ==============================
[0m20:23:08.983364 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:23:08.985668 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'profiles_dir': '/root/.dbt', 'empty': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'target_path': 'None', 'version_check': 'True', 'cache_selected_only': 'False'}
[0m20:23:09.661883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10e84563-33f3-4720-8f62-f17cb5637618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a28db31bb0>]}
[0m20:23:09.877201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10e84563-33f3-4720-8f62-f17cb5637618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a285b11ee0>]}
[0m20:23:09.879915 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:23:10.263358 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:23:13.140396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:23:13.142600 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/reporting/fct_trips.sql
[0m20:23:13.660319 [error] [MainThread]: Encountered an error:
Invalid value for on_schema_change: ignore. Models materialized as incremental with contracts enabled must set on_schema_change to 'append_new_columns' or 'fail'
[0m20:23:13.674299 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 407, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 434, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2257, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 323, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 446, in load
    self.parse_project(
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 760, in parse_project
    parser.parse_file(block, dct=dct)
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/schemas.py", line 233, in parse_file
    model_parse_result = ModelPatchParser(self, yaml_block, "models").parse()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/schemas.py", line 644, in parse
    self.parse_patch(node_block, refs)
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/schemas.py", line 969, in parse_patch
    super().parse_patch(block, refs)
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/schemas.py", line 910, in parse_patch
    self.patch_node_config(node, patch)
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/schemas.py", line 767, in patch_node_config
    self.schema_parser.update_parsed_node_config(
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/base.py", line 356, in update_parsed_node_config
    config_dict = config.build_config_dict(patch_config_dict=patch_config_dict)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/context/context_config.py", line 342, in build_config_dict
    return src.calculate_node_config_dict(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/context/context_config.py", line 240, in calculate_node_config_dict
    config = self.calculate_node_config(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/context/context_config.py", line 173, in calculate_node_config
    result = self._update_from_config(result, config_call_dict)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/context/context_config.py", line 218, in _update_from_config
    updated = result.update_from(translated, adapter_config_cls, validate=validate)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt_common/contracts/config/base.py", line 187, in update_from
    return self.from_dict(dct)
           ^^^^^^^^^^^^^^^^^^^
  File "<string>", line 151, in __mashumaro_from_dict__
  File "<string>", line 33, in __init__
  File "/usr/local/lib/python3.12/site-packages/dbt/artifacts/resources/v1/model.py", line 83, in __post_init__
    super().__post_init__()
  File "/usr/local/lib/python3.12/site-packages/dbt/artifacts/resources/v1/config.py", line 146, in __post_init__
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for on_schema_change: ignore. Models materialized as incremental with contracts enabled must set on_schema_change to 'append_new_columns' or 'fail'

[0m20:23:13.677666 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0584683, "process_in_blocks": "272", "process_kernel_time": 0.547419, "process_mem_max_rss": "143400", "process_out_blocks": "0", "process_user_time": 6.086016}
[0m20:23:13.680109 [debug] [MainThread]: Command `dbt run` failed at 20:23:13.679882 after 5.06 seconds
[0m20:23:13.681258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a28e017b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a28476aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a2848abbf0>]}
[0m20:23:13.683163 [debug] [MainThread]: Flushing usage events
[0m20:23:14.317039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:29.368586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be2f952e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be2f9938bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be2f93aa0c0>]}


============================== 20:23:29.385086 | 14d36733-6b5b-4f37-a450-901e02edb1be ==============================
[0m20:23:29.385086 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:23:29.387100 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'target_path': 'None', 'introspect': 'True', 'log_path': '/usr/app/logs', 'static_parser': 'True', 'warn_error': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'printer_width': '80', 'no_print': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m20:23:29.843347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14d36733-6b5b-4f37-a450-901e02edb1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be2f50b0ef0>]}
[0m20:23:29.979476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14d36733-6b5b-4f37-a450-901e02edb1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be2f8b3c800>]}
[0m20:23:29.981645 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:23:30.240814 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:23:33.360395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:23:33.362500 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/reporting/fct_trips.sql
[0m20:23:33.805305 [error] [MainThread]: Encountered an error:
Invalid value for on_schema_change: ignore. Models materialized as incremental with contracts enabled must set on_schema_change to 'append_new_columns' or 'fail'
[0m20:23:33.810769 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 407, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 434, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2257, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 323, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 446, in load
    self.parse_project(
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/manifest.py", line 760, in parse_project
    parser.parse_file(block, dct=dct)
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/schemas.py", line 233, in parse_file
    model_parse_result = ModelPatchParser(self, yaml_block, "models").parse()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/schemas.py", line 644, in parse
    self.parse_patch(node_block, refs)
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/schemas.py", line 969, in parse_patch
    super().parse_patch(block, refs)
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/schemas.py", line 910, in parse_patch
    self.patch_node_config(node, patch)
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/schemas.py", line 767, in patch_node_config
    self.schema_parser.update_parsed_node_config(
  File "/usr/local/lib/python3.12/site-packages/dbt/parser/base.py", line 356, in update_parsed_node_config
    config_dict = config.build_config_dict(patch_config_dict=patch_config_dict)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/context/context_config.py", line 342, in build_config_dict
    return src.calculate_node_config_dict(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/context/context_config.py", line 240, in calculate_node_config_dict
    config = self.calculate_node_config(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/context/context_config.py", line 173, in calculate_node_config
    result = self._update_from_config(result, config_call_dict)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/context/context_config.py", line 218, in _update_from_config
    updated = result.update_from(translated, adapter_config_cls, validate=validate)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt_common/contracts/config/base.py", line 187, in update_from
    return self.from_dict(dct)
           ^^^^^^^^^^^^^^^^^^^
  File "<string>", line 151, in __mashumaro_from_dict__
  File "<string>", line 33, in __init__
  File "/usr/local/lib/python3.12/site-packages/dbt/artifacts/resources/v1/model.py", line 83, in __post_init__
    super().__post_init__()
  File "/usr/local/lib/python3.12/site-packages/dbt/artifacts/resources/v1/config.py", line 146, in __post_init__
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Invalid value for on_schema_change: ignore. Models materialized as incremental with contracts enabled must set on_schema_change to 'append_new_columns' or 'fail'

[0m20:23:33.813755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.6648817, "process_in_blocks": "0", "process_kernel_time": 0.665196, "process_mem_max_rss": "143364", "process_out_blocks": "0", "process_user_time": 6.371459}
[0m20:23:33.815108 [debug] [MainThread]: Command `dbt run` failed at 20:23:33.814907 after 4.67 seconds
[0m20:23:33.816264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be2f9938bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be2d3bb82c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be2d3bdbf50>]}
[0m20:23:33.817187 [debug] [MainThread]: Flushing usage events
[0m20:23:34.520734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:38.340013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e96bb2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e968a8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e96271ee0>]}


============================== 20:25:38.352504 | dffa6b1a-df39-479f-ad52-6eab7793e186 ==============================
[0m20:25:38.352504 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:25:38.354506 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'empty': 'False', 'introspect': 'True', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/usr/app/logs', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False'}
[0m20:25:38.940678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e95d68ef0>]}
[0m20:25:39.264003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e95d6dee0>]}
[0m20:25:39.267668 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:25:39.608418 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:25:42.905001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:42.906934 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/reporting/fct_trips.sql
[0m20:25:44.122735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e8cbe9940>]}
[0m20:25:44.521239 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:25:44.539663 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:25:44.608419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e8ca58680>]}
[0m20:25:44.610101 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:25:44.611308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e96bcab40>]}
[0m20:25:44.618614 [info ] [MainThread]: 
[0m20:25:44.620166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:44.621412 [info ] [MainThread]: 
[0m20:25:44.623339 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:25:44.635124 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:25:44.727271 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:25:44.728530 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:25:44.729722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:44.837995 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m20:25:44.840894 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:25:44.848576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m20:25:44.849927 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m20:25:44.863624 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:25:44.865193 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:25:44.866155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:44.982353 [debug] [ThreadPool]: SQL status: OK in 0.116 seconds
[0m20:25:44.987180 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:25:44.988714 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m20:25:44.990825 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:44.992029 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:25:44.993237 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m20:25:44.995497 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:44.997557 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:25:44.998644 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:25:44.999522 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:25:45.001282 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:45.002329 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m20:25:45.013555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m20:25:45.025247 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:25:45.026459 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m20:25:45.027879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:45.121876 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m20:25:45.122979 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:25:45.124238 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:25:45.152369 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m20:25:45.157015 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m20:25:45.161447 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m20:25:45.163328 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m20:25:45.174959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e8cf142c0>]}
[0m20:25:45.176419 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:45.177419 [debug] [MainThread]: On master: BEGIN
[0m20:25:45.178726 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:45.287276 [debug] [MainThread]: SQL status: OK in 0.108 seconds
[0m20:25:45.289028 [debug] [MainThread]: On master: COMMIT
[0m20:25:45.290422 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:45.291517 [debug] [MainThread]: On master: COMMIT
[0m20:25:45.293172 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:25:45.294409 [debug] [MainThread]: On master: Close
[0m20:25:45.314672 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m20:25:45.316266 [info ] [Thread-1 (]: 1 of 8 START sql view model dev.dim_zones ...................................... [RUN]
[0m20:25:45.320409 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m20:25:45.321576 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m20:25:45.337453 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m20:25:45.371028 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m20:25:45.436222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m20:25:45.468496 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:25:45.470057 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m20:25:45.471744 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:25:45.596141 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m20:25:45.597881 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:25:45.599237 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m20:25:45.602177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:45.614170 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:25:45.615743 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones" rename to "dim_zones__dbt_backup"
[0m20:25:45.618830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:45.624557 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:25:45.625861 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m20:25:45.627905 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:45.658184 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:25:45.660155 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:25:45.661609 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:25:45.677980 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:25:45.699582 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:25:45.701031 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."dev"."dim_zones__dbt_backup" cascade
[0m20:25:45.708860 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:25:45.713555 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m20:25:55.428582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e8e1eedb0>]}
[0m20:25:55.430497 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dev.dim_zones ................................. [[32mOK[0m in 10.11s]
[0m20:25:55.433114 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m20:25:55.435001 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m20:25:55.437355 [info ] [Thread-1 (]: 2 of 8 START sql view model dev.stg_green_tripdata ............................. [RUN]
[0m20:25:55.438991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.stg_green_tripdata)
[0m20:25:55.440249 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m20:25:55.458274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m20:25:55.485174 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m20:25:55.493796 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m20:25:55.521911 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:25:55.523198 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m20:25:55.524424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:55.603898 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m20:25:55.605516 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:25:55.607392 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:25:55.611946 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:25:55.620718 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:25:55.622255 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m20:25:55.624966 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:55.631898 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:25:55.633336 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m20:25:55.636160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:25:55.639794 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:25:55.641081 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:25:55.642204 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:25:55.662202 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m20:25:55.668282 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:25:55.669589 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_backup" cascade
[0m20:25:55.676355 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:25:55.680142 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m20:26:04.513988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e8cbea8d0>]}
[0m20:26:04.527231 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dev.stg_green_tripdata ........................ [[32mOK[0m in 9.07s]
[0m20:26:04.530558 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m20:26:04.545765 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m20:26:04.550184 [info ] [Thread-1 (]: 3 of 8 START sql view model dev.stg_yellow_tripdata ............................ [RUN]
[0m20:26:04.553566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m20:26:04.555681 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m20:26:04.572421 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m20:26:04.603914 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m20:26:04.616745 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m20:26:04.654081 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:26:04.656190 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m20:26:04.659203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:04.789647 [debug] [Thread-1 (]: SQL status: OK in 0.131 seconds
[0m20:26:04.792265 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:26:04.794190 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:26:04.802434 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:26:04.815844 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:26:04.818303 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m20:26:04.824740 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:26:04.843182 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:26:04.845346 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m20:26:04.849435 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:26:04.859146 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:26:04.862455 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:26:04.864574 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:26:04.892258 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m20:26:04.900203 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:26:04.902025 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_backup" cascade
[0m20:26:04.912088 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:26:04.916580 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m20:26:15.140432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e4bc42060>]}
[0m20:26:15.143146 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dev.stg_yellow_tripdata ....................... [[32mOK[0m in 10.59s]
[0m20:26:15.144999 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m20:26:15.148381 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m20:26:15.149946 [info ] [Thread-1 (]: 4 of 8 START sql view model dev.int_trips_unioned .............................. [RUN]
[0m20:26:15.151363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now model.dbt_project.int_trips_unioned)
[0m20:26:15.152610 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m20:26:15.162245 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m20:26:15.189785 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m20:26:15.197153 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m20:26:15.226677 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:26:15.228205 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m20:26:15.229405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:15.316637 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m20:26:15.318062 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:26:15.319306 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."dev"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."dev"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m20:26:15.326847 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:26:15.333321 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:26:15.335229 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."dev"."int_trips_unioned" rename to "int_trips_unioned__dbt_backup"
[0m20:26:15.337760 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:15.344186 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:26:15.345842 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m20:26:15.348042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:15.350969 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:26:15.352292 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:26:15.353649 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:26:15.372475 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:26:15.378055 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:26:15.379476 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."dev"."int_trips_unioned__dbt_backup" cascade
[0m20:26:15.387020 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:26:15.391443 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m20:26:26.341275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e87f06390>]}
[0m20:26:26.343386 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dev.int_trips_unioned ......................... [[32mOK[0m in 11.19s]
[0m20:26:26.345583 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m20:26:26.349230 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m20:26:26.350941 [info ] [Thread-1 (]: 5 of 8 START sql view model dev.int_trips ...................................... [RUN]
[0m20:26:26.353175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now model.dbt_project.int_trips)
[0m20:26:26.354855 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m20:26:26.399378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m20:26:26.428164 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m20:26:26.440741 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m20:26:26.466555 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:26:26.468981 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m20:26:26.470669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:26.560352 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:26:26.561955 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:26:26.563979 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:26:26.573968 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:26:26.583178 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:26:26.587179 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."dev"."int_trips" rename to "int_trips__dbt_backup"
[0m20:26:26.591171 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:26:26.598950 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:26:26.601638 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" rename to "int_trips"
[0m20:26:26.605632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:26.609799 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:26:26.611706 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:26:26.613443 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:26:26.631908 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:26:26.644606 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:26:26.646501 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."dev"."int_trips__dbt_backup" cascade
[0m20:26:26.655595 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:26:26.661282 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m20:26:36.866143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e4bc4ecf0>]}
[0m20:26:36.872511 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dev.int_trips ................................. [[32mOK[0m in 10.51s]
[0m20:26:36.889511 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m20:26:36.896116 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m20:26:36.907825 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dev.fct_trips ............................... [RUN]
[0m20:26:36.928260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now model.dbt_project.fct_trips)
[0m20:26:36.941483 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_trips
[0m20:26:37.015502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_trips"
[0m20:26:37.072159 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_trips
[0m20:26:37.323539 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:26:37.326275 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


  -- Only process new trips based on pickup datetime
  where trips.pickup_datetime > (select max(pickup_datetime) from "taxi_rides_ny"."dev"."fct_trips")

    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:26:37.328926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:37.505293 [debug] [Thread-1 (]: SQL status: OK in 0.176 seconds
[0m20:26:37.578062 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m20:26:37.589683 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:26:37.592441 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as TEXT)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as TEXT)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as TEXT)
 as pickup_borough, 
      
    cast(null as TEXT)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as TEXT)
 as dropoff_borough, 
      
    cast(null as TEXT)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as TEXT)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as TEXT)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:26:37.599180 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:26:37.641456 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:26:37.644054 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

    
  
    
    
      
    

    create temporary table
      "fct_trips__dbt_tmp20260220202637210270"
  
    as (
      

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


  -- Only process new trips based on pickup datetime
  where trips.pickup_datetime > (select max(pickup_datetime) from "taxi_rides_ny"."dev"."fct_trips")

    );
  
  
  
[0m20:26:58.707375 [debug] [Thread-1 (]: SQL status: OK in 21.051 seconds
[0m20:26:58.753890 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:26:58.757100 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: BEGIN
[0m20:26:58.761532 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:26:58.763259 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:26:58.764999 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips__dbt_tmp20260220202637210270'
      
      
      order by ordinal_position

  
[0m20:26:58.810196 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m20:26:58.830963 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:26:58.832885 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips'
      
      and table_schema = 'dev'
      
      
      and table_catalog = 'taxi_rides_ny'
      
      order by ordinal_position

  
[0m20:26:58.846555 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:26:58.911699 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:26:58.914295 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips__dbt_tmp20260220202637210270'
      
      
      order by ordinal_position

  
[0m20:26:58.924448 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:26:58.935338 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:26:58.937754 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips'
      
      and table_schema = 'dev'
      
      
      and table_catalog = 'taxi_rides_ny'
      
      order by ordinal_position

  
[0m20:26:58.950745 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:26:59.068706 [debug] [Thread-1 (]: 
    In "taxi_rides_ny"."dev"."fct_trips":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:26:59.161731 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_trips"
[0m20:26:59.205734 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:26:59.209723 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

        
            delete from "taxi_rides_ny"."dev"."fct_trips"
            where (
                trip_id) in (
                select (trip_id)
                from "fct_trips__dbt_tmp20260220202637210270"
            );

        
    

    insert into "taxi_rides_ny"."dev"."fct_trips" ("trip_id", "vendor_id", "service_type", "rate_code_id", "pickup_location_id", "pickup_borough", "pickup_zone", "dropoff_location_id", "dropoff_borough", "dropoff_zone", "pickup_datetime", "dropoff_datetime", "store_and_fwd_flag", "passenger_count", "trip_distance", "trip_type", "trip_duration_minutes", "fare_amount", "extra", "mta_tax", "tip_amount", "tolls_amount", "ehail_fee", "improvement_surcharge", "total_amount", "payment_type", "payment_type_description")
    (
        select "trip_id", "vendor_id", "service_type", "rate_code_id", "pickup_location_id", "pickup_borough", "pickup_zone", "dropoff_location_id", "dropoff_borough", "dropoff_zone", "pickup_datetime", "dropoff_datetime", "store_and_fwd_flag", "passenger_count", "trip_distance", "trip_type", "trip_duration_minutes", "fare_amount", "extra", "mta_tax", "tip_amount", "tolls_amount", "ehail_fee", "improvement_surcharge", "total_amount", "payment_type", "payment_type_description"
        from "fct_trips__dbt_tmp20260220202637210270"
    )
  
[0m20:26:59.268708 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m20:26:59.275822 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m20:26:59.308709 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:26:59.327619 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m20:26:59.345613 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:26:59.350239 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: Close
[0m20:26:59.900625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e8cc81df0>]}
[0m20:26:59.903342 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model dev.fct_trips .......................... [[32mOK[0m in 22.97s]
[0m20:26:59.905824 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m20:26:59.909999 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m20:26:59.911684 [info ] [Thread-1 (]: 7 of 8 START sql view model dev.dim_vendors .................................... [RUN]
[0m20:26:59.913474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fct_trips, now model.dbt_project.dim_vendors)
[0m20:26:59.915681 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_vendors
[0m20:26:59.933067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_vendors"
[0m20:26:59.967996 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_vendors
[0m20:26:59.977979 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_vendors"
[0m20:27:00.018332 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:27:00.020333 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: BEGIN
[0m20:27:00.022113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:00.120091 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m20:27:00.121606 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:27:00.123059 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */

  
  create view "taxi_rides_ny"."dev"."dim_vendors__dbt_tmp" as (
    -- Dimension table for taxi technology vendors
-- Small static dimension defining vendor codes and their company names

with trips as (
    select * from "taxi_rides_ny"."dev"."fct_trips"
),

vendors as (
    select distinct
        vendor_id,
        



case vendor_id
    
    when 1 then 'Creative Mobile Technologies'
    
    when 2 then 'VeriFone Inc.'
    
    when 4 then 'Unknown/Other'
    
end

 as vendor_name
    from trips
)

select * from vendors
  );

[0m20:27:00.126640 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:27:00.135780 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:27:00.137205 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */
alter view "taxi_rides_ny"."dev"."dim_vendors" rename to "dim_vendors__dbt_backup"
[0m20:27:00.139547 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:27:00.147470 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:27:00.148830 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */
alter view "taxi_rides_ny"."dev"."dim_vendors__dbt_tmp" rename to "dim_vendors"
[0m20:27:00.151339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:27:00.154456 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: COMMIT
[0m20:27:00.155843 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:27:00.160856 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: COMMIT
[0m20:27:00.176813 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:27:00.182605 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:27:00.183904 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */
drop view if exists "taxi_rides_ny"."dev"."dim_vendors__dbt_backup" cascade
[0m20:27:00.190723 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:27:00.194077 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: Close
[0m20:27:03.543993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e4bce80e0>]}
[0m20:27:03.546433 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dev.dim_vendors ............................... [[32mOK[0m in 3.63s]
[0m20:27:03.551137 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m20:27:03.552722 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m20:27:03.554700 [info ] [Thread-1 (]: 8 of 8 START sql view model dev.fct_monthly_zone_revenue ....................... [RUN]
[0m20:27:03.556775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_vendors, now model.dbt_project.fct_monthly_zone_revenue)
[0m20:27:03.558402 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_monthly_zone_revenue
[0m20:27:03.570043 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_monthly_zone_revenue"
[0m20:27:03.600662 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_monthly_zone_revenue
[0m20:27:03.611710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_monthly_zone_revenue"
[0m20:27:03.642124 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:27:03.643539 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: BEGIN
[0m20:27:03.644793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:03.779938 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m20:27:03.781930 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:27:03.783591 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */

  
  create view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" as (
    -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime)
     as revenue_month,
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."dev"."fct_trips"
group by pickup_zone, revenue_month, service_type
  );

[0m20:27:03.788176 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:27:03.802575 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:27:03.804302 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
alter view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue" rename to "fct_monthly_zone_revenue__dbt_backup"
[0m20:27:03.807465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:27:03.821645 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:27:03.824250 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
alter view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" rename to "fct_monthly_zone_revenue"
[0m20:27:03.828495 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:27:03.834356 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: COMMIT
[0m20:27:03.837548 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:27:03.839629 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: COMMIT
[0m20:27:03.859035 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:27:03.868625 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:27:03.870608 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
drop view if exists "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_backup" cascade
[0m20:27:03.878018 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:27:03.883080 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: Close
[0m20:27:05.744168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dffa6b1a-df39-479f-ad52-6eab7793e186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e4bc19670>]}
[0m20:27:05.749032 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dev.fct_monthly_zone_revenue .................. [[32mOK[0m in 2.19s]
[0m20:27:05.751674 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m20:27:05.758034 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:05.759653 [debug] [MainThread]: On master: BEGIN
[0m20:27:05.761351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:05.862478 [debug] [MainThread]: SQL status: OK in 0.101 seconds
[0m20:27:05.864152 [debug] [MainThread]: On master: COMMIT
[0m20:27:05.865815 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:05.867046 [debug] [MainThread]: On master: COMMIT
[0m20:27:05.869291 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:27:05.870447 [debug] [MainThread]: On master: Close
[0m20:27:05.886932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:05.888606 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m20:27:05.890099 [debug] [MainThread]: Connection 'model.dbt_project.fct_monthly_zone_revenue' was properly closed.
[0m20:27:05.891635 [info ] [MainThread]: 
[0m20:27:05.893566 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 1 minutes and 21.27 seconds (81.27s).
[0m20:27:05.906038 [debug] [MainThread]: Command end result
[0m20:27:06.176467 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:27:06.203134 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:27:06.248483 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:27:06.250544 [info ] [MainThread]: 
[0m20:27:06.252477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:06.254613 [info ] [MainThread]: 
[0m20:27:06.257026 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m20:27:06.261925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 88.1356, "process_in_blocks": "0", "process_kernel_time": 63.450294, "process_mem_max_rss": "3574124", "process_out_blocks": "0", "process_user_time": 260.97604}
[0m20:27:06.265634 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:06.265017 after 88.14 seconds
[0m20:27:06.267967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e964625a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e4bc6ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e96e52360>]}
[0m20:27:06.270305 [debug] [MainThread]: Flushing usage events
[0m20:27:07.115341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:22.904689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adbe268860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adbe2180e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adbdbf6030>]}


============================== 20:38:22.917396 | 21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c ==============================
[0m20:38:22.917396 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:38:22.918864 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'warn_error': 'None', 'no_print': 'None', 'empty': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run -s +fct_monthly_zone_revenue+', 'log_format': 'default', 'log_path': '/usr/app/logs', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m20:38:23.352050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adbd870e90>]}
[0m20:38:23.483341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adbdf3eae0>]}
[0m20:38:23.485292 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:38:23.745309 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:38:27.066286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:38:27.067641 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:38:27.068828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:38:27.149691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adbdbf7f20>]}
[0m20:38:27.375254 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:38:27.391521 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:38:27.445565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb48ec3e0>]}
[0m20:38:27.446920 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:38:27.447948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb5b339e0>]}
[0m20:38:27.451652 [info ] [MainThread]: 
[0m20:38:27.452502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:38:27.453572 [info ] [MainThread]: 
[0m20:38:27.455187 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:38:27.463309 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:38:27.524424 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:38:27.526207 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:38:27.527215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:27.607487 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m20:38:27.611996 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:38:27.620296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m20:38:27.621856 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m20:38:27.632251 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:38:27.633434 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:38:27.634405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:27.721989 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m20:38:27.725479 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:38:27.726634 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m20:38:27.728326 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:38:27.729405 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:38:27.730458 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m20:38:27.732187 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:38:27.733956 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:38:27.735124 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:38:27.736249 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:38:27.737955 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:38:27.739171 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m20:38:27.750784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m20:38:27.761400 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:38:27.762694 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m20:38:27.763662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:27.836453 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m20:38:27.837507 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:38:27.838542 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:38:27.864474 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m20:38:27.867306 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m20:38:27.869493 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m20:38:27.870386 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m20:38:27.878688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb4418c50>]}
[0m20:38:27.880035 [debug] [MainThread]: Using duckdb connection "master"
[0m20:38:27.881184 [debug] [MainThread]: On master: BEGIN
[0m20:38:27.882192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:27.956088 [debug] [MainThread]: SQL status: OK in 0.074 seconds
[0m20:38:27.957269 [debug] [MainThread]: On master: COMMIT
[0m20:38:27.958223 [debug] [MainThread]: Using duckdb connection "master"
[0m20:38:27.959196 [debug] [MainThread]: On master: COMMIT
[0m20:38:27.961062 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:38:27.962315 [debug] [MainThread]: On master: Close
[0m20:38:27.975474 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m20:38:27.977128 [info ] [Thread-1 (]: 1 of 7 START sql view model dev.dim_zones ...................................... [RUN]
[0m20:38:27.978579 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m20:38:27.979467 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m20:38:27.996359 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m20:38:28.026488 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m20:38:28.078942 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m20:38:28.110006 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:38:28.111141 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m20:38:28.112542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:38:28.205388 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m20:38:28.206872 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:38:28.208332 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m20:38:28.210692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:38:28.222249 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:38:28.223459 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones" rename to "dim_zones__dbt_backup"
[0m20:38:28.225879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:38:28.230981 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:38:28.232387 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m20:38:28.234564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:38:28.265580 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:38:28.267690 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:38:28.269274 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:38:28.288075 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:38:28.297527 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:38:28.299128 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."dev"."dim_zones__dbt_backup" cascade
[0m20:38:28.307355 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:38:28.311428 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m20:38:29.011875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adc04e0140>]}
[0m20:38:29.013925 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dev.dim_zones ................................. [[32mOK[0m in 1.03s]
[0m20:38:29.015651 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m20:38:29.017218 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m20:38:29.018590 [info ] [Thread-1 (]: 2 of 7 START sql view model dev.stg_green_tripdata ............................. [RUN]
[0m20:38:29.020051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.stg_green_tripdata)
[0m20:38:29.021530 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m20:38:29.035274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m20:38:29.066876 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m20:38:29.077107 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m20:38:29.107928 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:38:29.109553 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m20:38:29.111048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:29.205228 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m20:38:29.206768 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:38:29.208488 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:38:29.212897 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:38:29.219340 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:38:29.220566 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m20:38:29.222826 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:38:29.232049 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:38:29.233437 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m20:38:29.235936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:38:29.239527 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:38:29.242709 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:38:29.244466 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:38:29.262224 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:38:29.267777 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:38:29.269168 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_backup" cascade
[0m20:38:29.278245 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:38:29.282156 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m20:38:30.482991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb4702330>]}
[0m20:38:30.485501 [info ] [Thread-1 (]: 2 of 7 OK created sql view model dev.stg_green_tripdata ........................ [[32mOK[0m in 1.46s]
[0m20:38:30.487992 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m20:38:30.490146 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m20:38:30.492773 [info ] [Thread-1 (]: 3 of 7 START sql view model dev.stg_yellow_tripdata ............................ [RUN]
[0m20:38:30.495155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m20:38:30.497295 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m20:38:30.507041 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m20:38:30.535428 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m20:38:30.545837 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m20:38:30.571835 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:38:30.573370 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m20:38:30.576333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:30.670383 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m20:38:30.672297 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:38:30.675219 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:38:30.682280 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:38:30.690187 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:38:30.691882 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m20:38:30.694609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:38:30.702892 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:38:30.704908 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m20:38:30.708766 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:38:30.712494 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:38:30.714220 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:38:30.715817 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:38:30.741032 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m20:38:30.747497 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:38:30.749404 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_backup" cascade
[0m20:38:30.759049 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:38:30.763300 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m20:38:31.692960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb4441b50>]}
[0m20:38:31.695312 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dev.stg_yellow_tripdata ....................... [[32mOK[0m in 1.20s]
[0m20:38:31.697669 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m20:38:31.699775 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m20:38:31.701430 [info ] [Thread-1 (]: 4 of 7 START sql view model dev.int_trips_unioned .............................. [RUN]
[0m20:38:31.702953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now model.dbt_project.int_trips_unioned)
[0m20:38:31.704565 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m20:38:31.715307 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m20:38:31.749289 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m20:38:31.852880 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m20:38:31.882148 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:38:31.883717 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m20:38:31.885119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:31.995079 [debug] [Thread-1 (]: SQL status: OK in 0.110 seconds
[0m20:38:31.997415 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:38:31.999822 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."dev"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."dev"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m20:38:32.004997 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:38:32.013121 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:38:32.014972 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."dev"."int_trips_unioned" rename to "int_trips_unioned__dbt_backup"
[0m20:38:32.017638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:38:32.024422 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:38:32.025886 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m20:38:32.028579 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:38:32.031662 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:38:32.033010 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:38:32.034211 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:38:32.056297 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m20:38:32.062587 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:38:32.064226 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."dev"."int_trips_unioned__dbt_backup" cascade
[0m20:38:32.071948 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:38:32.076964 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m20:38:32.973008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb4442000>]}
[0m20:38:32.975359 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dev.int_trips_unioned ......................... [[32mOK[0m in 1.27s]
[0m20:38:32.977745 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m20:38:32.981117 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m20:38:32.982807 [info ] [Thread-1 (]: 5 of 7 START sql view model dev.int_trips ...................................... [RUN]
[0m20:38:32.984448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now model.dbt_project.int_trips)
[0m20:38:32.985827 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m20:38:33.024342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m20:38:33.054432 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m20:38:33.067217 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m20:38:33.097581 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:38:33.099034 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m20:38:33.100398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:33.204879 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m20:38:33.206858 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:38:33.208604 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:38:33.216967 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:38:33.224062 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:38:33.225777 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."dev"."int_trips" rename to "int_trips__dbt_backup"
[0m20:38:33.228093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:38:33.237786 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:38:33.239559 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" rename to "int_trips"
[0m20:38:33.242073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:38:33.245411 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:38:33.247241 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:38:33.248621 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:38:33.268175 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m20:38:33.274667 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:38:33.276107 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."dev"."int_trips__dbt_backup" cascade
[0m20:38:33.283702 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:38:33.287709 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m20:38:34.233967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb44e9c10>]}
[0m20:38:34.236994 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dev.int_trips ................................. [[32mOK[0m in 1.25s]
[0m20:38:34.248088 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m20:38:34.252298 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m20:38:34.254790 [info ] [Thread-1 (]: 6 of 7 START sql incremental model dev.fct_trips ............................... [RUN]
[0m20:38:34.257005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now model.dbt_project.fct_trips)
[0m20:38:34.258844 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_trips
[0m20:38:34.323790 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_trips"
[0m20:38:34.500737 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_trips
[0m20:38:34.710739 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:38:34.716724 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


  -- Only process new trips based on pickup datetime
  where trips.pickup_datetime > (select max(pickup_datetime) from "taxi_rides_ny"."dev"."fct_trips")

    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:38:34.719822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:34.937778 [debug] [Thread-1 (]: SQL status: OK in 0.217 seconds
[0m20:38:35.022725 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m20:38:35.027357 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:38:35.033608 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as TEXT)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as TEXT)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as TEXT)
 as pickup_borough, 
      
    cast(null as TEXT)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as TEXT)
 as dropoff_borough, 
      
    cast(null as TEXT)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as TEXT)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as TEXT)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:38:35.041227 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:38:35.085732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:38:35.089103 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

    
  
    
    
      
    

    create temporary table
      "fct_trips__dbt_tmp20260220203834600314"
  
    as (
      

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


  -- Only process new trips based on pickup datetime
  where trips.pickup_datetime > (select max(pickup_datetime) from "taxi_rides_ny"."dev"."fct_trips")

    );
  
  
  
[0m20:39:01.923520 [debug] [Thread-1 (]: SQL status: OK in 26.828 seconds
[0m20:39:01.978015 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:39:01.980758 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: BEGIN
[0m20:39:01.995191 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:39:01.999562 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:39:02.002691 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips__dbt_tmp20260220203834600314'
      
      
      order by ordinal_position

  
[0m20:39:02.089594 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m20:39:02.155553 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:39:02.161327 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips'
      
      and table_schema = 'dev'
      
      
      and table_catalog = 'taxi_rides_ny'
      
      order by ordinal_position

  
[0m20:39:02.293668 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m20:39:02.427633 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:39:02.431221 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips__dbt_tmp20260220203834600314'
      
      
      order by ordinal_position

  
[0m20:39:02.456733 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:39:02.481175 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:39:02.484958 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fct_trips'
      
      and table_schema = 'dev'
      
      
      and table_catalog = 'taxi_rides_ny'
      
      order by ordinal_position

  
[0m20:39:02.519581 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m20:39:02.601430 [debug] [Thread-1 (]: 
    In "taxi_rides_ny"."dev"."fct_trips":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:39:02.714792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_trips"
[0m20:39:02.753092 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:39:02.756433 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

        
            delete from "taxi_rides_ny"."dev"."fct_trips"
            where (
                trip_id) in (
                select (trip_id)
                from "fct_trips__dbt_tmp20260220203834600314"
            );

        
    

    insert into "taxi_rides_ny"."dev"."fct_trips" ("trip_id", "vendor_id", "service_type", "rate_code_id", "pickup_location_id", "pickup_borough", "pickup_zone", "dropoff_location_id", "dropoff_borough", "dropoff_zone", "pickup_datetime", "dropoff_datetime", "store_and_fwd_flag", "passenger_count", "trip_distance", "trip_type", "trip_duration_minutes", "fare_amount", "extra", "mta_tax", "tip_amount", "tolls_amount", "ehail_fee", "improvement_surcharge", "total_amount", "payment_type", "payment_type_description")
    (
        select "trip_id", "vendor_id", "service_type", "rate_code_id", "pickup_location_id", "pickup_borough", "pickup_zone", "dropoff_location_id", "dropoff_borough", "dropoff_zone", "pickup_datetime", "dropoff_datetime", "store_and_fwd_flag", "passenger_count", "trip_distance", "trip_type", "trip_duration_minutes", "fare_amount", "extra", "mta_tax", "tip_amount", "tolls_amount", "ehail_fee", "improvement_surcharge", "total_amount", "payment_type", "payment_type_description"
        from "fct_trips__dbt_tmp20260220203834600314"
    )
  
[0m20:39:02.800358 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m20:39:02.814293 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m20:39:02.816844 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:39:02.827080 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m20:39:02.832102 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:39:02.845518 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: Close
[0m20:39:03.667882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb409fa40>]}
[0m20:39:03.672823 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model dev.fct_trips .......................... [[32mOK[0m in 29.41s]
[0m20:39:03.676011 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m20:39:03.680739 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m20:39:03.683261 [info ] [Thread-1 (]: 7 of 7 START sql view model dev.fct_monthly_zone_revenue ....................... [RUN]
[0m20:39:03.685460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fct_trips, now model.dbt_project.fct_monthly_zone_revenue)
[0m20:39:03.691705 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_monthly_zone_revenue
[0m20:39:03.713115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_monthly_zone_revenue"
[0m20:39:03.751552 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_monthly_zone_revenue
[0m20:39:03.768372 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_monthly_zone_revenue"
[0m20:39:03.810043 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:39:03.812245 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: BEGIN
[0m20:39:03.814403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:04.032101 [debug] [Thread-1 (]: SQL status: OK in 0.218 seconds
[0m20:39:04.035621 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:39:04.045609 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */

  
  create view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" as (
    -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime)
     as revenue_month,
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."dev"."fct_trips"
group by pickup_zone, revenue_month, service_type
  );

[0m20:39:04.059324 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:39:04.080118 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:39:04.084225 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
alter view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue" rename to "fct_monthly_zone_revenue__dbt_backup"
[0m20:39:04.089718 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:39:04.107617 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:39:04.110173 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
alter view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" rename to "fct_monthly_zone_revenue"
[0m20:39:04.114475 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:39:04.123718 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: COMMIT
[0m20:39:04.126442 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:39:04.128162 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: COMMIT
[0m20:39:04.156794 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m20:39:04.178154 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:39:04.181289 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
drop view if exists "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_backup" cascade
[0m20:39:04.195230 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:39:04.202539 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: Close
[0m20:39:06.535476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a43aa8-e8eb-4b37-9727-fc47c3c8ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb4114920>]}
[0m20:39:06.554160 [info ] [Thread-1 (]: 7 of 7 OK created sql view model dev.fct_monthly_zone_revenue .................. [[32mOK[0m in 2.85s]
[0m20:39:06.578451 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m20:39:06.601369 [debug] [MainThread]: Using duckdb connection "master"
[0m20:39:06.627260 [debug] [MainThread]: On master: BEGIN
[0m20:39:06.646592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:07.012617 [debug] [MainThread]: SQL status: OK in 0.366 seconds
[0m20:39:07.023069 [debug] [MainThread]: On master: COMMIT
[0m20:39:07.026425 [debug] [MainThread]: Using duckdb connection "master"
[0m20:39:07.028599 [debug] [MainThread]: On master: COMMIT
[0m20:39:07.039671 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m20:39:07.041943 [debug] [MainThread]: On master: Close
[0m20:39:07.066985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:07.073931 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m20:39:07.075889 [debug] [MainThread]: Connection 'model.dbt_project.fct_monthly_zone_revenue' was properly closed.
[0m20:39:07.080312 [info ] [MainThread]: 
[0m20:39:07.085906 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 39.62 seconds (39.62s).
[0m20:39:07.106606 [debug] [MainThread]: Command end result
[0m20:39:07.558284 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:39:07.583472 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:39:07.653439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:39:07.656282 [info ] [MainThread]: 
[0m20:39:07.660379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:07.669265 [info ] [MainThread]: 
[0m20:39:07.673799 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m20:39:07.683936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 44.94388, "process_in_blocks": "0", "process_kernel_time": 51.151356, "process_mem_max_rss": "3416244", "process_out_blocks": "0", "process_user_time": 135.51872}
[0m20:39:07.689354 [debug] [MainThread]: Command `dbt run` succeeded at 20:39:07.688784 after 44.95 seconds
[0m20:39:07.691790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb4a1c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adc202e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75adb445d400>]}
[0m20:39:07.699831 [debug] [MainThread]: Flushing usage events
[0m20:39:08.992644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:11.608204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95d020f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95cd6f1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95cd6f0cb0>]}


============================== 20:41:11.622071 | a7903f61-64b9-4d2c-a70e-fbf2b99e4e9e ==============================
[0m20:41:11.622071 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:41:11.623986 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/usr/app/logs', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --full-refresh -s fct_trips', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m20:41:12.088284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7903f61-64b9-4d2c-a70e-fbf2b99e4e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95cdadd3d0>]}
[0m20:41:12.214489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7903f61-64b9-4d2c-a70e-fbf2b99e4e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95cfd28860>]}
[0m20:41:12.216858 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:41:12.494890 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:41:15.793519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:15.795059 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:41:15.796665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:15.990296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7903f61-64b9-4d2c-a70e-fbf2b99e4e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95c57213d0>]}
[0m20:41:16.281477 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:41:16.299948 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:41:16.372243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7903f61-64b9-4d2c-a70e-fbf2b99e4e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95c457a030>]}
[0m20:41:16.374136 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:41:16.375443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7903f61-64b9-4d2c-a70e-fbf2b99e4e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95c43c43b0>]}
[0m20:41:16.379708 [info ] [MainThread]: 
[0m20:41:16.380833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:16.382036 [info ] [MainThread]: 
[0m20:41:16.383811 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:41:16.387786 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:41:16.470762 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:41:16.472226 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:41:16.473780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:16.563846 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m20:41:16.567230 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:41:16.577577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m20:41:16.578991 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m20:41:16.594069 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:41:16.595312 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:41:16.597016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:16.675249 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m20:41:16.678396 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:41:16.679756 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m20:41:16.681710 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:16.682645 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:41:16.683678 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m20:41:16.685458 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:16.687677 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:41:16.688697 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:41:16.689618 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:41:16.691294 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:16.692209 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m20:41:16.709593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m20:41:16.722855 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:41:16.724077 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m20:41:16.725126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:16.812313 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m20:41:16.813454 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:41:16.814495 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:41:16.841475 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m20:41:16.844940 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m20:41:16.847803 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m20:41:16.849380 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m20:41:16.859802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7903f61-64b9-4d2c-a70e-fbf2b99e4e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95cfd28bf0>]}
[0m20:41:16.861443 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:16.862731 [debug] [MainThread]: On master: BEGIN
[0m20:41:16.863820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:16.954830 [debug] [MainThread]: SQL status: OK in 0.091 seconds
[0m20:41:16.956687 [debug] [MainThread]: On master: COMMIT
[0m20:41:16.957919 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:16.959155 [debug] [MainThread]: On master: COMMIT
[0m20:41:16.960941 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:16.962212 [debug] [MainThread]: On master: Close
[0m20:41:16.978601 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m20:41:16.980245 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.fct_trips ............................... [RUN]
[0m20:41:16.981816 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.fct_trips'
[0m20:41:16.982939 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_trips
[0m20:41:17.021042 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_trips"
[0m20:41:17.053890 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_trips
[0m20:41:17.199589 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:41:17.201894 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:41:17.203990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:41:17.293677 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:41:17.335764 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m20:41:17.339378 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:41:17.341105 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as TEXT)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as TEXT)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as TEXT)
 as pickup_borough, 
      
    cast(null as TEXT)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as TEXT)
 as dropoff_borough, 
      
    cast(null as TEXT)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as TEXT)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as TEXT)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:41:17.346246 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:41:17.402113 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_trips"
[0m20:41:17.429538 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:41:17.431135 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: BEGIN
[0m20:41:17.433539 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:17.434931 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:41:17.437023 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."dev"."fct_trips__dbt_tmp"
  
  (
    trip_id TEXT,
    vendor_id integer,
    service_type TEXT,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough TEXT,
    pickup_zone TEXT,
    dropoff_location_id integer,
    dropoff_borough TEXT,
    dropoff_zone TEXT,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag TEXT,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description TEXT
    
    )
 ;
    insert into "taxi_rides_ny"."dev"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m20:41:55.267175 [debug] [Thread-1 (]: SQL status: OK in 37.836 seconds
[0m20:41:55.296757 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:41:55.299068 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
alter table "taxi_rides_ny"."dev"."fct_trips" rename to "fct_trips__dbt_backup"
[0m20:41:55.305298 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:41:55.316226 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:41:55.318126 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
alter table "taxi_rides_ny"."dev"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m20:41:55.321004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:55.367506 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m20:41:55.369503 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:41:55.371068 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m20:41:56.552365 [debug] [Thread-1 (]: SQL status: OK in 1.180 seconds
[0m20:41:56.562516 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:41:56.564058 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
drop table if exists "taxi_rides_ny"."dev"."fct_trips__dbt_backup" cascade
[0m20:41:56.584437 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m20:41:56.590326 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: Close
[0m20:41:57.510372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7903f61-64b9-4d2c-a70e-fbf2b99e4e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95cd3231a0>]}
[0m20:41:57.513186 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.fct_trips .......................... [[32mOK[0m in 40.52s]
[0m20:41:57.515941 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m20:41:57.523392 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:57.524909 [debug] [MainThread]: On master: BEGIN
[0m20:41:57.526299 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:57.631488 [debug] [MainThread]: SQL status: OK in 0.105 seconds
[0m20:41:57.632902 [debug] [MainThread]: On master: COMMIT
[0m20:41:57.634052 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:57.635170 [debug] [MainThread]: On master: COMMIT
[0m20:41:57.637060 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:57.638494 [debug] [MainThread]: On master: Close
[0m20:41:57.646350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:57.647590 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m20:41:57.648714 [debug] [MainThread]: Connection 'model.dbt_project.fct_trips' was properly closed.
[0m20:41:57.650217 [info ] [MainThread]: 
[0m20:41:57.651357 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 41.27 seconds (41.27s).
[0m20:41:57.653742 [debug] [MainThread]: Command end result
[0m20:41:57.916792 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:41:57.935735 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:41:57.967235 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:41:57.968604 [info ] [MainThread]: 
[0m20:41:57.970452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:57.972099 [info ] [MainThread]: 
[0m20:41:57.973419 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:41:57.976737 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 46.58214, "process_in_blocks": "0", "process_kernel_time": 40.989563, "process_mem_max_rss": "3561008", "process_out_blocks": "0", "process_user_time": 203.49863}
[0m20:41:57.978172 [debug] [MainThread]: Command `dbt run` succeeded at 20:41:57.977927 after 46.58 seconds
[0m20:41:57.979377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95cd95b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95c55f38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b95c55f3950>]}
[0m20:41:57.980709 [debug] [MainThread]: Flushing usage events
[0m20:41:58.650558 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:58.500220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d0e33f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d0c0e4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d0bac4b00>]}


============================== 20:42:58.519877 | 782aefe9-984b-42b3-b3cc-8fad162704f4 ==============================
[0m20:42:58.519877 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:42:58.522428 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error': 'None', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_cache_events': 'False'}
[0m20:42:59.191434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d0b3384d0>]}
[0m20:42:59.384120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d037594f0>]}
[0m20:42:59.387467 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:42:59.730881 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:43:03.700156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:43:03.701509 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:43:03.702463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:43:03.806111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d037311f0>]}
[0m20:43:04.091080 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:43:04.108408 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:43:04.176317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d024e9370>]}
[0m20:43:04.178591 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:43:04.180078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d03759640>]}
[0m20:43:04.185305 [info ] [MainThread]: 
[0m20:43:04.186765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:43:04.188020 [info ] [MainThread]: 
[0m20:43:04.190055 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:43:04.200619 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:43:04.273967 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:43:04.275480 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:43:04.276734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:04.373104 [debug] [ThreadPool]: SQL status: OK in 0.096 seconds
[0m20:43:04.376865 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:43:04.384280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m20:43:04.386516 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m20:43:04.399431 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:43:04.401145 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:43:04.403745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:04.487557 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m20:43:04.491003 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:43:04.492301 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m20:43:04.493952 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:43:04.495717 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:43:04.497232 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m20:43:04.500478 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:43:04.503186 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:43:04.504342 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m20:43:04.505602 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m20:43:04.507659 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:43:04.510911 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m20:43:04.529168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m20:43:04.542182 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:43:04.543257 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m20:43:04.544201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:04.619458 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m20:43:04.620598 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m20:43:04.621569 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:43:04.644351 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m20:43:04.647814 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m20:43:04.650444 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m20:43:04.651842 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m20:43:04.661535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d0de58950>]}
[0m20:43:04.662743 [debug] [MainThread]: Using duckdb connection "master"
[0m20:43:04.663787 [debug] [MainThread]: On master: BEGIN
[0m20:43:04.664889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:43:04.738656 [debug] [MainThread]: SQL status: OK in 0.074 seconds
[0m20:43:04.740328 [debug] [MainThread]: On master: COMMIT
[0m20:43:04.741750 [debug] [MainThread]: Using duckdb connection "master"
[0m20:43:04.743052 [debug] [MainThread]: On master: COMMIT
[0m20:43:04.744769 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:43:04.746020 [debug] [MainThread]: On master: Close
[0m20:43:04.760356 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m20:43:04.762072 [info ] [Thread-1 (]: 1 of 8 START sql view model dev.dim_zones ...................................... [RUN]
[0m20:43:04.763799 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m20:43:04.765237 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m20:43:04.782628 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m20:43:04.815565 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m20:43:04.879524 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m20:43:04.910842 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:43:04.912330 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m20:43:04.913741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:43:05.021068 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:43:05.022746 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:43:05.024195 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
  );

[0m20:43:05.026485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:43:05.041344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:43:05.043282 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones" rename to "dim_zones__dbt_backup"
[0m20:43:05.046005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:43:05.053996 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:43:05.055530 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m20:43:05.058106 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:43:05.092064 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:43:05.093922 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:43:05.095652 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:43:05.111259 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:43:05.121404 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:43:05.122986 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."dev"."dim_zones__dbt_backup" cascade
[0m20:43:05.131241 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:43:05.137523 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m20:43:05.885069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d0dfb3e90>]}
[0m20:43:05.887555 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dev.dim_zones ................................. [[32mOK[0m in 1.12s]
[0m20:43:05.889796 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m20:43:05.891460 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m20:43:05.893293 [info ] [Thread-1 (]: 2 of 8 START sql view model dev.stg_green_tripdata ............................. [RUN]
[0m20:43:05.895180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.stg_green_tripdata)
[0m20:43:05.896881 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m20:43:05.914268 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m20:43:05.947361 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m20:43:05.960311 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m20:43:05.988714 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:43:05.990364 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m20:43:05.991963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:06.097408 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:43:06.099109 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:43:06.102585 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:43:06.109288 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:43:06.121708 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:43:06.124714 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m20:43:06.129545 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:43:06.147047 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:43:06.150028 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m20:43:06.157970 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:43:06.162549 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:43:06.163994 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:43:06.165921 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:43:06.184470 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:43:06.193563 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:43:06.195164 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_backup" cascade
[0m20:43:06.204256 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:43:06.208133 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m20:43:07.125939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d022504d0>]}
[0m20:43:07.128520 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dev.stg_green_tripdata ........................ [[32mOK[0m in 1.23s]
[0m20:43:07.130622 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m20:43:07.132322 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m20:43:07.134055 [info ] [Thread-1 (]: 3 of 8 START sql view model dev.stg_yellow_tripdata ............................ [RUN]
[0m20:43:07.136258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m20:43:07.138005 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m20:43:07.147375 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m20:43:07.179109 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m20:43:07.191747 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m20:43:07.227109 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:43:07.228983 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m20:43:07.230585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:07.321540 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m20:43:07.323572 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:43:07.326541 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m20:43:07.330412 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:43:07.340109 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:43:07.342046 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m20:43:07.344813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:43:07.353419 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:43:07.355492 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m20:43:07.358555 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:43:07.362549 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:43:07.364200 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:43:07.365872 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:43:07.386035 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m20:43:07.392482 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:43:07.394008 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_backup" cascade
[0m20:43:07.402187 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:43:07.407026 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m20:43:08.782172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d018358e0>]}
[0m20:43:08.786152 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dev.stg_yellow_tripdata ....................... [[32mOK[0m in 1.65s]
[0m20:43:08.788784 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m20:43:08.792113 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m20:43:08.794016 [info ] [Thread-1 (]: 4 of 8 START sql view model dev.int_trips_unioned .............................. [RUN]
[0m20:43:08.796355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now model.dbt_project.int_trips_unioned)
[0m20:43:08.798221 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m20:43:08.813831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m20:43:08.849883 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m20:43:08.982855 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m20:43:09.024040 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:43:09.025928 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m20:43:09.027443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:09.126457 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m20:43:09.128465 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:43:09.130255 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."dev"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."dev"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m20:43:09.138515 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:43:09.147112 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:43:09.148909 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."dev"."int_trips_unioned" rename to "int_trips_unioned__dbt_backup"
[0m20:43:09.157505 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:43:09.174060 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:43:09.176503 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m20:43:09.181257 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:43:09.187858 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:43:09.189993 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:43:09.192125 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:43:09.211680 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m20:43:09.221960 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:43:09.223949 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."dev"."int_trips_unioned__dbt_backup" cascade
[0m20:43:09.232722 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:43:09.240989 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m20:43:10.941482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d01835e50>]}
[0m20:43:10.961254 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dev.int_trips_unioned ......................... [[32mOK[0m in 2.14s]
[0m20:43:10.968046 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m20:43:10.980528 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m20:43:10.990626 [info ] [Thread-1 (]: 5 of 8 START sql view model dev.int_trips ...................................... [RUN]
[0m20:43:10.996985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now model.dbt_project.int_trips)
[0m20:43:11.012496 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m20:43:11.175697 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m20:43:11.229788 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m20:43:11.250531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m20:43:11.289951 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:43:11.292870 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m20:43:11.294557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:11.417244 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m20:43:11.419789 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:43:11.423312 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:43:11.438978 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:43:11.461589 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:43:11.464409 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."dev"."int_trips" rename to "int_trips__dbt_backup"
[0m20:43:11.474565 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:43:11.500385 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:43:11.505224 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."dev"."int_trips__dbt_tmp" rename to "int_trips"
[0m20:43:11.510052 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:43:11.514683 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:43:11.517135 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:43:11.519240 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:43:11.543235 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m20:43:11.556165 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:43:11.559019 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."dev"."int_trips__dbt_backup" cascade
[0m20:43:11.573360 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:43:11.581004 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m20:43:12.889661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d018f17f0>]}
[0m20:43:12.892305 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dev.int_trips ................................. [[32mOK[0m in 1.89s]
[0m20:43:12.894782 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m20:43:12.898539 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m20:43:12.904664 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dev.fct_trips ............................... [RUN]
[0m20:43:12.907117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now model.dbt_project.fct_trips)
[0m20:43:12.908966 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_trips
[0m20:43:12.954015 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_trips"
[0m20:43:12.996253 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_trips
[0m20:43:13.213261 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:43:13.216344 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:43:13.219136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:13.347270 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m20:43:13.428515 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m20:43:13.432402 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:43:13.437105 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as TEXT)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as TEXT)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as TEXT)
 as pickup_borough, 
      
    cast(null as TEXT)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as TEXT)
 as dropoff_borough, 
      
    cast(null as TEXT)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as TEXT)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as TEXT)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:43:13.443048 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:43:13.516612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_trips"
[0m20:43:13.561462 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:43:13.563547 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: BEGIN
[0m20:43:13.567834 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:43:13.571058 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:43:13.573412 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."dev"."fct_trips__dbt_tmp"
  
  (
    trip_id TEXT,
    vendor_id integer,
    service_type TEXT,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough TEXT,
    pickup_zone TEXT,
    dropoff_location_id integer,
    dropoff_borough TEXT,
    dropoff_zone TEXT,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag TEXT,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description TEXT
    
    )
 ;
    insert into "taxi_rides_ny"."dev"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m20:43:58.602453 [debug] [Thread-1 (]: SQL status: OK in 45.058 seconds
[0m20:43:58.616205 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:43:58.618125 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
alter table "taxi_rides_ny"."dev"."fct_trips" rename to "fct_trips__dbt_backup"
[0m20:43:58.622373 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:43:58.633244 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:43:58.634842 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
alter table "taxi_rides_ny"."dev"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m20:43:58.637936 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:43:58.651625 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m20:43:58.653054 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:43:58.654216 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m20:43:59.850956 [debug] [Thread-1 (]: SQL status: OK in 1.194 seconds
[0m20:43:59.861252 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m20:43:59.863282 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_trips"} */
drop table if exists "taxi_rides_ny"."dev"."fct_trips__dbt_backup" cascade
[0m20:43:59.900042 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m20:43:59.916525 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: Close
[0m20:44:01.422601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d0b23eab0>]}
[0m20:44:01.429612 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model dev.fct_trips .......................... [[32mOK[0m in 48.51s]
[0m20:44:01.434911 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m20:44:01.440607 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m20:44:01.446738 [info ] [Thread-1 (]: 7 of 8 START sql view model dev.dim_vendors .................................... [RUN]
[0m20:44:01.451960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fct_trips, now model.dbt_project.dim_vendors)
[0m20:44:01.454263 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_vendors
[0m20:44:01.482256 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_vendors"
[0m20:44:01.520684 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_vendors
[0m20:44:01.533990 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_vendors"
[0m20:44:01.570249 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:44:01.572208 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: BEGIN
[0m20:44:01.574300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:01.708143 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m20:44:01.710745 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:44:01.712410 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */

  
  create view "taxi_rides_ny"."dev"."dim_vendors__dbt_tmp" as (
    -- Dimension table for taxi technology vendors
-- Small static dimension defining vendor codes and their company names

with trips as (
    select * from "taxi_rides_ny"."dev"."fct_trips"
),

vendors as (
    select distinct
        vendor_id,
        



case vendor_id
    
    when 1 then 'Creative Mobile Technologies'
    
    when 2 then 'VeriFone Inc.'
    
    when 4 then 'Unknown/Other'
    
end

 as vendor_name
    from trips
)

select * from vendors
  );

[0m20:44:01.718688 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:44:01.730253 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:44:01.732089 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */
alter view "taxi_rides_ny"."dev"."dim_vendors" rename to "dim_vendors__dbt_backup"
[0m20:44:01.735421 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:44:01.745407 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:44:01.747253 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */
alter view "taxi_rides_ny"."dev"."dim_vendors__dbt_tmp" rename to "dim_vendors"
[0m20:44:01.749650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:44:01.753390 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: COMMIT
[0m20:44:01.755084 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:44:01.756566 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: COMMIT
[0m20:44:01.782815 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m20:44:01.790883 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_vendors"
[0m20:44:01.793747 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_vendors"} */
drop view if exists "taxi_rides_ny"."dev"."dim_vendors__dbt_backup" cascade
[0m20:44:01.801499 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:44:01.805362 [debug] [Thread-1 (]: On model.dbt_project.dim_vendors: Close
[0m20:44:02.822095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d01836ed0>]}
[0m20:44:02.824357 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dev.dim_vendors ............................... [[32mOK[0m in 1.37s]
[0m20:44:02.826689 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m20:44:02.828812 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m20:44:02.830620 [info ] [Thread-1 (]: 8 of 8 START sql view model dev.fct_monthly_zone_revenue ....................... [RUN]
[0m20:44:02.837453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_vendors, now model.dbt_project.fct_monthly_zone_revenue)
[0m20:44:02.839521 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_monthly_zone_revenue
[0m20:44:02.853121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_monthly_zone_revenue"
[0m20:44:02.880340 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_monthly_zone_revenue
[0m20:44:02.897718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_monthly_zone_revenue"
[0m20:44:02.937081 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:44:02.938911 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: BEGIN
[0m20:44:02.940151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:03.028363 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m20:44:03.029909 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:44:03.031788 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */

  
  create view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" as (
    -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime)
     as revenue_month,
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."dev"."fct_trips"
group by pickup_zone, revenue_month, service_type
  );

[0m20:44:03.036929 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:44:03.044493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:44:03.045889 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
alter view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue" rename to "fct_monthly_zone_revenue__dbt_backup"
[0m20:44:03.048840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:44:03.056789 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:44:03.058217 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
alter view "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" rename to "fct_monthly_zone_revenue"
[0m20:44:03.061237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:44:03.068521 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: COMMIT
[0m20:44:03.069996 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:44:03.071364 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: COMMIT
[0m20:44:03.090801 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m20:44:03.096657 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m20:44:03.098149 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
drop view if exists "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_backup" cascade
[0m20:44:03.106416 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:44:03.110230 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: Close
[0m20:44:04.112664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '782aefe9-984b-42b3-b3cc-8fad162704f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d022b9a30>]}
[0m20:44:04.115432 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dev.fct_monthly_zone_revenue .................. [[32mOK[0m in 1.28s]
[0m20:44:04.118762 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m20:44:04.126531 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:04.128151 [debug] [MainThread]: On master: BEGIN
[0m20:44:04.129695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:44:04.230115 [debug] [MainThread]: SQL status: OK in 0.100 seconds
[0m20:44:04.233356 [debug] [MainThread]: On master: COMMIT
[0m20:44:04.235166 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:04.236437 [debug] [MainThread]: On master: COMMIT
[0m20:44:04.239170 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:44:04.240532 [debug] [MainThread]: On master: Close
[0m20:44:04.250553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:04.252238 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m20:44:04.253594 [debug] [MainThread]: Connection 'model.dbt_project.fct_monthly_zone_revenue' was properly closed.
[0m20:44:04.255434 [info ] [MainThread]: 
[0m20:44:04.257468 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 1 minutes and 0.07 seconds (60.07s).
[0m20:44:04.267075 [debug] [MainThread]: Command end result
[0m20:44:04.479881 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:44:04.508892 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:44:04.563897 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:44:04.566863 [info ] [MainThread]: 
[0m20:44:04.569588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:44:04.572061 [info ] [MainThread]: 
[0m20:44:04.574620 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m20:44:04.585352 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 66.38387, "process_in_blocks": "0", "process_kernel_time": 57.100395, "process_mem_max_rss": "3575376", "process_out_blocks": "0", "process_user_time": 254.31339}
[0m20:44:04.588325 [debug] [MainThread]: Command `dbt run` succeeded at 20:44:04.587683 after 66.39 seconds
[0m20:44:04.590998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d0d0f3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d0c238dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9d0e208dd0>]}
[0m20:44:04.592746 [debug] [MainThread]: Flushing usage events
[0m20:44:05.969651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:23.805520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a3ac0440e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a3a8b3d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a3a8b3f7a0>]}


============================== 20:44:23.823511 | de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f ==============================
[0m20:44:23.823511 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:44:23.826150 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt build --target prod', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'profiles_dir': '/root/.dbt', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'log_format': 'default'}
[0m20:44:24.365965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a3a01112e0>]}
[0m20:44:24.512745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a3a7ce6f30>]}
[0m20:44:24.515231 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:44:24.788654 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m20:44:25.130956 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:44:25.132843 [debug] [MainThread]: previous checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, current checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8
[0m20:44:25.134304 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:44:25.136328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a3a862f5c0>]}
[0m20:44:31.991487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a39daa1e50>]}
[0m20:44:32.290183 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:44:32.305866 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:44:32.418608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a39db86960>]}
[0m20:44:32.420027 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:44:32.431423 [info ] [MainThread]: 
[0m20:44:32.432858 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:44:32.434836 [info ] [MainThread]: 
[0m20:44:32.436933 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:44:32.454592 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:44:32.541912 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:44:32.543237 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:44:32.544484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:32.639013 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m20:44:32.644637 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:44:32.657252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m20:44:32.659091 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m20:44:32.675492 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m20:44:32.677214 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:44:32.678754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:32.763472 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m20:44:32.767274 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m20:44:32.768484 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m20:44:32.770133 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:44:32.771082 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m20:44:32.772128 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m20:44:32.774059 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:44:32.780545 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m20:44:32.782463 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m20:44:32.783767 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m20:44:32.785891 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:44:32.786942 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m20:44:32.799181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m20:44:32.811335 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m20:44:32.813424 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m20:44:32.815039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:32.897410 [debug] [ThreadPool]: SQL status: OK in 0.082 seconds
[0m20:44:32.898895 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m20:44:32.900413 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:44:32.929970 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m20:44:32.934335 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m20:44:32.939054 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m20:44:32.940954 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m20:44:32.954539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a39dcd2a20>]}
[0m20:44:32.956702 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:32.958527 [debug] [MainThread]: On master: BEGIN
[0m20:44:32.959574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:33.043256 [debug] [MainThread]: SQL status: OK in 0.084 seconds
[0m20:44:33.044938 [debug] [MainThread]: On master: COMMIT
[0m20:44:33.046519 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:33.048085 [debug] [MainThread]: On master: COMMIT
[0m20:44:33.050256 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:44:33.051252 [debug] [MainThread]: On master: Close
[0m20:44:33.067494 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m20:44:33.069485 [info ] [Thread-1 (]: 1 of 43 START sql view model prod.stg_green_tripdata ........................... [RUN]
[0m20:44:33.071926 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_green_tripdata'
[0m20:44:33.073494 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m20:44:33.102960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m20:44:33.125368 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m20:44:33.207455 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m20:44:33.227622 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:44:33.229074 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m20:44:33.230566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:44:33.319159 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:44:33.320712 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:44:33.322060 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m20:44:33.326085 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:44:33.344235 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:44:33.345989 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m20:44:33.349435 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:44:33.387289 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:44:33.388947 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:44:33.390524 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:44:33.409093 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:44:33.425357 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:44:33.427450 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_backup" cascade
[0m20:44:33.430973 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:44:33.437857 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m20:44:34.510384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a3aa8c44a0>]}
[0m20:44:34.515290 [info ] [Thread-1 (]: 1 of 43 OK created sql view model prod.stg_green_tripdata ...................... [[32mOK[0m in 1.43s]
[0m20:44:34.521173 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m20:44:34.524522 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m20:44:34.528146 [info ] [Thread-1 (]: 2 of 43 START sql view model prod.stg_yellow_tripdata .......................... [RUN]
[0m20:44:34.533954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m20:44:34.538192 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m20:44:34.560064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m20:44:34.593372 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m20:44:34.611172 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m20:44:34.805322 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:44:34.823838 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m20:44:34.838668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:35.016230 [debug] [Thread-1 (]: SQL status: OK in 0.176 seconds
[0m20:44:35.019795 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:44:35.022907 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m20:44:35.036201 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:44:35.059031 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:44:35.062239 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m20:44:35.073075 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:44:35.081775 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:44:35.085108 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:44:35.089245 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:44:35.122327 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m20:44:35.144468 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:44:35.154810 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_backup" cascade
[0m20:44:35.159958 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:44:35.173169 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m20:44:36.168393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a39ceac080>]}
[0m20:44:36.170873 [info ] [Thread-1 (]: 2 of 43 OK created sql view model prod.stg_yellow_tripdata ..................... [[32mOK[0m in 1.63s]
[0m20:44:36.173227 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m20:44:36.175304 [debug] [Thread-1 (]: Began running node seed.dbt_project.payment_type_lookup
[0m20:44:36.177234 [info ] [Thread-1 (]: 3 of 43 START seed file prod.payment_type_lookup ............................... [RUN]
[0m20:44:36.183539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now seed.dbt_project.payment_type_lookup)
[0m20:44:36.186084 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.payment_type_lookup
[0m20:44:36.188029 [debug] [Thread-1 (]: Began executing node seed.dbt_project.payment_type_lookup
[0m20:44:36.290427 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m20:44:36.292163 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: BEGIN
[0m20:44:36.293734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:36.394163 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m20:44:36.396258 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m20:44:36.398593 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "seed.dbt_project.payment_type_lookup"} */

    create table "taxi_rides_ny"."prod"."payment_type_lookup" ("payment_type" integer,"description" text)
  
[0m20:44:36.401821 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:44:36.434902 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m20:44:36.436762 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: 
          COPY "taxi_rides_ny"."prod"."payment_type_lookup" FROM '/usr/app/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:44:36.478064 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m20:44:36.493185 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.payment_type_lookup"
[0m20:44:36.531654 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: COMMIT
[0m20:44:36.534043 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m20:44:36.535916 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: COMMIT
[0m20:44:36.560640 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m20:44:36.564821 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: Close
[0m20:44:37.516753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a39d985cd0>]}
[0m20:44:37.518911 [info ] [Thread-1 (]: 3 of 43 OK loaded seed file prod.payment_type_lookup ........................... [[32mINSERT 7[0m in 1.33s]
[0m20:44:37.521524 [debug] [Thread-1 (]: Finished running node seed.dbt_project.payment_type_lookup
[0m20:44:37.523541 [debug] [Thread-1 (]: Began running node seed.dbt_project.taxi_zone_lookup
[0m20:44:37.525524 [info ] [Thread-1 (]: 4 of 43 START seed file prod.taxi_zone_lookup .................................. [RUN]
[0m20:44:37.527702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_project.payment_type_lookup, now seed.dbt_project.taxi_zone_lookup)
[0m20:44:37.529718 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.taxi_zone_lookup
[0m20:44:37.533131 [debug] [Thread-1 (]: Began executing node seed.dbt_project.taxi_zone_lookup
[0m20:44:37.583708 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m20:44:37.586136 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: BEGIN
[0m20:44:37.587995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:37.701485 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:44:37.703834 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m20:44:37.705751 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "seed.dbt_project.taxi_zone_lookup"} */

    create table "taxi_rides_ny"."prod"."taxi_zone_lookup" ("locationid" integer,"borough" text,"zone" text,"service_zone" text)
  
[0m20:44:37.710424 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:44:37.715571 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m20:44:37.717790 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: 
          COPY "taxi_rides_ny"."prod"."taxi_zone_lookup" FROM '/usr/app/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:44:37.753982 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m20:44:37.756366 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.taxi_zone_lookup"
[0m20:44:37.786425 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: COMMIT
[0m20:44:37.788184 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m20:44:37.789883 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: COMMIT
[0m20:44:37.808505 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:44:37.811995 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: Close
[0m20:44:38.785424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a39cebbb90>]}
[0m20:44:38.787942 [info ] [Thread-1 (]: 4 of 43 OK loaded seed file prod.taxi_zone_lookup .............................. [[32mINSERT 265[0m in 1.26s]
[0m20:44:38.790763 [debug] [Thread-1 (]: Finished running node seed.dbt_project.taxi_zone_lookup
[0m20:44:38.793169 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m20:44:38.795186 [info ] [Thread-1 (]: 5 of 43 START test not_null_stg_green_tripdata_pickup_datetime ................. [RUN]
[0m20:44:38.797031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_project.taxi_zone_lookup, now test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e)
[0m20:44:38.802850 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m20:44:38.836677 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m20:44:38.895759 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m20:44:38.954560 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m20:44:39.002549 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m20:44:39.004053 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: BEGIN
[0m20:44:39.005450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:39.091399 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m20:44:39.093443 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m20:44:39.094917 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."stg_green_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m20:44:39.103270 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:44:39.111298 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: ROLLBACK
[0m20:44:39.114729 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e'
[0m20:44:39.116074 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: Close
[0m20:44:39.142225 [info ] [Thread-1 (]: 5 of 43 PASS not_null_stg_green_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.35s]
[0m20:44:39.144598 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m20:44:39.146202 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m20:44:39.147750 [info ] [Thread-1 (]: 6 of 43 START test not_null_stg_green_tripdata_vendor_id ....................... [RUN]
[0m20:44:39.150433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e, now test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493)
[0m20:44:39.152360 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m20:44:39.164754 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m20:44:39.205895 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m20:44:39.212360 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m20:44:39.236602 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m20:44:39.238662 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: BEGIN
[0m20:44:39.240258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:39.329209 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:44:39.331821 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m20:44:39.333854 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."stg_green_tripdata"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m20:44:39.467968 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m20:44:39.474292 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: ROLLBACK
[0m20:44:39.477242 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493'
[0m20:44:39.479755 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: Close
[0m20:44:39.500013 [info ] [Thread-1 (]: 6 of 43 PASS not_null_stg_green_tripdata_vendor_id ............................. [[32mPASS[0m in 0.35s]
[0m20:44:39.504231 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m20:44:39.506342 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:44:39.507865 [info ] [Thread-1 (]: 7 of 43 START test not_null_stg_yellow_tripdata_pickup_datetime ................ [RUN]
[0m20:44:39.510059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493, now test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44)
[0m20:44:39.512442 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:44:39.526807 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:44:39.559363 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:44:39.566913 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:44:39.593788 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:44:39.596185 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: BEGIN
[0m20:44:39.598066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:39.687229 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:44:39.689118 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:44:39.690482 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m20:44:39.695283 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:44:39.700561 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m20:44:39.704684 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m20:44:39.707055 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m20:44:39.716666 [info ] [Thread-1 (]: 7 of 43 PASS not_null_stg_yellow_tripdata_pickup_datetime ...................... [[32mPASS[0m in 0.21s]
[0m20:44:39.719415 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:44:39.721292 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m20:44:39.723438 [info ] [Thread-1 (]: 8 of 43 START test not_null_stg_yellow_tripdata_vendor_id ...................... [RUN]
[0m20:44:39.725560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44, now test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751)
[0m20:44:39.727375 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m20:44:39.741529 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m20:44:39.776621 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m20:44:39.784073 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m20:44:39.819594 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m20:44:39.821467 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: BEGIN
[0m20:44:39.823475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:39.931602 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m20:44:39.946763 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m20:44:39.954164 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m20:44:42.220882 [debug] [Thread-1 (]: SQL status: OK in 2.263 seconds
[0m20:44:42.226872 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: ROLLBACK
[0m20:44:42.230575 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751'
[0m20:44:42.232510 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: Close
[0m20:44:42.291794 [info ] [Thread-1 (]: 8 of 43 PASS not_null_stg_yellow_tripdata_vendor_id ............................ [[32mPASS[0m in 2.57s]
[0m20:44:42.294603 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m20:44:42.296801 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m20:44:42.299289 [info ] [Thread-1 (]: 9 of 43 START test not_null_payment_type_lookup_payment_type ................... [RUN]
[0m20:44:42.303366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751, now test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4)
[0m20:44:42.305554 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m20:44:42.320664 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m20:44:42.385117 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m20:44:42.392475 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m20:44:42.444799 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m20:44:42.446875 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: BEGIN
[0m20:44:42.449309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:42.540454 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m20:44:42.542285 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m20:44:42.543785 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type
from "taxi_rides_ny"."prod"."payment_type_lookup"
where payment_type is null



  
  
      
    ) dbt_internal_test
[0m20:44:42.547597 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:44:42.553094 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: ROLLBACK
[0m20:44:42.556506 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4'
[0m20:44:42.558124 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: Close
[0m20:44:42.568962 [info ] [Thread-1 (]: 9 of 43 PASS not_null_payment_type_lookup_payment_type ......................... [[32mPASS[0m in 0.27s]
[0m20:44:42.571537 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m20:44:42.573185 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m20:44:42.574647 [info ] [Thread-1 (]: 10 of 43 START test unique_payment_type_lookup_payment_type .................... [RUN]
[0m20:44:42.576565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4, now test.dbt_project.unique_payment_type_lookup_payment_type.819f837245)
[0m20:44:42.578522 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m20:44:42.604033 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m20:44:42.642225 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m20:44:42.648779 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m20:44:42.679732 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m20:44:42.681785 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: BEGIN
[0m20:44:42.683733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:42.790345 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:44:42.792412 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m20:44:42.794078 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."payment_type_lookup"
where payment_type is not null
group by payment_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:44:42.808864 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:44:42.812848 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: ROLLBACK
[0m20:44:42.815560 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_payment_type_lookup_payment_type.819f837245'
[0m20:44:42.818428 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: Close
[0m20:44:42.827659 [info ] [Thread-1 (]: 10 of 43 PASS unique_payment_type_lookup_payment_type .......................... [[32mPASS[0m in 0.25s]
[0m20:44:42.830704 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m20:44:42.832404 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m20:44:42.834540 [info ] [Thread-1 (]: 11 of 43 START sql view model prod.dim_zones ................................... [RUN]
[0m20:44:42.836650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_payment_type_lookup_payment_type.819f837245, now model.dbt_project.dim_zones)
[0m20:44:42.838503 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m20:44:42.846094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m20:44:42.884153 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m20:44:42.892702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m20:44:42.928067 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:44:42.929906 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m20:44:42.931456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:43.023515 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m20:44:43.025258 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:44:43.026806 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."prod"."taxi_zone_lookup"
  );

[0m20:44:43.029543 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:44:43.038114 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:44:43.040077 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m20:44:43.042708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:44:43.046482 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:44:43.048061 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:44:43.049429 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:44:43.065634 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:44:43.072215 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:44:43.073925 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."prod"."dim_zones__dbt_backup" cascade
[0m20:44:43.076359 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:44:43.079807 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m20:44:43.957206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a39ef6f170>]}
[0m20:44:43.959982 [info ] [Thread-1 (]: 11 of 43 OK created sql view model prod.dim_zones .............................. [[32mOK[0m in 1.12s]
[0m20:44:43.962843 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m20:44:43.964930 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m20:44:43.967888 [info ] [Thread-1 (]: 12 of 43 START sql view model prod.int_trips_unioned ........................... [RUN]
[0m20:44:43.971035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.int_trips_unioned)
[0m20:44:43.973015 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m20:44:43.987842 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m20:44:44.024616 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m20:44:44.037927 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m20:44:44.077150 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:44:44.079959 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m20:44:44.081778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:44.187917 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m20:44:44.189966 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:44:44.191401 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."prod"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m20:44:44.197421 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:44:44.209881 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:44:44.211362 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m20:44:44.214356 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:44:44.220341 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:44:44.222220 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:44:44.223487 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:44:44.243339 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m20:44:44.254105 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:44:44.255822 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips_unioned__dbt_backup" cascade
[0m20:44:44.258884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:44:44.263446 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m20:44:45.154987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a39c1186b0>]}
[0m20:44:45.157395 [info ] [Thread-1 (]: 12 of 43 OK created sql view model prod.int_trips_unioned ...................... [[32mOK[0m in 1.18s]
[0m20:44:45.159994 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m20:44:45.161743 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m20:44:45.163113 [info ] [Thread-1 (]: 13 of 43 START test not_null_dim_zones_location_id ............................. [RUN]
[0m20:44:45.165013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79)
[0m20:44:45.169315 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m20:44:45.180275 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m20:44:45.208515 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m20:44:45.215204 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m20:44:45.252527 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m20:44:45.254872 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: BEGIN
[0m20:44:45.256376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:45.338471 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m20:44:45.340640 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m20:44:45.342658 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "taxi_rides_ny"."prod"."dim_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m20:44:45.346731 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:44:45.351598 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: ROLLBACK
[0m20:44:45.354633 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79'
[0m20:44:45.356219 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: Close
[0m20:44:45.364922 [info ] [Thread-1 (]: 13 of 43 PASS not_null_dim_zones_location_id ................................... [[32mPASS[0m in 0.20s]
[0m20:44:45.367321 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m20:44:45.369501 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m20:44:45.371020 [info ] [Thread-1 (]: 14 of 43 START test unique_dim_zones_location_id ............................... [RUN]
[0m20:44:45.372848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79, now test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27)
[0m20:44:45.374148 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m20:44:45.387203 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m20:44:45.415323 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m20:44:45.423247 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m20:44:45.458739 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m20:44:45.460236 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: BEGIN
[0m20:44:45.461727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:45.550963 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m20:44:45.552535 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m20:44:45.553946 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."dim_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:44:45.565377 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:44:45.570162 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: ROLLBACK
[0m20:44:45.573894 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27'
[0m20:44:45.575653 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: Close
[0m20:44:45.587446 [info ] [Thread-1 (]: 14 of 43 PASS unique_dim_zones_location_id ..................................... [[32mPASS[0m in 0.21s]
[0m20:44:45.590907 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m20:44:45.592897 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m20:44:45.595121 [info ] [Thread-1 (]: 15 of 43 START sql view model prod.int_trips ................................... [RUN]
[0m20:44:45.596691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27, now model.dbt_project.int_trips)
[0m20:44:45.598210 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m20:44:45.612013 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m20:44:45.645778 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m20:44:45.655759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m20:44:45.687847 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:44:45.689291 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m20:44:45.690505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:45.770806 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m20:44:45.772710 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:44:45.774315 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:44:45.782009 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:44:45.790524 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:44:45.792062 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" rename to "int_trips"
[0m20:44:45.794581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:44:45.797746 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:44:45.799179 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:44:45.800910 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:44:45.822653 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m20:44:45.831227 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:44:45.833216 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips__dbt_backup" cascade
[0m20:44:45.836077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:44:45.839381 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m20:44:46.685106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de7e6a57-bc68-4b78-bcf3-2ee539a8cb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a39c1518b0>]}
[0m20:44:46.687359 [info ] [Thread-1 (]: 15 of 43 OK created sql view model prod.int_trips .............................. [[32mOK[0m in 1.09s]
[0m20:44:46.689788 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m20:44:46.693566 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m20:44:46.695382 [info ] [Thread-1 (]: 16 of 43 START test accepted_values_int_trips_service_type__Green__Yellow ...... [RUN]
[0m20:44:46.697279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e)
[0m20:44:46.699147 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m20:44:46.712149 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m20:44:46.759892 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m20:44:46.767866 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m20:44:46.825440 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m20:44:46.827213 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: BEGIN
[0m20:44:46.828842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:46.924019 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m20:44:46.925823 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m20:44:46.927192 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."prod"."int_trips"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m20:44:46.938716 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:44:46.943231 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: ROLLBACK
[0m20:44:46.945883 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e'
[0m20:44:46.947189 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: Close
[0m20:44:46.956187 [info ] [Thread-1 (]: 16 of 43 PASS accepted_values_int_trips_service_type__Green__Yellow ............ [[32mPASS[0m in 0.26s]
[0m20:44:46.958312 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m20:44:46.959939 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m20:44:46.961192 [info ] [Thread-1 (]: 17 of 43 START test not_null_int_trips_pickup_datetime ......................... [RUN]
[0m20:44:46.962684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e, now test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09)
[0m20:44:46.963923 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m20:44:46.976041 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m20:44:47.008890 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m20:44:47.014899 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m20:44:47.044705 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m20:44:47.046220 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: BEGIN
[0m20:44:47.047721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:47.148712 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m20:44:47.150700 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m20:44:47.152605 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."int_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m20:44:47.170935 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:44:47.175821 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: ROLLBACK
[0m20:44:47.178463 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09'
[0m20:44:47.179900 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: Close
[0m20:44:47.190504 [info ] [Thread-1 (]: 17 of 43 PASS not_null_int_trips_pickup_datetime ............................... [[32mPASS[0m in 0.23s]
[0m20:44:47.193399 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m20:44:47.195548 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m20:44:47.197190 [info ] [Thread-1 (]: 18 of 43 START test not_null_int_trips_service_type ............................ [RUN]
[0m20:44:47.199026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09, now test.dbt_project.not_null_int_trips_service_type.f38e150f53)
[0m20:44:47.201405 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m20:44:47.212787 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m20:44:47.240409 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m20:44:47.247099 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m20:44:47.281314 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m20:44:47.283472 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: BEGIN
[0m20:44:47.285318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:47.376195 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m20:44:47.378664 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m20:44:47.380241 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_service_type.f38e150f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."prod"."int_trips"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m20:44:47.390260 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:44:47.394598 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: ROLLBACK
[0m20:44:47.397169 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_service_type.f38e150f53'
[0m20:44:47.398614 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: Close
[0m20:44:47.409141 [info ] [Thread-1 (]: 18 of 43 PASS not_null_int_trips_service_type .................................. [[32mPASS[0m in 0.21s]
[0m20:44:47.411617 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m20:44:47.413792 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m20:44:47.415235 [info ] [Thread-1 (]: 19 of 43 START test not_null_int_trips_total_amount ............................ [RUN]
[0m20:44:47.417717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_service_type.f38e150f53, now test.dbt_project.not_null_int_trips_total_amount.ec933efa9b)
[0m20:44:47.419691 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m20:44:47.436800 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m20:44:47.470863 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m20:44:47.476530 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m20:44:47.506985 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m20:44:47.508192 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: BEGIN
[0m20:44:47.509502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:47.587736 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m20:44:47.589045 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m20:44:47.590128 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "taxi_rides_ny"."prod"."int_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m20:44:47.599092 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:44:47.604373 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: ROLLBACK
[0m20:44:47.607496 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_total_amount.ec933efa9b'
[0m20:44:47.608895 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: Close
[0m20:44:47.617941 [info ] [Thread-1 (]: 19 of 43 PASS not_null_int_trips_total_amount .................................. [[32mPASS[0m in 0.20s]
[0m20:44:47.620617 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m20:44:47.622323 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m20:44:47.623696 [info ] [Thread-1 (]: 20 of 43 START test not_null_int_trips_trip_id ................................. [RUN]
[0m20:44:47.625367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_total_amount.ec933efa9b, now test.dbt_project.not_null_int_trips_trip_id.9edd5fee61)
[0m20:44:47.627019 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m20:44:47.642086 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m20:44:47.668402 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m20:44:47.674378 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m20:44:47.703511 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m20:44:47.705102 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: BEGIN
[0m20:44:47.706401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:47.794013 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m20:44:47.795393 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m20:44:47.796630 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."prod"."int_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m20:48:02.135595 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."prod"."int_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m20:48:02.138886 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:48:02.141422 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: ROLLBACK
[0m20:48:02.153392 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_trip_id.9edd5fee61'
[0m20:48:02.155235 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: Close
[0m20:48:02.430348 [debug] [Thread-1 (]: Runtime Error in test not_null_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m20:48:02.432111 [error] [Thread-1 (]: 20 of 43 ERROR not_null_int_trips_trip_id ...................................... [[31mERROR[0m in 194.81s]
[0m20:48:02.433838 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m20:48:02.435418 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m20:48:02.436696 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_int_trips_trip_id.9edd5fee61' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads.
[0m20:48:02.437574 [info ] [Thread-1 (]: 21 of 43 START test not_null_int_trips_vendor_id ............................... [RUN]
[0m20:48:02.441272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_trip_id.9edd5fee61, now test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c)
[0m20:48:02.442585 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m20:48:02.456174 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m20:48:02.481183 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m20:48:02.486678 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m20:48:02.513343 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m20:48:02.514686 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: BEGIN
[0m20:48:02.515832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:02.610528 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m20:48:02.612096 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m20:48:02.613439 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."int_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m20:48:18.260282 [debug] [Thread-1 (]: SQL status: OK in 15.645 seconds
[0m20:48:18.268543 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: ROLLBACK
[0m20:48:18.271754 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c'
[0m20:48:18.273600 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: Close
[0m20:48:18.687011 [info ] [Thread-1 (]: 21 of 43 PASS not_null_int_trips_vendor_id ..................................... [[32mPASS[0m in 16.25s]
[0m20:48:18.691644 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m20:48:18.695225 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m20:48:18.698089 [info ] [Thread-1 (]: 22 of 43 START test unique_int_trips_trip_id ................................... [RUN]
[0m20:48:18.700673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c, now test.dbt_project.unique_int_trips_trip_id.37d69d814f)
[0m20:48:18.705077 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m20:48:18.730942 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m20:48:18.779840 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m20:48:18.789253 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m20:48:18.824261 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m20:48:18.826880 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: BEGIN
[0m20:48:18.829007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:18.950901 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m20:48:18.953760 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m20:48:18.955963 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_int_trips_trip_id.37d69d814f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."int_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:52:11.616613 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_int_trips_trip_id.37d69d814f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."int_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:52:11.619892 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:52:11.621979 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: ROLLBACK
[0m20:52:11.629038 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_int_trips_trip_id.37d69d814f'
[0m20:52:11.630600 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: Close
[0m20:52:12.003801 [debug] [Thread-1 (]: Runtime Error in test unique_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m20:52:12.006923 [error] [Thread-1 (]: 22 of 43 ERROR unique_int_trips_trip_id ........................................ [[31mERROR[0m in 233.31s]
[0m20:52:12.009610 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m20:52:12.012562 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.unique_int_trips_trip_id.37d69d814f' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads.
[0m20:52:12.016583 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m20:52:12.018018 [info ] [Thread-1 (]: 23 of 43 SKIP relation prod.fct_trips .......................................... [[33mSKIP[0m]
[0m20:52:12.019438 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m20:52:12.020523 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_trips' to be skipped because of status 'skipped'. 
[0m20:52:12.022852 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m20:52:12.024360 [info ] [Thread-1 (]: 24 of 43 SKIP test accepted_values_fct_trips_service_type__Green__Yellow ....... [[33mSKIP[0m]
[0m20:52:12.025876 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m20:52:12.027676 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83
[0m20:52:12.028678 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c' to be skipped because of status 'skipped'. 
[0m20:52:12.030323 [info ] [Thread-1 (]: 25 of 43 SKIP test not_null_fct_trips_pickup_datetime .......................... [[33mSKIP[0m]
[0m20:52:12.033527 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83
[0m20:52:12.035454 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f
[0m20:52:12.036193 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83' to be skipped because of status 'skipped'. 
[0m20:52:12.037160 [info ] [Thread-1 (]: 26 of 43 SKIP test not_null_fct_trips_service_type ............................. [[33mSKIP[0m]
[0m20:52:12.039535 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f
[0m20:52:12.041124 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d
[0m20:52:12.041906 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f' to be skipped because of status 'skipped'. 
[0m20:52:12.043045 [info ] [Thread-1 (]: 27 of 43 SKIP test not_null_fct_trips_total_amount ............................. [[33mSKIP[0m]
[0m20:52:12.049962 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d
[0m20:52:12.052187 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d
[0m20:52:12.053028 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d' to be skipped because of status 'skipped'. 
[0m20:52:12.054169 [info ] [Thread-1 (]: 28 of 43 SKIP test not_null_fct_trips_trip_id .................................. [[33mSKIP[0m]
[0m20:52:12.056581 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d
[0m20:52:12.058101 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:52:12.059147 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d' to be skipped because of status 'skipped'. 
[0m20:52:12.060093 [info ] [Thread-1 (]: 29 of 43 SKIP test not_null_fct_trips_vendor_id ................................ [[33mSKIP[0m]
[0m20:52:12.065255 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:52:12.066920 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m20:52:12.067905 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb' to be skipped because of status 'skipped'. 
[0m20:52:12.068967 [info ] [Thread-1 (]: 30 of 43 SKIP test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_  [[33mSKIP[0m]
[0m20:52:12.071163 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m20:52:12.072464 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m20:52:12.073221 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68' to be skipped because of status 'skipped'. 
[0m20:52:12.074063 [info ] [Thread-1 (]: 31 of 43 SKIP test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_  [[33mSKIP[0m]
[0m20:52:12.076785 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m20:52:12.078886 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab
[0m20:52:12.080076 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4' to be skipped because of status 'skipped'. 
[0m20:52:12.081237 [info ] [Thread-1 (]: 32 of 43 SKIP test unique_fct_trips_trip_id .................................... [[33mSKIP[0m]
[0m20:52:12.084323 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab
[0m20:52:12.085853 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab' to be skipped because of status 'skipped'. 
[0m20:52:12.088284 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m20:52:12.089451 [info ] [Thread-1 (]: 33 of 43 SKIP relation prod.dim_vendors ........................................ [[33mSKIP[0m]
[0m20:52:12.090688 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m20:52:12.092177 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m20:52:12.093049 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.dim_vendors' to be skipped because of status 'skipped'. 
[0m20:52:12.094133 [info ] [Thread-1 (]: 34 of 43 SKIP relation prod.fct_monthly_zone_revenue ........................... [[33mSKIP[0m]
[0m20:52:12.098427 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m20:52:12.099860 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580
[0m20:52:12.100511 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_monthly_zone_revenue' to be skipped because of status 'skipped'. 
[0m20:52:12.101560 [info ] [Thread-1 (]: 35 of 43 SKIP test not_null_dim_vendors_vendor_id .............................. [[33mSKIP[0m]
[0m20:52:12.104443 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580
[0m20:52:12.105784 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141
[0m20:52:12.106405 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580' to be skipped because of status 'skipped'. 
[0m20:52:12.107315 [info ] [Thread-1 (]: 36 of 43 SKIP test unique_dim_vendors_vendor_id ................................ [[33mSKIP[0m]
[0m20:52:12.109650 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141
[0m20:52:12.111361 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m20:52:12.113055 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141' to be skipped because of status 'skipped'. 
[0m20:52:12.114169 [info ] [Thread-1 (]: 37 of 43 SKIP test accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow  [[33mSKIP[0m]
[0m20:52:12.116573 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m20:52:12.119447 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m20:52:12.120587 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6' to be skipped because of status 'skipped'. 
[0m20:52:12.121551 [info ] [Thread-1 (]: 38 of 43 SKIP test dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type  [[33mSKIP[0m]
[0m20:52:12.124345 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m20:52:12.125942 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m20:52:12.126818 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751' to be skipped because of status 'skipped'. 
[0m20:52:12.128278 [info ] [Thread-1 (]: 39 of 43 SKIP test not_null_fct_monthly_zone_revenue_pickup_zone ............... [[33mSKIP[0m]
[0m20:52:12.132003 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m20:52:12.133881 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m20:52:12.134871 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709' to be skipped because of status 'skipped'. 
[0m20:52:12.136143 [info ] [Thread-1 (]: 40 of 43 SKIP test not_null_fct_monthly_zone_revenue_revenue_month ............. [[33mSKIP[0m]
[0m20:52:12.138683 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m20:52:12.140261 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m20:52:12.141071 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100' to be skipped because of status 'skipped'. 
[0m20:52:12.142080 [info ] [Thread-1 (]: 41 of 43 SKIP test not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount  [[33mSKIP[0m]
[0m20:52:12.144375 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m20:52:12.147434 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m20:52:12.148410 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe' to be skipped because of status 'skipped'. 
[0m20:52:12.149442 [info ] [Thread-1 (]: 42 of 43 SKIP test not_null_fct_monthly_zone_revenue_service_type .............. [[33mSKIP[0m]
[0m20:52:12.151753 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m20:52:12.152943 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m20:52:12.153604 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7' to be skipped because of status 'skipped'. 
[0m20:52:12.154354 [info ] [Thread-1 (]: 43 of 43 SKIP test not_null_fct_monthly_zone_revenue_total_monthly_trips ....... [[33mSKIP[0m]
[0m20:52:12.156415 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m20:52:12.157749 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413' to be skipped because of status 'skipped'. 
[0m20:52:12.165023 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:12.166898 [debug] [MainThread]: On master: BEGIN
[0m20:52:12.168528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:12.265912 [debug] [MainThread]: SQL status: OK in 0.098 seconds
[0m20:52:12.267404 [debug] [MainThread]: On master: COMMIT
[0m20:52:12.268698 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:12.269686 [debug] [MainThread]: On master: COMMIT
[0m20:52:12.271440 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:52:12.272623 [debug] [MainThread]: On master: Close
[0m20:52:12.282197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:12.283788 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m20:52:12.284924 [debug] [MainThread]: Connection 'test.dbt_project.unique_int_trips_trip_id.37d69d814f' was properly closed.
[0m20:52:12.286632 [info ] [MainThread]: 
[0m20:52:12.288457 [info ] [MainThread]: Finished running 1 incremental model, 2 seeds, 33 data tests, 7 view models in 0 hours 7 minutes and 39.85 seconds (459.85s).
[0m20:52:12.298867 [debug] [MainThread]: Command end result
[0m20:52:12.464722 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:52:12.486788 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:52:12.524038 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m20:52:12.525934 [info ] [MainThread]: 
[0m20:52:12.527634 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:52:12.530119 [info ] [MainThread]: 
[0m20:52:12.532368 [error] [MainThread]: [31mFailure in test not_null_int_trips_trip_id (models/intermediate/schema.yml)[0m
[0m20:52:12.533921 [error] [MainThread]:   Runtime Error in test not_null_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m20:52:12.535372 [info ] [MainThread]: 
[0m20:52:12.537914 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/schema.yml/not_null_int_trips_trip_id.sql
[0m20:52:12.539334 [info ] [MainThread]: 
[0m20:52:12.541168 [error] [MainThread]: [31mFailure in test unique_int_trips_trip_id (models/intermediate/schema.yml)[0m
[0m20:52:12.542704 [error] [MainThread]:   Runtime Error in test unique_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m20:52:12.544583 [info ] [MainThread]: 
[0m20:52:12.547290 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/schema.yml/unique_int_trips_trip_id.sql
[0m20:52:12.549283 [info ] [MainThread]: 
[0m20:52:12.550897 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=2 SKIP=21 NO-OP=0 TOTAL=43
[0m20:52:12.557094 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 469.20245, "process_in_blocks": "4408", "process_kernel_time": 208.66728, "process_mem_max_rss": "4648044", "process_out_blocks": "0", "process_user_time": 1250.5823}
[0m20:52:12.559207 [debug] [MainThread]: Command `dbt build` failed at 20:52:12.558906 after 469.21 seconds
[0m20:52:12.562689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a39d9192e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a3a7e34ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a3a7e34bf0>]}
[0m20:52:12.564849 [debug] [MainThread]: Flushing usage events
[0m20:52:13.484815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:29.670879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1d22da0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1d4e87590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1d43e13a0>]}


============================== 20:55:29.681754 | 6dba5cb1-aea3-4cb8-84b2-07b643ea6b54 ==============================
[0m20:55:29.681754 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:55:29.683679 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'empty': 'False', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --target prod', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True'}
[0m20:55:30.071978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1ca381370>]}
[0m20:55:30.195043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1d231de80>]}
[0m20:55:30.196987 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m20:55:30.453012 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m20:55:34.137210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:55:34.138579 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:55:34.139655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:55:34.223840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1ca238560>]}
[0m20:55:34.437797 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m20:55:34.449878 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m20:55:34.524327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1ca3f48c0>]}
[0m20:55:34.525486 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m20:55:34.533960 [info ] [MainThread]: 
[0m20:55:34.535360 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:55:34.536719 [info ] [MainThread]: 
[0m20:55:34.538819 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:55:34.550346 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m20:55:34.626931 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m20:55:34.628208 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m20:55:34.629059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:34.712392 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m20:55:34.715277 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m20:55:34.722630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m20:55:34.724144 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m20:55:34.739620 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m20:55:34.741115 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m20:55:34.741949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:34.830013 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m20:55:34.833177 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m20:55:34.834356 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m20:55:34.836823 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:55:34.837855 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m20:55:34.838848 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m20:55:34.840740 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:55:34.842780 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m20:55:34.844281 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m20:55:34.845569 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m20:55:34.847353 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:55:34.848215 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m20:55:34.858971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m20:55:34.872457 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m20:55:34.873914 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m20:55:34.875127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:34.935929 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m20:55:34.937208 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m20:55:34.938368 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m20:55:34.963959 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m20:55:34.967198 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m20:55:34.969688 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m20:55:34.970817 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m20:55:34.981394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1d1f63920>]}
[0m20:55:34.982817 [debug] [MainThread]: Using duckdb connection "master"
[0m20:55:34.983783 [debug] [MainThread]: On master: BEGIN
[0m20:55:34.984806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:35.071663 [debug] [MainThread]: SQL status: OK in 0.087 seconds
[0m20:55:35.072886 [debug] [MainThread]: On master: COMMIT
[0m20:55:35.074201 [debug] [MainThread]: Using duckdb connection "master"
[0m20:55:35.076288 [debug] [MainThread]: On master: COMMIT
[0m20:55:35.078442 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:55:35.079481 [debug] [MainThread]: On master: Close
[0m20:55:35.094107 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m20:55:35.095924 [info ] [Thread-1 (]: 1 of 43 START sql view model prod.stg_green_tripdata ........................... [RUN]
[0m20:55:35.097730 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_green_tripdata'
[0m20:55:35.098946 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m20:55:35.120191 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m20:55:35.151878 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m20:55:35.215725 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m20:55:35.247117 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:55:35.249133 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m20:55:35.250844 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:55:35.343816 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m20:55:35.345713 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:55:35.347049 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m20:55:35.350250 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:35.365070 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:55:35.366644 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m20:55:35.369054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:55:35.374684 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:55:35.376111 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m20:55:35.378319 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:55:35.408782 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:55:35.410418 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:55:35.411803 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m20:55:35.430304 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:55:35.440054 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m20:55:35.441738 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_backup" cascade
[0m20:55:35.449140 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:55:35.453759 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m20:55:36.504128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1c8205700>]}
[0m20:55:36.506585 [info ] [Thread-1 (]: 1 of 43 OK created sql view model prod.stg_green_tripdata ...................... [[32mOK[0m in 1.40s]
[0m20:55:36.514466 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m20:55:36.516475 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m20:55:36.518662 [info ] [Thread-1 (]: 2 of 43 START sql view model prod.stg_yellow_tripdata .......................... [RUN]
[0m20:55:36.521423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m20:55:36.523211 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m20:55:36.537379 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m20:55:36.575324 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m20:55:36.587651 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m20:55:36.614310 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:55:36.616219 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m20:55:36.617697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:36.740082 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m20:55:36.742024 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:55:36.747453 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m20:55:36.754602 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:55:36.764973 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:55:36.766541 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m20:55:36.770167 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:36.780328 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:55:36.783005 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m20:55:36.786517 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:36.790726 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:55:36.792750 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:55:36.794763 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m20:55:36.811016 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:55:36.818505 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m20:55:36.819817 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_backup" cascade
[0m20:55:36.828985 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:55:36.833031 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m20:55:37.844935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1c82078c0>]}
[0m20:55:37.847701 [info ] [Thread-1 (]: 2 of 43 OK created sql view model prod.stg_yellow_tripdata ..................... [[32mOK[0m in 1.32s]
[0m20:55:37.850445 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m20:55:37.852794 [debug] [Thread-1 (]: Began running node seed.dbt_project.payment_type_lookup
[0m20:55:37.854459 [info ] [Thread-1 (]: 3 of 43 START seed file prod.payment_type_lookup ............................... [RUN]
[0m20:55:37.857239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now seed.dbt_project.payment_type_lookup)
[0m20:55:37.860165 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.payment_type_lookup
[0m20:55:37.862235 [debug] [Thread-1 (]: Began executing node seed.dbt_project.payment_type_lookup
[0m20:55:38.051088 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m20:55:38.053104 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: BEGIN
[0m20:55:38.055077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:38.147573 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m20:55:38.148997 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m20:55:38.150495 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "seed.dbt_project.payment_type_lookup"} */
truncate table "taxi_rides_ny"."prod"."payment_type_lookup"
[0m20:55:38.153932 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:38.183319 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m20:55:38.185180 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: 
          COPY "taxi_rides_ny"."prod"."payment_type_lookup" FROM '/usr/app/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:55:38.212565 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m20:55:38.225652 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.payment_type_lookup"
[0m20:55:38.250020 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: COMMIT
[0m20:55:38.251774 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m20:55:38.253043 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: COMMIT
[0m20:55:38.268881 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:55:38.271012 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: Close
[0m20:55:39.235529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1c8c09490>]}
[0m20:55:39.237544 [info ] [Thread-1 (]: 3 of 43 OK loaded seed file prod.payment_type_lookup ........................... [[32mINSERT 7[0m in 1.38s]
[0m20:55:39.239496 [debug] [Thread-1 (]: Finished running node seed.dbt_project.payment_type_lookup
[0m20:55:39.241536 [debug] [Thread-1 (]: Began running node seed.dbt_project.taxi_zone_lookup
[0m20:55:39.245257 [info ] [Thread-1 (]: 4 of 43 START seed file prod.taxi_zone_lookup .................................. [RUN]
[0m20:55:39.247733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_project.payment_type_lookup, now seed.dbt_project.taxi_zone_lookup)
[0m20:55:39.250295 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.taxi_zone_lookup
[0m20:55:39.252213 [debug] [Thread-1 (]: Began executing node seed.dbt_project.taxi_zone_lookup
[0m20:55:39.290423 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m20:55:39.294619 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: BEGIN
[0m20:55:39.296384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:39.401670 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m20:55:39.403224 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m20:55:39.404605 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "seed.dbt_project.taxi_zone_lookup"} */
truncate table "taxi_rides_ny"."prod"."taxi_zone_lookup"
[0m20:55:39.407915 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:39.412908 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m20:55:39.414412 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: 
          COPY "taxi_rides_ny"."prod"."taxi_zone_lookup" FROM '/usr/app/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:55:39.440597 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m20:55:39.444160 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.taxi_zone_lookup"
[0m20:55:39.470364 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: COMMIT
[0m20:55:39.471772 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m20:55:39.473375 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: COMMIT
[0m20:55:39.495670 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m20:55:39.498337 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: Close
[0m20:55:40.435258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1d1e8c5f0>]}
[0m20:55:40.437682 [info ] [Thread-1 (]: 4 of 43 OK loaded seed file prod.taxi_zone_lookup .............................. [[32mINSERT 265[0m in 1.19s]
[0m20:55:40.440551 [debug] [Thread-1 (]: Finished running node seed.dbt_project.taxi_zone_lookup
[0m20:55:40.442833 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m20:55:40.445254 [info ] [Thread-1 (]: 5 of 43 START test not_null_stg_green_tripdata_pickup_datetime ................. [RUN]
[0m20:55:40.447039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_project.taxi_zone_lookup, now test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e)
[0m20:55:40.449097 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m20:55:40.488948 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m20:55:40.523683 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m20:55:40.639547 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m20:55:40.689994 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m20:55:40.693494 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: BEGIN
[0m20:55:40.696347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:41.044811 [debug] [Thread-1 (]: SQL status: OK in 0.348 seconds
[0m20:55:41.047226 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m20:55:41.049747 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."stg_green_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m20:55:41.059224 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:55:41.078211 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: ROLLBACK
[0m20:55:41.083513 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e'
[0m20:55:41.086942 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: Close
[0m20:55:41.104538 [info ] [Thread-1 (]: 5 of 43 PASS not_null_stg_green_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.66s]
[0m20:55:41.108479 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m20:55:41.120410 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m20:55:41.131197 [info ] [Thread-1 (]: 6 of 43 START test not_null_stg_green_tripdata_vendor_id ....................... [RUN]
[0m20:55:41.149604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e, now test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493)
[0m20:55:41.158054 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m20:55:41.196828 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m20:55:41.236690 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m20:55:41.252451 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m20:55:41.283178 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m20:55:41.285820 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: BEGIN
[0m20:55:41.289152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:41.392176 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m20:55:41.394655 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m20:55:41.396447 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."stg_green_tripdata"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m20:55:41.538405 [debug] [Thread-1 (]: SQL status: OK in 0.140 seconds
[0m20:55:41.547040 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: ROLLBACK
[0m20:55:41.551084 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493'
[0m20:55:41.552584 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: Close
[0m20:55:41.572387 [info ] [Thread-1 (]: 6 of 43 PASS not_null_stg_green_tripdata_vendor_id ............................. [[32mPASS[0m in 0.42s]
[0m20:55:41.577453 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m20:55:41.579344 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:55:41.581088 [info ] [Thread-1 (]: 7 of 43 START test not_null_stg_yellow_tripdata_pickup_datetime ................ [RUN]
[0m20:55:41.583270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493, now test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44)
[0m20:55:41.585147 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:55:41.602123 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:55:41.639526 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:55:41.647517 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:55:41.674436 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:55:41.676508 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: BEGIN
[0m20:55:41.678157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:41.815133 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m20:55:41.817228 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:55:41.819039 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m20:55:41.826170 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:55:41.833984 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m20:55:41.838080 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m20:55:41.840000 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m20:55:41.855189 [info ] [Thread-1 (]: 7 of 43 PASS not_null_stg_yellow_tripdata_pickup_datetime ...................... [[32mPASS[0m in 0.27s]
[0m20:55:41.858577 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:55:41.862230 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m20:55:41.864652 [info ] [Thread-1 (]: 8 of 43 START test not_null_stg_yellow_tripdata_vendor_id ...................... [RUN]
[0m20:55:41.867220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44, now test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751)
[0m20:55:41.869819 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m20:55:41.887405 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m20:55:41.924490 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m20:55:41.933150 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m20:55:41.978333 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m20:55:41.980533 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: BEGIN
[0m20:55:41.982174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:42.085126 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m20:55:42.086687 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m20:55:42.088041 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m20:55:44.127498 [debug] [Thread-1 (]: SQL status: OK in 2.038 seconds
[0m20:55:44.133415 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: ROLLBACK
[0m20:55:44.137108 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751'
[0m20:55:44.138821 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: Close
[0m20:55:44.208075 [info ] [Thread-1 (]: 8 of 43 PASS not_null_stg_yellow_tripdata_vendor_id ............................ [[32mPASS[0m in 2.34s]
[0m20:55:44.218569 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m20:55:44.221749 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m20:55:44.224473 [info ] [Thread-1 (]: 9 of 43 START test not_null_payment_type_lookup_payment_type ................... [RUN]
[0m20:55:44.230074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751, now test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4)
[0m20:55:44.234924 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m20:55:44.270748 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m20:55:44.319056 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m20:55:44.329711 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m20:55:44.373105 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m20:55:44.375916 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: BEGIN
[0m20:55:44.378131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:44.495678 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m20:55:44.498795 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m20:55:44.502240 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type
from "taxi_rides_ny"."prod"."payment_type_lookup"
where payment_type is null



  
  
      
    ) dbt_internal_test
[0m20:55:44.512358 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:55:44.518707 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: ROLLBACK
[0m20:55:44.522978 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4'
[0m20:55:44.526315 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: Close
[0m20:55:44.544123 [info ] [Thread-1 (]: 9 of 43 PASS not_null_payment_type_lookup_payment_type ......................... [[32mPASS[0m in 0.31s]
[0m20:55:44.550235 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m20:55:44.552682 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m20:55:44.556481 [info ] [Thread-1 (]: 10 of 43 START test unique_payment_type_lookup_payment_type .................... [RUN]
[0m20:55:44.561342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4, now test.dbt_project.unique_payment_type_lookup_payment_type.819f837245)
[0m20:55:44.564521 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m20:55:44.596225 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m20:55:44.626317 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m20:55:44.637166 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m20:55:44.674899 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m20:55:44.678285 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: BEGIN
[0m20:55:44.680363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:44.819805 [debug] [Thread-1 (]: SQL status: OK in 0.140 seconds
[0m20:55:44.821834 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m20:55:44.823317 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."payment_type_lookup"
where payment_type is not null
group by payment_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:55:44.836488 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:55:44.844414 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: ROLLBACK
[0m20:55:44.847774 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_payment_type_lookup_payment_type.819f837245'
[0m20:55:44.849922 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: Close
[0m20:55:44.861024 [info ] [Thread-1 (]: 10 of 43 PASS unique_payment_type_lookup_payment_type .......................... [[32mPASS[0m in 0.30s]
[0m20:55:44.864093 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m20:55:44.865957 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m20:55:44.868082 [info ] [Thread-1 (]: 11 of 43 START sql view model prod.dim_zones ................................... [RUN]
[0m20:55:44.870276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_payment_type_lookup_payment_type.819f837245, now model.dbt_project.dim_zones)
[0m20:55:44.879570 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m20:55:44.895227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m20:55:44.929900 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m20:55:44.944228 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m20:55:44.977132 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:55:44.978623 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m20:55:44.980020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:45.067979 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m20:55:45.069379 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:55:45.070967 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."prod"."taxi_zone_lookup"
  );

[0m20:55:45.074946 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:45.083174 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:55:45.084392 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones" rename to "dim_zones__dbt_backup"
[0m20:55:45.086595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:55:45.096242 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:55:45.097816 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m20:55:45.100714 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:45.104933 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:55:45.106576 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:55:45.108296 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m20:55:45.126822 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:55:45.133074 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m20:55:45.134767 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."prod"."dim_zones__dbt_backup" cascade
[0m20:55:45.142777 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:55:45.146453 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m20:55:46.214464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1c8c58140>]}
[0m20:55:46.217319 [info ] [Thread-1 (]: 11 of 43 OK created sql view model prod.dim_zones .............................. [[32mOK[0m in 1.34s]
[0m20:55:46.219805 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m20:55:46.221985 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m20:55:46.227543 [info ] [Thread-1 (]: 12 of 43 START sql view model prod.int_trips_unioned ........................... [RUN]
[0m20:55:46.230396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.int_trips_unioned)
[0m20:55:46.232536 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m20:55:46.244517 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m20:55:46.269639 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m20:55:46.280294 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m20:55:46.314569 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:55:46.316876 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m20:55:46.318506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:46.417016 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m20:55:46.418486 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:55:46.420008 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."prod"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m20:55:46.429654 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:55:46.438932 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:55:46.440514 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned" rename to "int_trips_unioned__dbt_backup"
[0m20:55:46.444416 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:46.452916 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:55:46.454485 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m20:55:46.457266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:55:46.463166 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:55:46.465231 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:55:46.467057 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m20:55:46.484021 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:55:46.497680 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m20:55:46.499344 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips_unioned__dbt_backup" cascade
[0m20:55:46.508518 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:55:46.512594 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m20:55:47.417182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1c8207680>]}
[0m20:55:47.419271 [info ] [Thread-1 (]: 12 of 43 OK created sql view model prod.int_trips_unioned ...................... [[32mOK[0m in 1.19s]
[0m20:55:47.421672 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m20:55:47.423250 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m20:55:47.426510 [info ] [Thread-1 (]: 13 of 43 START test not_null_dim_zones_location_id ............................. [RUN]
[0m20:55:47.428624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79)
[0m20:55:47.430745 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m20:55:47.445643 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m20:55:47.475469 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m20:55:47.482592 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m20:55:47.505457 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m20:55:47.506729 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: BEGIN
[0m20:55:47.509925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:47.587587 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m20:55:47.589073 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m20:55:47.590901 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "taxi_rides_ny"."prod"."dim_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m20:55:47.595048 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:47.599772 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: ROLLBACK
[0m20:55:47.602647 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79'
[0m20:55:47.604217 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: Close
[0m20:55:47.613263 [info ] [Thread-1 (]: 13 of 43 PASS not_null_dim_zones_location_id ................................... [[32mPASS[0m in 0.18s]
[0m20:55:47.616169 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m20:55:47.617735 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m20:55:47.619136 [info ] [Thread-1 (]: 14 of 43 START test unique_dim_zones_location_id ............................... [RUN]
[0m20:55:47.620963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79, now test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27)
[0m20:55:47.622420 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m20:55:47.635381 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m20:55:47.670108 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m20:55:47.678071 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m20:55:47.710301 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m20:55:47.712059 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: BEGIN
[0m20:55:47.713466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:47.794886 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m20:55:47.796567 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m20:55:47.798193 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."dim_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:55:47.808293 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:55:47.812522 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: ROLLBACK
[0m20:55:47.815258 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27'
[0m20:55:47.816867 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: Close
[0m20:55:47.828587 [info ] [Thread-1 (]: 14 of 43 PASS unique_dim_zones_location_id ..................................... [[32mPASS[0m in 0.21s]
[0m20:55:47.831330 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m20:55:47.833083 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m20:55:47.834880 [info ] [Thread-1 (]: 15 of 43 START sql view model prod.int_trips ................................... [RUN]
[0m20:55:47.837852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27, now model.dbt_project.int_trips)
[0m20:55:47.839385 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m20:55:47.890482 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m20:55:47.910504 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m20:55:47.923588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m20:55:47.948794 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:55:47.950606 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m20:55:47.952398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:48.033052 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m20:55:48.034712 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:55:48.036457 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m20:55:48.045298 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:55:48.052709 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:55:48.054399 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips" rename to "int_trips__dbt_backup"
[0m20:55:48.057781 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:48.068916 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:55:48.070647 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" rename to "int_trips"
[0m20:55:48.073665 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:55:48.078540 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:55:48.080129 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:55:48.081419 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m20:55:48.098771 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:55:48.105450 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m20:55:48.106793 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips__dbt_backup" cascade
[0m20:55:48.114950 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:55:48.118506 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m20:55:48.990956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dba5cb1-aea3-4cb8-84b2-07b643ea6b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1c8caa9c0>]}
[0m20:55:48.994008 [info ] [Thread-1 (]: 15 of 43 OK created sql view model prod.int_trips .............................. [[32mOK[0m in 1.15s]
[0m20:55:48.996442 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m20:55:48.999577 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m20:55:49.000863 [info ] [Thread-1 (]: 16 of 43 START test accepted_values_int_trips_service_type__Green__Yellow ...... [RUN]
[0m20:55:49.002608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e)
[0m20:55:49.004641 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m20:55:49.032140 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m20:55:49.056441 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m20:55:49.064073 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m20:55:49.093602 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m20:55:49.095550 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: BEGIN
[0m20:55:49.096886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:49.185552 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m20:55:49.187332 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m20:55:49.188871 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."prod"."int_trips"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m20:55:49.205701 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:55:49.211177 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: ROLLBACK
[0m20:55:49.214195 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e'
[0m20:55:49.215426 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: Close
[0m20:55:49.224120 [info ] [Thread-1 (]: 16 of 43 PASS accepted_values_int_trips_service_type__Green__Yellow ............ [[32mPASS[0m in 0.22s]
[0m20:55:49.228937 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m20:55:49.231295 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m20:55:49.232873 [info ] [Thread-1 (]: 17 of 43 START test not_null_int_trips_pickup_datetime ......................... [RUN]
[0m20:55:49.234532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e, now test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09)
[0m20:55:49.236348 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m20:55:49.250790 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m20:55:49.282086 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m20:55:49.289219 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m20:55:49.322911 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m20:55:49.324939 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: BEGIN
[0m20:55:49.326704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:49.410449 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m20:55:49.412372 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m20:55:49.413755 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."int_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m20:55:49.436390 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m20:55:49.441888 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: ROLLBACK
[0m20:55:49.445975 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09'
[0m20:55:49.447587 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: Close
[0m20:55:49.466156 [info ] [Thread-1 (]: 17 of 43 PASS not_null_int_trips_pickup_datetime ............................... [[32mPASS[0m in 0.23s]
[0m20:55:49.472471 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m20:55:49.480773 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m20:55:49.485097 [info ] [Thread-1 (]: 18 of 43 START test not_null_int_trips_service_type ............................ [RUN]
[0m20:55:49.493818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09, now test.dbt_project.not_null_int_trips_service_type.f38e150f53)
[0m20:55:49.502443 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m20:55:49.530369 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m20:55:49.563753 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m20:55:49.573176 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m20:55:49.611816 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m20:55:49.614357 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: BEGIN
[0m20:55:49.616314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:49.723098 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m20:55:49.727025 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m20:55:49.728688 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_service_type.f38e150f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."prod"."int_trips"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m20:55:49.737616 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:55:49.743606 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: ROLLBACK
[0m20:55:49.746900 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_service_type.f38e150f53'
[0m20:55:49.748761 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: Close
[0m20:55:49.759611 [info ] [Thread-1 (]: 18 of 43 PASS not_null_int_trips_service_type .................................. [[32mPASS[0m in 0.26s]
[0m20:55:49.762826 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m20:55:49.764404 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m20:55:49.765780 [info ] [Thread-1 (]: 19 of 43 START test not_null_int_trips_total_amount ............................ [RUN]
[0m20:55:49.767551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_service_type.f38e150f53, now test.dbt_project.not_null_int_trips_total_amount.ec933efa9b)
[0m20:55:49.769155 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m20:55:49.781131 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m20:55:49.806347 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m20:55:49.816688 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m20:55:49.854482 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m20:55:49.856547 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: BEGIN
[0m20:55:49.858256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:49.941460 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m20:55:49.943346 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m20:55:49.944780 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "taxi_rides_ny"."prod"."int_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m20:55:49.957778 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:55:49.961959 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: ROLLBACK
[0m20:55:49.964384 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_total_amount.ec933efa9b'
[0m20:55:49.965564 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: Close
[0m20:55:49.974064 [info ] [Thread-1 (]: 19 of 43 PASS not_null_int_trips_total_amount .................................. [[32mPASS[0m in 0.21s]
[0m20:55:49.976908 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m20:55:49.978484 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m20:55:49.979643 [info ] [Thread-1 (]: 20 of 43 START test not_null_int_trips_trip_id ................................. [RUN]
[0m20:55:49.981361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_total_amount.ec933efa9b, now test.dbt_project.not_null_int_trips_trip_id.9edd5fee61)
[0m20:55:49.983031 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m20:55:49.998335 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m20:55:50.020920 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m20:55:50.028064 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m20:55:50.054274 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m20:55:50.055534 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: BEGIN
[0m20:55:50.056808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:50.153702 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m20:55:50.155176 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m20:55:50.156789 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."prod"."int_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m20:59:16.210197 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."prod"."int_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m20:59:16.213327 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:59:16.215552 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: ROLLBACK
[0m20:59:16.227653 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_trip_id.9edd5fee61'
[0m20:59:16.229010 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: Close
[0m20:59:16.621948 [debug] [Thread-1 (]: Runtime Error in test not_null_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m20:59:16.624864 [error] [Thread-1 (]: 20 of 43 ERROR not_null_int_trips_trip_id ...................................... [[31mERROR[0m in 206.64s]
[0m20:59:16.627749 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m20:59:16.629501 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m20:59:16.630939 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_int_trips_trip_id.9edd5fee61' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads.
[0m20:59:16.632004 [info ] [Thread-1 (]: 21 of 43 START test not_null_int_trips_vendor_id ............................... [RUN]
[0m20:59:16.637015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_trip_id.9edd5fee61, now test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c)
[0m20:59:16.638439 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m20:59:16.655494 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m20:59:16.684543 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m20:59:16.695371 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m20:59:16.726872 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m20:59:16.729108 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: BEGIN
[0m20:59:16.730901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:16.839982 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m20:59:16.841975 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m20:59:16.843251 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."int_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m20:59:35.760535 [debug] [Thread-1 (]: SQL status: OK in 18.926 seconds
[0m20:59:35.768153 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: ROLLBACK
[0m20:59:35.771221 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c'
[0m20:59:35.773337 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: Close
[0m20:59:36.220433 [info ] [Thread-1 (]: 21 of 43 PASS not_null_int_trips_vendor_id ..................................... [[32mPASS[0m in 19.58s]
[0m20:59:36.224411 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m20:59:36.227261 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m20:59:36.230421 [info ] [Thread-1 (]: 22 of 43 START test unique_int_trips_trip_id ................................... [RUN]
[0m20:59:36.235608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c, now test.dbt_project.unique_int_trips_trip_id.37d69d814f)
[0m20:59:36.238200 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m20:59:36.267097 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m20:59:36.309315 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m20:59:36.321299 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m20:59:36.369708 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m20:59:36.371899 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: BEGIN
[0m20:59:36.373618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:36.486391 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m20:59:36.488240 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m20:59:36.489974 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_int_trips_trip_id.37d69d814f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."int_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:03:03.643767 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_int_trips_trip_id.37d69d814f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."int_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:03:03.645771 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:03:03.647383 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: ROLLBACK
[0m21:03:03.653885 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_int_trips_trip_id.37d69d814f'
[0m21:03:03.655361 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: Close
[0m21:03:03.958475 [debug] [Thread-1 (]: Runtime Error in test unique_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m21:03:03.960883 [error] [Thread-1 (]: 22 of 43 ERROR unique_int_trips_trip_id ........................................ [[31mERROR[0m in 207.73s]
[0m21:03:03.963064 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m21:03:03.965081 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.unique_int_trips_trip_id.37d69d814f' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads.
[0m21:03:03.969144 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m21:03:03.970565 [info ] [Thread-1 (]: 23 of 43 SKIP relation prod.fct_trips .......................................... [[33mSKIP[0m]
[0m21:03:03.972069 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m21:03:03.973479 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_trips' to be skipped because of status 'skipped'. 
[0m21:03:03.976173 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:03:03.977663 [info ] [Thread-1 (]: 24 of 43 SKIP test accepted_values_fct_trips_service_type__Green__Yellow ....... [[33mSKIP[0m]
[0m21:03:03.982931 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:03:03.984597 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:03:03.985210 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c' to be skipped because of status 'skipped'. 
[0m21:03:03.985989 [info ] [Thread-1 (]: 25 of 43 SKIP test not_null_fct_trips_pickup_datetime .......................... [[33mSKIP[0m]
[0m21:03:03.987765 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:03:03.989119 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:03:03.989748 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83' to be skipped because of status 'skipped'. 
[0m21:03:03.990432 [info ] [Thread-1 (]: 26 of 43 SKIP test not_null_fct_trips_service_type ............................. [[33mSKIP[0m]
[0m21:03:03.992066 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:03:03.993293 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:03:03.993947 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f' to be skipped because of status 'skipped'. 
[0m21:03:03.994855 [info ] [Thread-1 (]: 27 of 43 SKIP test not_null_fct_trips_total_amount ............................. [[33mSKIP[0m]
[0m21:03:03.996610 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:03:03.997687 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:03:03.998128 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d' to be skipped because of status 'skipped'. 
[0m21:03:03.998717 [info ] [Thread-1 (]: 28 of 43 SKIP test not_null_fct_trips_trip_id .................................. [[33mSKIP[0m]
[0m21:03:04.000282 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:03:04.001592 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:03:04.002315 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d' to be skipped because of status 'skipped'. 
[0m21:03:04.003251 [info ] [Thread-1 (]: 29 of 43 SKIP test not_null_fct_trips_vendor_id ................................ [[33mSKIP[0m]
[0m21:03:04.005178 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:03:04.006110 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:03:04.006573 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb' to be skipped because of status 'skipped'. 
[0m21:03:04.007095 [info ] [Thread-1 (]: 30 of 43 SKIP test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_  [[33mSKIP[0m]
[0m21:03:04.008679 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:03:04.009558 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:03:04.010174 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68' to be skipped because of status 'skipped'. 
[0m21:03:04.010942 [info ] [Thread-1 (]: 31 of 43 SKIP test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_  [[33mSKIP[0m]
[0m21:03:04.012751 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:03:04.013786 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab
[0m21:03:04.014279 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4' to be skipped because of status 'skipped'. 
[0m21:03:04.014746 [info ] [Thread-1 (]: 32 of 43 SKIP test unique_fct_trips_trip_id .................................... [[33mSKIP[0m]
[0m21:03:04.015824 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab
[0m21:03:04.016771 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab' to be skipped because of status 'skipped'. 
[0m21:03:04.018657 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m21:03:04.019659 [info ] [Thread-1 (]: 33 of 43 SKIP relation prod.dim_vendors ........................................ [[33mSKIP[0m]
[0m21:03:04.020484 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m21:03:04.021641 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m21:03:04.022267 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.dim_vendors' to be skipped because of status 'skipped'. 
[0m21:03:04.022908 [info ] [Thread-1 (]: 34 of 43 SKIP relation prod.fct_monthly_zone_revenue ........................... [[33mSKIP[0m]
[0m21:03:04.025205 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m21:03:04.026391 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:03:04.027066 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_monthly_zone_revenue' to be skipped because of status 'skipped'. 
[0m21:03:04.027799 [info ] [Thread-1 (]: 35 of 43 SKIP test not_null_dim_vendors_vendor_id .............................. [[33mSKIP[0m]
[0m21:03:04.029532 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:03:04.030444 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:03:04.030906 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580' to be skipped because of status 'skipped'. 
[0m21:03:04.031383 [info ] [Thread-1 (]: 36 of 43 SKIP test unique_dim_vendors_vendor_id ................................ [[33mSKIP[0m]
[0m21:03:04.032862 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:03:04.033788 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:03:04.034201 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141' to be skipped because of status 'skipped'. 
[0m21:03:04.034666 [info ] [Thread-1 (]: 37 of 43 SKIP test accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow  [[33mSKIP[0m]
[0m21:03:04.036190 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:03:04.036952 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:03:04.037317 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6' to be skipped because of status 'skipped'. 
[0m21:03:04.037799 [info ] [Thread-1 (]: 38 of 43 SKIP test dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type  [[33mSKIP[0m]
[0m21:03:04.039173 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:03:04.040427 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:03:04.041114 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751' to be skipped because of status 'skipped'. 
[0m21:03:04.041879 [info ] [Thread-1 (]: 39 of 43 SKIP test not_null_fct_monthly_zone_revenue_pickup_zone ............... [[33mSKIP[0m]
[0m21:03:04.056947 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:03:04.060842 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:03:04.061688 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709' to be skipped because of status 'skipped'. 
[0m21:03:04.062426 [info ] [Thread-1 (]: 40 of 43 SKIP test not_null_fct_monthly_zone_revenue_revenue_month ............. [[33mSKIP[0m]
[0m21:03:04.069036 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:03:04.070624 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:03:04.071268 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100' to be skipped because of status 'skipped'. 
[0m21:03:04.072093 [info ] [Thread-1 (]: 41 of 43 SKIP test not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount  [[33mSKIP[0m]
[0m21:03:04.074279 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:03:04.075810 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:03:04.076644 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe' to be skipped because of status 'skipped'. 
[0m21:03:04.077622 [info ] [Thread-1 (]: 42 of 43 SKIP test not_null_fct_monthly_zone_revenue_service_type .............. [[33mSKIP[0m]
[0m21:03:04.079506 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:03:04.080527 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:03:04.081108 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7' to be skipped because of status 'skipped'. 
[0m21:03:04.081696 [info ] [Thread-1 (]: 43 of 43 SKIP test not_null_fct_monthly_zone_revenue_total_monthly_trips ....... [[33mSKIP[0m]
[0m21:03:04.083277 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:03:04.084284 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413' to be skipped because of status 'skipped'. 
[0m21:03:04.087223 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:04.088112 [debug] [MainThread]: On master: BEGIN
[0m21:03:04.088838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:04.154812 [debug] [MainThread]: SQL status: OK in 0.066 seconds
[0m21:03:04.156052 [debug] [MainThread]: On master: COMMIT
[0m21:03:04.157049 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:04.158132 [debug] [MainThread]: On master: COMMIT
[0m21:03:04.160275 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:03:04.161406 [debug] [MainThread]: On master: Close
[0m21:03:04.169605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:04.170774 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m21:03:04.171676 [debug] [MainThread]: Connection 'test.dbt_project.unique_int_trips_trip_id.37d69d814f' was properly closed.
[0m21:03:04.172803 [info ] [MainThread]: 
[0m21:03:04.173798 [info ] [MainThread]: Finished running 1 incremental model, 2 seeds, 33 data tests, 7 view models in 0 hours 7 minutes and 29.63 seconds (449.63s).
[0m21:03:04.178869 [debug] [MainThread]: Command end result
[0m21:03:04.325456 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m21:03:04.347479 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m21:03:04.385432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m21:03:04.386997 [info ] [MainThread]: 
[0m21:03:04.388506 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m21:03:04.390088 [info ] [MainThread]: 
[0m21:03:04.392888 [error] [MainThread]: [31mFailure in test not_null_int_trips_trip_id (models/intermediate/schema.yml)[0m
[0m21:03:04.395115 [error] [MainThread]:   Runtime Error in test not_null_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m21:03:04.396949 [info ] [MainThread]: 
[0m21:03:04.399078 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/schema.yml/not_null_int_trips_trip_id.sql
[0m21:03:04.401016 [info ] [MainThread]: 
[0m21:03:04.402877 [error] [MainThread]: [31mFailure in test unique_int_trips_trip_id (models/intermediate/schema.yml)[0m
[0m21:03:04.404869 [error] [MainThread]:   Runtime Error in test unique_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m21:03:04.407110 [info ] [MainThread]: 
[0m21:03:04.409067 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/schema.yml/unique_int_trips_trip_id.sql
[0m21:03:04.411006 [info ] [MainThread]: 
[0m21:03:04.412778 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=2 SKIP=21 NO-OP=0 TOTAL=43
[0m21:03:04.418269 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 455.03568, "process_in_blocks": "0", "process_kernel_time": 188.47502, "process_mem_max_rss": "4582576", "process_out_blocks": "0", "process_user_time": 1192.8367}
[0m21:03:04.420265 [debug] [MainThread]: Command `dbt build` failed at 21:03:04.419888 after 455.04 seconds
[0m21:03:04.421766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1d2ab5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1c8c25130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f1c8c24d70>]}
[0m21:03:04.422956 [debug] [MainThread]: Flushing usage events
[0m21:03:06.098578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:17.375838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837cd3c7f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837cd3ec0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837cd7f28d0>]}


============================== 23:49:17.395576 | 72bd8643-9cac-4b99-845d-ccda92b5b498 ==============================
[0m23:49:17.395576 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:49:17.397795 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --target prod', 'debug': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'empty': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'indirect_selection': 'eager'}
[0m23:49:17.906492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837cc8df650>]}
[0m23:49:18.040701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837c4d4db80>]}
[0m23:49:18.043465 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m23:49:18.290705 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m23:49:21.721813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:21.723857 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:49:21.725708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:21.892300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837c4c34c80>]}
[0m23:49:22.236271 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:49:22.256355 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:49:22.393266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837b78768a0>]}
[0m23:49:22.395150 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m23:49:22.411037 [info ] [MainThread]: 
[0m23:49:22.413476 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:49:22.416979 [info ] [MainThread]: 
[0m23:49:22.423181 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:49:22.450778 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m23:49:22.616799 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m23:49:22.618648 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m23:49:22.619981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:22.693867 [debug] [ThreadPool]: SQL status: OK in 0.074 seconds
[0m23:49:22.696267 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m23:49:22.702646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m23:49:22.703968 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m23:49:22.712746 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m23:49:22.713826 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m23:49:22.715311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:22.785590 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m23:49:22.789729 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m23:49:22.790832 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m23:49:22.792439 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:49:22.793316 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m23:49:22.794020 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m23:49:22.795619 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:49:22.797396 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m23:49:22.798321 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m23:49:22.799078 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m23:49:22.800342 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:49:22.801262 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m23:49:22.810663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m23:49:22.819696 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m23:49:22.821216 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m23:49:22.822534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:22.895473 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m23:49:22.897065 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m23:49:22.898244 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m23:49:22.932740 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m23:49:22.938445 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m23:49:22.941817 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m23:49:22.943136 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m23:49:22.953751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837c4c37680>]}
[0m23:49:22.955524 [debug] [MainThread]: Using duckdb connection "master"
[0m23:49:22.956862 [debug] [MainThread]: On master: BEGIN
[0m23:49:22.958040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:23.041425 [debug] [MainThread]: SQL status: OK in 0.083 seconds
[0m23:49:23.042772 [debug] [MainThread]: On master: COMMIT
[0m23:49:23.043785 [debug] [MainThread]: Using duckdb connection "master"
[0m23:49:23.044628 [debug] [MainThread]: On master: COMMIT
[0m23:49:23.046043 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:49:23.047036 [debug] [MainThread]: On master: Close
[0m23:49:23.059225 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m23:49:23.060685 [info ] [Thread-1 (]: 1 of 43 START sql view model prod.stg_green_tripdata ........................... [RUN]
[0m23:49:23.061930 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_green_tripdata'
[0m23:49:23.062799 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m23:49:23.076226 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m23:49:23.097612 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m23:49:23.143933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m23:49:23.165870 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m23:49:23.167279 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m23:49:23.168417 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:49:23.256377 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m23:49:23.258681 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m23:49:23.260623 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m23:49:23.266213 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:49:23.283822 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m23:49:23.285984 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m23:49:23.290670 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:49:23.299234 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m23:49:23.300776 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m23:49:23.306579 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:49:23.345090 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m23:49:23.346898 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m23:49:23.348387 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m23:49:23.391884 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m23:49:23.407721 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m23:49:23.409004 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_backup" cascade
[0m23:49:23.415108 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:49:23.421511 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m23:49:23.997701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837cd764b00>]}
[0m23:49:23.999746 [info ] [Thread-1 (]: 1 of 43 OK created sql view model prod.stg_green_tripdata ...................... [[32mOK[0m in 0.93s]
[0m23:49:24.001753 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m23:49:24.003352 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m23:49:24.005841 [info ] [Thread-1 (]: 2 of 43 START sql view model prod.stg_yellow_tripdata .......................... [RUN]
[0m23:49:24.007916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m23:49:24.009745 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m23:49:24.016938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m23:49:24.038012 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m23:49:24.044060 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m23:49:24.063921 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m23:49:24.064852 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m23:49:24.065658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:24.133998 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m23:49:24.135592 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m23:49:24.137301 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m23:49:24.141410 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:49:24.148578 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m23:49:24.150058 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m23:49:24.152719 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:49:24.160084 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m23:49:24.161700 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m23:49:24.164247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:49:24.167707 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m23:49:24.169080 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m23:49:24.170676 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m23:49:24.211111 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m23:49:24.215694 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m23:49:24.216578 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_backup" cascade
[0m23:49:24.222138 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:49:24.225485 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m23:49:24.844455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837b6c0f950>]}
[0m23:49:24.846117 [info ] [Thread-1 (]: 2 of 43 OK created sql view model prod.stg_yellow_tripdata ..................... [[32mOK[0m in 0.84s]
[0m23:49:24.847662 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m23:49:24.848982 [debug] [Thread-1 (]: Began running node seed.dbt_project.payment_type_lookup
[0m23:49:24.850205 [info ] [Thread-1 (]: 3 of 43 START seed file prod.payment_type_lookup ............................... [RUN]
[0m23:49:24.851478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now seed.dbt_project.payment_type_lookup)
[0m23:49:24.852584 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.payment_type_lookup
[0m23:49:24.855663 [debug] [Thread-1 (]: Began executing node seed.dbt_project.payment_type_lookup
[0m23:49:25.015574 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m23:49:25.016845 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: BEGIN
[0m23:49:25.017826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:25.110079 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m23:49:25.112244 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m23:49:25.113518 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "seed.dbt_project.payment_type_lookup"} */
truncate table "taxi_rides_ny"."prod"."payment_type_lookup"
[0m23:49:25.117520 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:49:25.153254 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m23:49:25.155684 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: 
          COPY "taxi_rides_ny"."prod"."payment_type_lookup" FROM '/usr/app/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m23:49:25.185373 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m23:49:25.214051 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.payment_type_lookup"
[0m23:49:25.243802 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: COMMIT
[0m23:49:25.246053 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.payment_type_lookup"
[0m23:49:25.248487 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: COMMIT
[0m23:49:25.266539 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m23:49:25.268870 [debug] [Thread-1 (]: On seed.dbt_project.payment_type_lookup: Close
[0m23:49:25.918020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837b6cf4d40>]}
[0m23:49:25.920931 [info ] [Thread-1 (]: 3 of 43 OK loaded seed file prod.payment_type_lookup ........................... [[32mINSERT 7[0m in 1.07s]
[0m23:49:25.924061 [debug] [Thread-1 (]: Finished running node seed.dbt_project.payment_type_lookup
[0m23:49:25.926027 [debug] [Thread-1 (]: Began running node seed.dbt_project.taxi_zone_lookup
[0m23:49:25.928641 [info ] [Thread-1 (]: 4 of 43 START seed file prod.taxi_zone_lookup .................................. [RUN]
[0m23:49:25.930629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_project.payment_type_lookup, now seed.dbt_project.taxi_zone_lookup)
[0m23:49:25.932923 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.taxi_zone_lookup
[0m23:49:25.935222 [debug] [Thread-1 (]: Began executing node seed.dbt_project.taxi_zone_lookup
[0m23:49:25.973488 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m23:49:25.975349 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: BEGIN
[0m23:49:25.976808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:26.075755 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m23:49:26.077605 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m23:49:26.078968 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "seed.dbt_project.taxi_zone_lookup"} */
truncate table "taxi_rides_ny"."prod"."taxi_zone_lookup"
[0m23:49:26.082172 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:49:26.085651 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m23:49:26.086962 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: 
          COPY "taxi_rides_ny"."prod"."taxi_zone_lookup" FROM '/usr/app/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m23:49:26.113821 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m23:49:26.115929 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.taxi_zone_lookup"
[0m23:49:26.141017 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: COMMIT
[0m23:49:26.142954 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_project.taxi_zone_lookup"
[0m23:49:26.144388 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: COMMIT
[0m23:49:26.189286 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m23:49:26.192875 [debug] [Thread-1 (]: On seed.dbt_project.taxi_zone_lookup: Close
[0m23:49:26.856341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837c4c15250>]}
[0m23:49:26.858958 [info ] [Thread-1 (]: 4 of 43 OK loaded seed file prod.taxi_zone_lookup .............................. [[32mINSERT 265[0m in 0.93s]
[0m23:49:26.861883 [debug] [Thread-1 (]: Finished running node seed.dbt_project.taxi_zone_lookup
[0m23:49:26.864818 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m23:49:26.867169 [info ] [Thread-1 (]: 5 of 43 START test not_null_stg_green_tripdata_pickup_datetime ................. [RUN]
[0m23:49:26.869597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_project.taxi_zone_lookup, now test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e)
[0m23:49:26.874081 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m23:49:26.915022 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m23:49:26.946709 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m23:49:26.988502 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m23:49:27.009018 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m23:49:27.009983 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: BEGIN
[0m23:49:27.011012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:27.093577 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m23:49:27.138502 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m23:49:27.164389 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."stg_green_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m23:49:27.173954 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:49:27.181078 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: ROLLBACK
[0m23:49:27.183109 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e'
[0m23:49:27.184101 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: Close
[0m23:49:27.203820 [info ] [Thread-1 (]: 5 of 43 PASS not_null_stg_green_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.33s]
[0m23:49:27.207100 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m23:49:27.208646 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m23:49:27.210063 [info ] [Thread-1 (]: 6 of 43 START test not_null_stg_green_tripdata_vendor_id ....................... [RUN]
[0m23:49:27.211314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e, now test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493)
[0m23:49:27.212254 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m23:49:27.218747 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m23:49:27.240931 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m23:49:27.249080 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m23:49:27.279410 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m23:49:27.281716 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: BEGIN
[0m23:49:27.283268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:27.383655 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m23:49:27.385991 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m23:49:27.388283 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."stg_green_tripdata"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m23:49:27.479940 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m23:49:27.482604 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: ROLLBACK
[0m23:49:27.484264 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493'
[0m23:49:27.485106 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493: Close
[0m23:49:27.495351 [info ] [Thread-1 (]: 6 of 43 PASS not_null_stg_green_tripdata_vendor_id ............................. [[32mPASS[0m in 0.28s]
[0m23:49:27.497200 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m23:49:27.498196 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:49:27.499273 [info ] [Thread-1 (]: 7 of 43 START test not_null_stg_yellow_tripdata_pickup_datetime ................ [RUN]
[0m23:49:27.500707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_green_tripdata_vendor_id.48b68c1493, now test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44)
[0m23:49:27.501889 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:49:27.510207 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m23:49:27.532939 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:49:27.539127 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m23:49:27.566230 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m23:49:27.567825 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: BEGIN
[0m23:49:27.569256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:27.660201 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m23:49:27.662070 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m23:49:27.664000 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m23:49:27.669798 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:49:27.675651 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m23:49:27.679273 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m23:49:27.680921 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m23:49:27.692902 [info ] [Thread-1 (]: 7 of 43 PASS not_null_stg_yellow_tripdata_pickup_datetime ...................... [[32mPASS[0m in 0.19s]
[0m23:49:27.695886 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:49:27.698106 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m23:49:27.700127 [info ] [Thread-1 (]: 8 of 43 START test not_null_stg_yellow_tripdata_vendor_id ...................... [RUN]
[0m23:49:27.702078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44, now test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751)
[0m23:49:27.703782 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m23:49:27.719085 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m23:49:27.749670 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m23:49:27.756450 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m23:49:27.786145 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m23:49:27.788262 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: BEGIN
[0m23:49:27.790457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:27.893682 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m23:49:27.895684 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m23:49:27.897560 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m23:49:28.955750 [debug] [Thread-1 (]: SQL status: OK in 1.056 seconds
[0m23:49:28.959280 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: ROLLBACK
[0m23:49:28.961146 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751'
[0m23:49:28.962098 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: Close
[0m23:49:28.993732 [info ] [Thread-1 (]: 8 of 43 PASS not_null_stg_yellow_tripdata_vendor_id ............................ [[32mPASS[0m in 1.29s]
[0m23:49:28.996848 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m23:49:28.998554 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m23:49:29.000002 [info ] [Thread-1 (]: 9 of 43 START test not_null_payment_type_lookup_payment_type ................... [RUN]
[0m23:49:29.001589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751, now test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4)
[0m23:49:29.003002 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m23:49:29.015024 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m23:49:29.035915 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m23:49:29.043322 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m23:49:29.064227 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m23:49:29.065717 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: BEGIN
[0m23:49:29.066905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:29.140271 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m23:49:29.141712 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m23:49:29.143550 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type
from "taxi_rides_ny"."prod"."payment_type_lookup"
where payment_type is null



  
  
      
    ) dbt_internal_test
[0m23:49:29.147022 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:49:29.150562 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: ROLLBACK
[0m23:49:29.154484 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4'
[0m23:49:29.156525 [debug] [Thread-1 (]: On test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4: Close
[0m23:49:29.166286 [info ] [Thread-1 (]: 9 of 43 PASS not_null_payment_type_lookup_payment_type ......................... [[32mPASS[0m in 0.16s]
[0m23:49:29.168708 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m23:49:29.175540 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m23:49:29.177671 [info ] [Thread-1 (]: 10 of 43 START test unique_payment_type_lookup_payment_type .................... [RUN]
[0m23:49:29.180094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_payment_type_lookup_payment_type.51dda45cb4, now test.dbt_project.unique_payment_type_lookup_payment_type.819f837245)
[0m23:49:29.182022 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m23:49:29.204843 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m23:49:29.232697 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m23:49:29.238509 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m23:49:29.265500 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m23:49:29.267346 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: BEGIN
[0m23:49:29.269757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:29.404850 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m23:49:29.407241 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"
[0m23:49:29.409016 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_payment_type_lookup_payment_type.819f837245"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."payment_type_lookup"
where payment_type is not null
group by payment_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:49:29.423721 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m23:49:29.429581 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: ROLLBACK
[0m23:49:29.433812 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_payment_type_lookup_payment_type.819f837245'
[0m23:49:29.438797 [debug] [Thread-1 (]: On test.dbt_project.unique_payment_type_lookup_payment_type.819f837245: Close
[0m23:49:29.453381 [info ] [Thread-1 (]: 10 of 43 PASS unique_payment_type_lookup_payment_type .......................... [[32mPASS[0m in 0.27s]
[0m23:49:29.460355 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_payment_type_lookup_payment_type.819f837245
[0m23:49:29.462099 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m23:49:29.463915 [info ] [Thread-1 (]: 11 of 43 START sql view model prod.dim_zones ................................... [RUN]
[0m23:49:29.472934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_payment_type_lookup_payment_type.819f837245, now model.dbt_project.dim_zones)
[0m23:49:29.474769 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m23:49:29.523200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m23:49:29.579039 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m23:49:29.599192 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m23:49:29.620240 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m23:49:29.621864 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m23:49:29.623145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:29.688872 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m23:49:29.690168 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m23:49:29.691253 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."prod"."taxi_zone_lookup"
  );

[0m23:49:29.692914 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:49:29.697180 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m23:49:29.698144 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones" rename to "dim_zones__dbt_backup"
[0m23:49:29.700063 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:49:29.706348 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m23:49:29.708171 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m23:49:29.710790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:49:29.714557 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m23:49:29.715983 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m23:49:29.717498 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m23:49:29.755848 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m23:49:29.759895 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m23:49:29.760826 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."prod"."dim_zones__dbt_backup" cascade
[0m23:49:29.767794 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:49:29.773833 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m23:49:30.483085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837c4d65c10>]}
[0m23:49:30.485711 [info ] [Thread-1 (]: 11 of 43 OK created sql view model prod.dim_zones .............................. [[32mOK[0m in 1.02s]
[0m23:49:30.492879 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m23:49:30.495721 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m23:49:30.498629 [info ] [Thread-1 (]: 12 of 43 START sql view model prod.int_trips_unioned ........................... [RUN]
[0m23:49:30.501699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.int_trips_unioned)
[0m23:49:30.503859 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m23:49:30.519631 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m23:49:30.545723 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m23:49:30.556614 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m23:49:30.575726 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m23:49:30.576863 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m23:49:30.578151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:30.657325 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m23:49:30.659145 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m23:49:30.660665 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."prod"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m23:49:30.666337 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:49:30.674817 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m23:49:30.676411 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned" rename to "int_trips_unioned__dbt_backup"
[0m23:49:30.679089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:49:30.686659 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m23:49:30.688331 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m23:49:30.691432 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:49:30.695266 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m23:49:30.696530 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m23:49:30.697653 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m23:49:30.741573 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m23:49:30.751530 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m23:49:30.753754 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips_unioned__dbt_backup" cascade
[0m23:49:30.762871 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m23:49:30.767180 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m23:49:31.454425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837b6c0e630>]}
[0m23:49:31.456403 [info ] [Thread-1 (]: 12 of 43 OK created sql view model prod.int_trips_unioned ...................... [[32mOK[0m in 0.95s]
[0m23:49:31.458155 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m23:49:31.459719 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m23:49:31.461191 [info ] [Thread-1 (]: 13 of 43 START test not_null_dim_zones_location_id ............................. [RUN]
[0m23:49:31.462803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79)
[0m23:49:31.464120 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m23:49:31.473474 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m23:49:31.498128 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m23:49:31.505095 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m23:49:31.533571 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m23:49:31.535373 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: BEGIN
[0m23:49:31.537654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:31.625242 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m23:49:31.627067 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"
[0m23:49:31.628317 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "taxi_rides_ny"."prod"."dim_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m23:49:31.631837 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:49:31.636305 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: ROLLBACK
[0m23:49:31.640781 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79'
[0m23:49:31.642521 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79: Close
[0m23:49:31.652565 [info ] [Thread-1 (]: 13 of 43 PASS not_null_dim_zones_location_id ................................... [[32mPASS[0m in 0.19s]
[0m23:49:31.656636 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79
[0m23:49:31.659278 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m23:49:31.661428 [info ] [Thread-1 (]: 14 of 43 START test unique_dim_zones_location_id ............................... [RUN]
[0m23:49:31.663398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_zones_location_id.cbf42e7b79, now test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27)
[0m23:49:31.665844 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m23:49:31.680717 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m23:49:31.712321 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m23:49:31.718788 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m23:49:31.748621 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m23:49:31.750086 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: BEGIN
[0m23:49:31.751451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:31.837258 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m23:49:31.839452 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"
[0m23:49:31.840992 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."dim_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:49:31.851304 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m23:49:31.857521 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: ROLLBACK
[0m23:49:31.860860 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27'
[0m23:49:31.862382 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27: Close
[0m23:49:31.875643 [info ] [Thread-1 (]: 14 of 43 PASS unique_dim_zones_location_id ..................................... [[32mPASS[0m in 0.21s]
[0m23:49:31.879827 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27
[0m23:49:31.882878 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m23:49:31.886116 [info ] [Thread-1 (]: 15 of 43 START sql view model prod.int_trips ................................... [RUN]
[0m23:49:31.888922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_zones_location_id.5aa0ad7f27, now model.dbt_project.int_trips)
[0m23:49:31.891675 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m23:49:31.947606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m23:49:31.969346 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m23:49:31.976090 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m23:49:31.998928 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m23:49:32.000564 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m23:49:32.001930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:32.081746 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m23:49:32.084248 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m23:49:32.086411 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m23:49:32.098743 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m23:49:32.111583 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m23:49:32.113298 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips" rename to "int_trips__dbt_backup"
[0m23:49:32.116388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:49:32.127387 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m23:49:32.128979 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" rename to "int_trips"
[0m23:49:32.131974 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:49:32.136267 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m23:49:32.137977 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m23:49:32.139315 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m23:49:32.175729 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m23:49:32.179825 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m23:49:32.180892 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips__dbt_backup" cascade
[0m23:49:32.186717 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:49:32.190711 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m23:49:32.906493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bd8643-9cac-4b99-845d-ccda92b5b498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837b76cb980>]}
[0m23:49:32.908507 [info ] [Thread-1 (]: 15 of 43 OK created sql view model prod.int_trips .............................. [[32mOK[0m in 1.02s]
[0m23:49:32.910191 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m23:49:32.912368 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m23:49:32.914456 [info ] [Thread-1 (]: 16 of 43 START test accepted_values_int_trips_service_type__Green__Yellow ...... [RUN]
[0m23:49:32.916399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e)
[0m23:49:32.917900 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m23:49:32.934755 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m23:49:32.963077 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m23:49:32.967455 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m23:49:32.990427 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m23:49:32.992668 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: BEGIN
[0m23:49:32.993986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:33.101771 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m23:49:33.103531 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m23:49:33.105512 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."prod"."int_trips"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m23:49:33.116558 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m23:49:33.122049 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: ROLLBACK
[0m23:49:33.124983 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e'
[0m23:49:33.126598 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: Close
[0m23:49:33.133164 [info ] [Thread-1 (]: 16 of 43 PASS accepted_values_int_trips_service_type__Green__Yellow ............ [[32mPASS[0m in 0.22s]
[0m23:49:33.135597 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m23:49:33.138500 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m23:49:33.139931 [info ] [Thread-1 (]: 17 of 43 START test not_null_int_trips_pickup_datetime ......................... [RUN]
[0m23:49:33.141876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e, now test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09)
[0m23:49:33.143053 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m23:49:33.149994 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m23:49:33.172138 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m23:49:33.177851 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m23:49:33.204383 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m23:49:33.206388 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: BEGIN
[0m23:49:33.207713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:33.296090 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m23:49:33.298282 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m23:49:33.299936 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."int_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m23:49:33.321385 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m23:49:33.325975 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: ROLLBACK
[0m23:49:33.328484 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09'
[0m23:49:33.330003 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09: Close
[0m23:49:33.345700 [info ] [Thread-1 (]: 17 of 43 PASS not_null_int_trips_pickup_datetime ............................... [[32mPASS[0m in 0.20s]
[0m23:49:33.349033 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m23:49:33.351183 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m23:49:33.353151 [info ] [Thread-1 (]: 18 of 43 START test not_null_int_trips_service_type ............................ [RUN]
[0m23:49:33.355702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_pickup_datetime.e4fa5f3e09, now test.dbt_project.not_null_int_trips_service_type.f38e150f53)
[0m23:49:33.357766 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m23:49:33.370588 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m23:49:33.395572 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m23:49:33.400707 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m23:49:33.424740 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m23:49:33.425735 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: BEGIN
[0m23:49:33.426718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:33.515872 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m23:49:33.517385 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_service_type.f38e150f53"
[0m23:49:33.518743 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_service_type.f38e150f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."prod"."int_trips"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m23:49:33.527008 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m23:49:33.530282 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: ROLLBACK
[0m23:49:33.532965 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_service_type.f38e150f53'
[0m23:49:33.534205 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_service_type.f38e150f53: Close
[0m23:49:33.542865 [info ] [Thread-1 (]: 18 of 43 PASS not_null_int_trips_service_type .................................. [[32mPASS[0m in 0.19s]
[0m23:49:33.545388 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_service_type.f38e150f53
[0m23:49:33.547004 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m23:49:33.548166 [info ] [Thread-1 (]: 19 of 43 START test not_null_int_trips_total_amount ............................ [RUN]
[0m23:49:33.549534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_service_type.f38e150f53, now test.dbt_project.not_null_int_trips_total_amount.ec933efa9b)
[0m23:49:33.551038 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m23:49:33.563910 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m23:49:33.590695 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m23:49:33.600819 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m23:49:33.624179 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m23:49:33.625364 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: BEGIN
[0m23:49:33.626378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:33.687005 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m23:49:33.688572 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"
[0m23:49:33.689559 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_total_amount.ec933efa9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "taxi_rides_ny"."prod"."int_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m23:49:33.695465 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:49:33.698254 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: ROLLBACK
[0m23:49:33.700007 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_total_amount.ec933efa9b'
[0m23:49:33.700828 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_total_amount.ec933efa9b: Close
[0m23:49:33.707682 [info ] [Thread-1 (]: 19 of 43 PASS not_null_int_trips_total_amount .................................. [[32mPASS[0m in 0.16s]
[0m23:49:33.709699 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_total_amount.ec933efa9b
[0m23:49:33.711154 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m23:49:33.712398 [info ] [Thread-1 (]: 20 of 43 START test not_null_int_trips_trip_id ................................. [RUN]
[0m23:49:33.713689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_total_amount.ec933efa9b, now test.dbt_project.not_null_int_trips_trip_id.9edd5fee61)
[0m23:49:33.714747 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m23:49:33.724969 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m23:49:33.751155 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m23:49:33.759648 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m23:49:33.787556 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m23:49:33.789187 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: BEGIN
[0m23:49:33.790280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:33.878872 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m23:49:33.880713 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"
[0m23:49:33.882520 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."prod"."int_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m23:52:41.025737 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_trip_id.9edd5fee61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."prod"."int_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m23:52:41.027732 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:52:41.029108 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: ROLLBACK
[0m23:52:41.037521 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_trip_id.9edd5fee61'
[0m23:52:41.038954 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_trip_id.9edd5fee61: Close
[0m23:52:41.421345 [debug] [Thread-1 (]: Runtime Error in test not_null_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m23:52:41.423112 [error] [Thread-1 (]: 20 of 43 ERROR not_null_int_trips_trip_id ...................................... [[31mERROR[0m in 187.71s]
[0m23:52:41.425227 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_trip_id.9edd5fee61
[0m23:52:41.426320 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m23:52:41.427115 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_int_trips_trip_id.9edd5fee61' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads.
[0m23:52:41.427864 [info ] [Thread-1 (]: 21 of 43 START test not_null_int_trips_vendor_id ............................... [RUN]
[0m23:52:41.430511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_trip_id.9edd5fee61, now test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c)
[0m23:52:41.431992 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m23:52:41.441647 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m23:52:41.470066 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m23:52:41.475146 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m23:52:41.497418 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m23:52:41.499128 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: BEGIN
[0m23:52:41.500622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:41.561555 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m23:52:41.563009 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"
[0m23:52:41.564636 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."int_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m23:52:51.000671 [debug] [Thread-1 (]: SQL status: OK in 9.435 seconds
[0m23:52:51.003912 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: ROLLBACK
[0m23:52:51.005400 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c'
[0m23:52:51.006225 [debug] [Thread-1 (]: On test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c: Close
[0m23:52:51.257213 [info ] [Thread-1 (]: 21 of 43 PASS not_null_int_trips_vendor_id ..................................... [[32mPASS[0m in 9.83s]
[0m23:52:51.258873 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c
[0m23:52:51.260114 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m23:52:51.261188 [info ] [Thread-1 (]: 22 of 43 START test unique_int_trips_trip_id ................................... [RUN]
[0m23:52:51.262429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_int_trips_vendor_id.c9ac94714c, now test.dbt_project.unique_int_trips_trip_id.37d69d814f)
[0m23:52:51.266361 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m23:52:51.275198 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m23:52:51.296673 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m23:52:51.301983 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m23:52:51.323907 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m23:52:51.325115 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: BEGIN
[0m23:52:51.326065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:51.403314 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m23:52:51.404802 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_int_trips_trip_id.37d69d814f"
[0m23:52:51.405912 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_int_trips_trip_id.37d69d814f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."int_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:55:44.720559 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "test.dbt_project.unique_int_trips_trip_id.37d69d814f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."int_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:55:44.722565 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:55:44.724268 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: ROLLBACK
[0m23:55:44.728589 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_int_trips_trip_id.37d69d814f'
[0m23:55:44.729741 [debug] [Thread-1 (]: On test.dbt_project.unique_int_trips_trip_id.37d69d814f: Close
[0m23:55:45.251687 [debug] [Thread-1 (]: Runtime Error in test unique_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m23:55:45.253618 [error] [Thread-1 (]: 22 of 43 ERROR unique_int_trips_trip_id ........................................ [[31mERROR[0m in 173.99s]
[0m23:55:45.255373 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_int_trips_trip_id.37d69d814f
[0m23:55:45.257270 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.unique_int_trips_trip_id.37d69d814f' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads.
[0m23:55:45.261664 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m23:55:45.264138 [info ] [Thread-1 (]: 23 of 43 SKIP relation prod.fct_trips .......................................... [[33mSKIP[0m]
[0m23:55:45.267126 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m23:55:45.268586 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_trips' to be skipped because of status 'skipped'. 
[0m23:55:45.271519 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m23:55:45.275967 [info ] [Thread-1 (]: 24 of 43 SKIP test accepted_values_fct_trips_service_type__Green__Yellow ....... [[33mSKIP[0m]
[0m23:55:45.277891 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m23:55:45.279685 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83
[0m23:55:45.280620 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c' to be skipped because of status 'skipped'. 
[0m23:55:45.281742 [info ] [Thread-1 (]: 25 of 43 SKIP test not_null_fct_trips_pickup_datetime .......................... [[33mSKIP[0m]
[0m23:55:45.283778 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83
[0m23:55:45.285480 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f
[0m23:55:45.286262 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_pickup_datetime.3c78164d83' to be skipped because of status 'skipped'. 
[0m23:55:45.287138 [info ] [Thread-1 (]: 26 of 43 SKIP test not_null_fct_trips_service_type ............................. [[33mSKIP[0m]
[0m23:55:45.289209 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f
[0m23:55:45.294232 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d
[0m23:55:45.295437 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_service_type.f7d55d2d8f' to be skipped because of status 'skipped'. 
[0m23:55:45.297747 [info ] [Thread-1 (]: 27 of 43 SKIP test not_null_fct_trips_total_amount ............................. [[33mSKIP[0m]
[0m23:55:45.300719 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d
[0m23:55:45.302247 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d
[0m23:55:45.303009 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_total_amount.0e8ec5477d' to be skipped because of status 'skipped'. 
[0m23:55:45.303951 [info ] [Thread-1 (]: 28 of 43 SKIP test not_null_fct_trips_trip_id .................................. [[33mSKIP[0m]
[0m23:55:45.309583 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d
[0m23:55:45.311456 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb
[0m23:55:45.312495 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_trip_id.df65bf8c1d' to be skipped because of status 'skipped'. 
[0m23:55:45.313846 [info ] [Thread-1 (]: 29 of 43 SKIP test not_null_fct_trips_vendor_id ................................ [[33mSKIP[0m]
[0m23:55:45.338767 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb
[0m23:55:45.348212 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m23:55:45.349323 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_trips_vendor_id.b9b2f380bb' to be skipped because of status 'skipped'. 
[0m23:55:45.350477 [info ] [Thread-1 (]: 30 of 43 SKIP test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_  [[33mSKIP[0m]
[0m23:55:45.354528 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m23:55:45.361585 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m23:55:45.362854 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68' to be skipped because of status 'skipped'. 
[0m23:55:45.413968 [info ] [Thread-1 (]: 31 of 43 SKIP test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_  [[33mSKIP[0m]
[0m23:55:45.530494 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m23:55:45.568231 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab
[0m23:55:45.569174 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4' to be skipped because of status 'skipped'. 
[0m23:55:45.609424 [info ] [Thread-1 (]: 32 of 43 SKIP test unique_fct_trips_trip_id .................................... [[33mSKIP[0m]
[0m23:55:45.647364 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab
[0m23:55:45.651937 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.unique_fct_trips_trip_id.9b74cb6aab' to be skipped because of status 'skipped'. 
[0m23:55:45.703240 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m23:55:45.734287 [info ] [Thread-1 (]: 33 of 43 SKIP relation prod.dim_vendors ........................................ [[33mSKIP[0m]
[0m23:55:45.745276 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m23:55:45.747853 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m23:55:45.748741 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.dim_vendors' to be skipped because of status 'skipped'. 
[0m23:55:45.751868 [info ] [Thread-1 (]: 34 of 43 SKIP relation prod.fct_monthly_zone_revenue ........................... [[33mSKIP[0m]
[0m23:55:45.754113 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m23:55:45.759520 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580
[0m23:55:45.760556 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_monthly_zone_revenue' to be skipped because of status 'skipped'. 
[0m23:55:45.761707 [info ] [Thread-1 (]: 35 of 43 SKIP test not_null_dim_vendors_vendor_id .............................. [[33mSKIP[0m]
[0m23:55:45.765911 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580
[0m23:55:45.767430 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141
[0m23:55:45.768565 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_dim_vendors_vendor_id.a23aa97580' to be skipped because of status 'skipped'. 
[0m23:55:45.769905 [info ] [Thread-1 (]: 36 of 43 SKIP test unique_dim_vendors_vendor_id ................................ [[33mSKIP[0m]
[0m23:55:45.772709 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141
[0m23:55:45.777556 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m23:55:45.778641 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.unique_dim_vendors_vendor_id.8a24aa2141' to be skipped because of status 'skipped'. 
[0m23:55:45.779795 [info ] [Thread-1 (]: 37 of 43 SKIP test accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow  [[33mSKIP[0m]
[0m23:55:45.782356 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m23:55:45.783798 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m23:55:45.784543 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6' to be skipped because of status 'skipped'. 
[0m23:55:45.785489 [info ] [Thread-1 (]: 38 of 43 SKIP test dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type  [[33mSKIP[0m]
[0m23:55:45.787158 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m23:55:45.788939 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m23:55:45.789847 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751' to be skipped because of status 'skipped'. 
[0m23:55:45.792690 [info ] [Thread-1 (]: 39 of 43 SKIP test not_null_fct_monthly_zone_revenue_pickup_zone ............... [[33mSKIP[0m]
[0m23:55:45.795692 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m23:55:45.797919 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m23:55:45.798900 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709' to be skipped because of status 'skipped'. 
[0m23:55:45.799918 [info ] [Thread-1 (]: 40 of 43 SKIP test not_null_fct_monthly_zone_revenue_revenue_month ............. [[33mSKIP[0m]
[0m23:55:45.802396 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m23:55:45.803907 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m23:55:45.804832 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100' to be skipped because of status 'skipped'. 
[0m23:55:45.809649 [info ] [Thread-1 (]: 41 of 43 SKIP test not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount  [[33mSKIP[0m]
[0m23:55:45.813216 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m23:55:45.815640 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m23:55:45.816504 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe' to be skipped because of status 'skipped'. 
[0m23:55:45.817456 [info ] [Thread-1 (]: 42 of 43 SKIP test not_null_fct_monthly_zone_revenue_service_type .............. [[33mSKIP[0m]
[0m23:55:45.820791 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m23:55:45.822312 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m23:55:45.823118 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7' to be skipped because of status 'skipped'. 
[0m23:55:45.826319 [info ] [Thread-1 (]: 43 of 43 SKIP test not_null_fct_monthly_zone_revenue_total_monthly_trips ....... [[33mSKIP[0m]
[0m23:55:45.831439 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m23:55:45.833008 [debug] [Thread-4 (]: Marking all children of 'test.dbt_project.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413' to be skipped because of status 'skipped'. 
[0m23:55:45.837843 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:45.839273 [debug] [MainThread]: On master: BEGIN
[0m23:55:45.844406 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:55:45.950138 [debug] [MainThread]: SQL status: OK in 0.106 seconds
[0m23:55:45.951388 [debug] [MainThread]: On master: COMMIT
[0m23:55:45.952297 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:45.952956 [debug] [MainThread]: On master: COMMIT
[0m23:55:45.954747 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:55:45.956174 [debug] [MainThread]: On master: Close
[0m23:55:45.964314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:45.965692 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m23:55:45.966548 [debug] [MainThread]: Connection 'test.dbt_project.unique_int_trips_trip_id.37d69d814f' was properly closed.
[0m23:55:45.967550 [info ] [MainThread]: 
[0m23:55:45.968554 [info ] [MainThread]: Finished running 1 incremental model, 2 seeds, 33 data tests, 7 view models in 0 hours 6 minutes and 23.55 seconds (383.55s).
[0m23:55:45.981091 [debug] [MainThread]: Command end result
[0m23:55:46.116093 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m23:55:46.143784 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m23:55:46.167223 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m23:55:46.168250 [info ] [MainThread]: 
[0m23:55:46.169202 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:55:46.170116 [info ] [MainThread]: 
[0m23:55:46.171233 [error] [MainThread]: [31mFailure in test not_null_int_trips_trip_id (models/intermediate/schema.yml)[0m
[0m23:55:46.172532 [error] [MainThread]:   Runtime Error in test not_null_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m23:55:46.175455 [info ] [MainThread]: 
[0m23:55:46.177166 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/schema.yml/not_null_int_trips_trip_id.sql
[0m23:55:46.178616 [info ] [MainThread]: 
[0m23:55:46.180311 [error] [MainThread]: [31mFailure in test unique_int_trips_trip_id (models/intermediate/schema.yml)[0m
[0m23:55:46.181818 [error] [MainThread]:   Runtime Error in test unique_int_trips_trip_id (models/intermediate/schema.yml)
  Out of Memory Error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m23:55:46.183137 [info ] [MainThread]: 
[0m23:55:46.185101 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/schema.yml/unique_int_trips_trip_id.sql
[0m23:55:46.186477 [info ] [MainThread]: 
[0m23:55:46.189145 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=2 SKIP=21 NO-OP=0 TOTAL=43
[0m23:55:46.194751 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 389.09818, "process_in_blocks": "0", "process_kernel_time": 144.74663, "process_mem_max_rss": "4693476", "process_out_blocks": "0", "process_user_time": 956.6576}
[0m23:55:46.196878 [debug] [MainThread]: Command `dbt build` failed at 23:55:46.196574 after 389.10 seconds
[0m23:55:46.198818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837ccc60fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837cd1e0f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837cc8d17c0>]}
[0m23:55:46.200760 [debug] [MainThread]: Flushing usage events
[0m23:55:47.072218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:04:34.838933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab23cc2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab231052b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab22c7dac0>]}


============================== 00:04:34.884019 | 5267a9f6-a9fa-4c8f-ba96-ce69643f9a45 ==============================
[0m00:04:34.884019 [info ] [MainThread]: Running with dbt=1.11.6
[0m00:04:34.886395 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'quiet': 'False', 'warn_error': 'None', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --target prod', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'empty': 'False'}
[0m00:04:35.305034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab1ab10fe0>]}
[0m00:04:35.421528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab22f29100>]}
[0m00:04:35.423527 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m00:04:35.680333 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m00:04:38.424864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:38.426198 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:04:38.427235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:38.576437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab1aa49460>]}
[0m00:04:38.905789 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:04:38.924260 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:04:39.000717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab1977a240>]}
[0m00:04:39.002321 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m00:04:39.004530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab197973e0>]}
[0m00:04:39.012147 [info ] [MainThread]: 
[0m00:04:39.014105 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:04:39.015844 [info ] [MainThread]: 
[0m00:04:39.018359 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:04:39.040346 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m00:04:39.138571 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m00:04:39.140082 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m00:04:39.141665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:39.247751 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m00:04:39.277694 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m00:04:39.288651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m00:04:39.290466 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m00:04:39.312554 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m00:04:39.314613 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m00:04:39.316211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:39.416936 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m00:04:39.421146 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m00:04:39.422247 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m00:04:39.424110 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:04:39.425422 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m00:04:39.426283 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m00:04:39.428143 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:04:39.430821 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m00:04:39.432020 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m00:04:39.433083 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m00:04:39.435129 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:04:39.436248 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m00:04:39.452976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m00:04:39.468912 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m00:04:39.470450 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m00:04:39.471796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:39.537536 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m00:04:39.538828 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m00:04:39.540166 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m00:04:39.574443 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m00:04:39.580198 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m00:04:39.584142 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m00:04:39.585710 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m00:04:39.599057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab2277fb60>]}
[0m00:04:39.600953 [debug] [MainThread]: Using duckdb connection "master"
[0m00:04:39.602245 [debug] [MainThread]: On master: BEGIN
[0m00:04:39.603420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:04:39.692936 [debug] [MainThread]: SQL status: OK in 0.089 seconds
[0m00:04:39.695943 [debug] [MainThread]: On master: COMMIT
[0m00:04:39.697643 [debug] [MainThread]: Using duckdb connection "master"
[0m00:04:39.699024 [debug] [MainThread]: On master: COMMIT
[0m00:04:39.701367 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:04:39.702586 [debug] [MainThread]: On master: Close
[0m00:04:39.722474 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m00:04:39.724727 [info ] [Thread-1 (]: 1 of 8 START sql view model prod.dim_zones ..................................... [RUN]
[0m00:04:39.726963 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m00:04:39.730374 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m00:04:39.755322 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m00:04:39.784308 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m00:04:39.855338 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m00:04:39.881565 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:04:39.883074 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m00:04:39.884418 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:04:39.987162 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m00:04:39.988820 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:04:39.990355 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."prod"."taxi_zone_lookup"
  );

[0m00:04:39.993098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:40.007853 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:04:40.009443 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones" rename to "dim_zones__dbt_backup"
[0m00:04:40.013262 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:04:40.023620 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:04:40.025306 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m00:04:40.028723 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:04:40.055975 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m00:04:40.057368 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:04:40.058490 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m00:04:40.098787 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m00:04:40.120249 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:04:40.122123 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."prod"."dim_zones__dbt_backup" cascade
[0m00:04:40.131243 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:04:40.139496 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m00:04:40.866403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab226ac920>]}
[0m00:04:40.869539 [info ] [Thread-1 (]: 1 of 8 OK created sql view model prod.dim_zones ................................ [[32mOK[0m in 1.14s]
[0m00:04:40.872909 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m00:04:40.875168 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m00:04:40.877142 [info ] [Thread-1 (]: 2 of 8 START sql view model prod.stg_green_tripdata ............................ [RUN]
[0m00:04:40.878995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.stg_green_tripdata)
[0m00:04:40.881199 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m00:04:40.902966 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m00:04:40.930670 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m00:04:40.944459 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m00:04:40.973815 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:04:40.975363 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m00:04:40.976544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:41.074208 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m00:04:41.075944 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:04:41.077551 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m00:04:41.081578 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:04:41.092113 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:04:41.093887 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m00:04:41.096868 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:41.106560 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:04:41.108014 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m00:04:41.110588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:41.113585 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m00:04:41.115394 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:04:41.116911 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m00:04:41.158271 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m00:04:41.165625 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:04:41.167267 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_backup" cascade
[0m00:04:41.174285 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:04:41.178560 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m00:04:41.850710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab18bd2e40>]}
[0m00:04:41.853780 [info ] [Thread-1 (]: 2 of 8 OK created sql view model prod.stg_green_tripdata ....................... [[32mOK[0m in 0.97s]
[0m00:04:41.856223 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m00:04:41.857993 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m00:04:41.859626 [info ] [Thread-1 (]: 3 of 8 START sql view model prod.stg_yellow_tripdata ........................... [RUN]
[0m00:04:41.861157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m00:04:41.862360 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m00:04:41.871283 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m00:04:41.893310 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m00:04:41.901368 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m00:04:41.923811 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:04:41.925472 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m00:04:41.926922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:42.021352 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m00:04:42.023057 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:04:42.024685 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m00:04:42.028657 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:04:42.037014 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:04:42.038987 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m00:04:42.042310 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:04:42.049820 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:04:42.051314 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m00:04:42.055414 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:04:42.059430 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m00:04:42.060958 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:04:42.062240 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m00:04:42.075839 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m00:04:42.082455 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:04:42.083855 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_backup" cascade
[0m00:04:42.091822 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:04:42.095818 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m00:04:42.670696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab18c65c10>]}
[0m00:04:42.674149 [info ] [Thread-1 (]: 3 of 8 OK created sql view model prod.stg_yellow_tripdata ...................... [[32mOK[0m in 0.81s]
[0m00:04:42.676981 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m00:04:42.680880 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m00:04:42.682489 [info ] [Thread-1 (]: 4 of 8 START sql view model prod.int_trips_unioned ............................. [RUN]
[0m00:04:42.684364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now model.dbt_project.int_trips_unioned)
[0m00:04:42.687377 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m00:04:42.704032 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m00:04:42.727767 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m00:04:42.810875 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m00:04:42.832881 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:04:42.834599 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m00:04:42.836422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:42.929051 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m00:04:42.930391 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:04:42.931402 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."prod"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m00:04:42.937441 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:04:42.945988 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:04:42.947966 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned" rename to "int_trips_unioned__dbt_backup"
[0m00:04:42.951141 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:04:42.960085 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:04:42.962068 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m00:04:42.964920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:42.971479 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m00:04:42.973092 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:04:42.974570 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m00:04:43.013064 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m00:04:43.022387 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:04:43.024048 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips_unioned__dbt_backup" cascade
[0m00:04:43.031038 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:04:43.035471 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m00:04:43.720677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caaf4d5b470>]}
[0m00:04:43.723586 [info ] [Thread-1 (]: 4 of 8 OK created sql view model prod.int_trips_unioned ........................ [[32mOK[0m in 1.04s]
[0m00:04:43.726459 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m00:04:43.730710 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m00:04:43.732703 [info ] [Thread-1 (]: 5 of 8 START sql view model prod.int_trips ..................................... [RUN]
[0m00:04:43.734872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now model.dbt_project.int_trips)
[0m00:04:43.737435 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m00:04:43.783374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m00:04:43.810029 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m00:04:43.817430 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m00:04:43.835396 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:04:43.836799 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m00:04:43.838001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:43.914645 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m00:04:43.916407 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:04:43.917830 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m00:04:43.923707 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:04:43.928478 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:04:43.929276 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips" rename to "int_trips__dbt_backup"
[0m00:04:43.930623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:43.938967 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:04:43.940355 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" rename to "int_trips"
[0m00:04:43.942498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:43.945728 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m00:04:43.947020 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:04:43.948204 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m00:04:43.988022 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m00:04:43.992270 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:04:43.993632 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips__dbt_backup" cascade
[0m00:04:44.001264 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:04:44.004395 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m00:04:44.617129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab18b925d0>]}
[0m00:04:44.622029 [info ] [Thread-1 (]: 5 of 8 OK created sql view model prod.int_trips ................................ [[32mOK[0m in 0.88s]
[0m00:04:44.625303 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m00:04:44.629216 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m00:04:44.631536 [info ] [Thread-1 (]: 6 of 8 START sql incremental model prod.fct_trips .............................. [RUN]
[0m00:04:44.633662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now model.dbt_project.fct_trips)
[0m00:04:44.638203 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_trips
[0m00:04:44.672948 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_trips"
[0m00:04:44.697414 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_trips
[0m00:04:44.829231 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m00:04:44.830781 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:04:44.832452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:44.940662 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m00:04:44.984926 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m00:04:44.988794 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m00:04:44.990863 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as TEXT)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as TEXT)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as TEXT)
 as pickup_borough, 
      
    cast(null as TEXT)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as TEXT)
 as dropoff_borough, 
      
    cast(null as TEXT)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as TEXT)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as TEXT)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:04:44.995208 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:04:45.054368 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_trips"
[0m00:04:45.083751 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m00:04:45.085677 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: BEGIN
[0m00:04:45.088564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:04:45.090070 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m00:04:45.092457 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."prod"."fct_trips"
  
  (
    trip_id TEXT,
    vendor_id integer,
    service_type TEXT,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough TEXT,
    pickup_zone TEXT,
    dropoff_location_id integer,
    dropoff_borough TEXT,
    dropoff_zone TEXT,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag TEXT,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description TEXT
    
    )
 ;
    insert into "taxi_rides_ny"."prod"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m00:08:56.241714 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."prod"."fct_trips"
  
  (
    trip_id TEXT,
    vendor_id integer,
    service_type TEXT,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough TEXT,
    pickup_zone TEXT,
    dropoff_location_id integer,
    dropoff_borough TEXT,
    dropoff_zone TEXT,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag TEXT,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description TEXT
    
    )
 ;
    insert into "taxi_rides_ny"."prod"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m00:08:56.275508 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:08:56.278500 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: ROLLBACK
[0m00:08:56.291114 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.fct_trips'
[0m00:08:56.293049 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: Close
[0m00:08:56.563713 [debug] [Thread-1 (]: Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m00:08:56.565288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5267a9f6-a9fa-4c8f-ba96-ce69643f9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab18bdbec0>]}
[0m00:08:56.566660 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model prod.fct_trips ..................... [[31mERROR[0m in 251.93s]
[0m00:08:56.567947 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m00:08:56.569546 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_trips' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads.
[0m00:08:56.575596 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m00:08:56.577398 [info ] [Thread-1 (]: 7 of 8 SKIP relation prod.dim_vendors .......................................... [[33mSKIP[0m]
[0m00:08:56.580468 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m00:08:56.582649 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m00:08:56.585409 [info ] [Thread-1 (]: 8 of 8 SKIP relation prod.fct_monthly_zone_revenue ............................. [[33mSKIP[0m]
[0m00:08:56.587740 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m00:08:56.594807 [debug] [MainThread]: Using duckdb connection "master"
[0m00:08:56.596978 [debug] [MainThread]: On master: BEGIN
[0m00:08:56.598786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:08:56.708577 [debug] [MainThread]: SQL status: OK in 0.110 seconds
[0m00:08:56.710071 [debug] [MainThread]: On master: COMMIT
[0m00:08:56.711474 [debug] [MainThread]: Using duckdb connection "master"
[0m00:08:56.713038 [debug] [MainThread]: On master: COMMIT
[0m00:08:56.715412 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:08:56.716807 [debug] [MainThread]: On master: Close
[0m00:08:56.724890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:56.726311 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m00:08:56.727407 [debug] [MainThread]: Connection 'model.dbt_project.fct_trips' was properly closed.
[0m00:08:56.730839 [info ] [MainThread]: 
[0m00:08:56.732619 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 4 minutes and 17.71 seconds (257.71s).
[0m00:08:56.737572 [debug] [MainThread]: Command end result
[0m00:08:56.907905 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:08:56.925028 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:08:56.956754 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:08:56.958306 [info ] [MainThread]: 
[0m00:08:56.959840 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:08:56.962481 [info ] [MainThread]: 
[0m00:08:56.965317 [error] [MainThread]: [31mFailure in model fct_trips (models/marts/reporting/fct_trips.sql)[0m
[0m00:08:56.968109 [error] [MainThread]:   Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m00:08:56.970296 [info ] [MainThread]: 
[0m00:08:56.972533 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/reporting/fct_trips.sql
[0m00:08:56.974218 [info ] [MainThread]: 
[0m00:08:56.976494 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=8
[0m00:08:56.983502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 262.42728, "process_in_blocks": "152", "process_kernel_time": 85.50663, "process_mem_max_rss": "4523960", "process_out_blocks": "0", "process_user_time": 709.61224}
[0m00:08:56.985736 [debug] [MainThread]: Command `dbt run` failed at 00:08:56.985406 after 262.43 seconds
[0m00:08:56.987526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab22f01ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab243b59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cab243b51c0>]}
[0m00:08:56.989101 [debug] [MainThread]: Flushing usage events
[0m00:08:58.063352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:38.081385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d81043710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d806dd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d80d4da30>]}


============================== 00:29:38.102595 | 994a7b72-a2d9-4a5c-9f9f-0b523a4c087d ==============================
[0m00:29:38.102595 [info ] [MainThread]: Running with dbt=1.11.6
[0m00:29:38.104941 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --target prod', 'log_format': 'default', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'printer_width': '80', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'static_parser': 'True'}
[0m00:29:38.889589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d805dde80>]}
[0m00:29:38.989724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d801507a0>]}
[0m00:29:38.992805 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m00:29:39.220561 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m00:29:43.189996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:29:43.191395 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:29:43.192468 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:29:43.273071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d785341a0>]}
[0m00:29:43.535042 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:29:43.581320 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:29:43.688302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d5b2ed280>]}
[0m00:29:43.690133 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m00:29:43.691446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d78518bf0>]}
[0m00:29:43.698412 [info ] [MainThread]: 
[0m00:29:43.699904 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:29:43.701443 [info ] [MainThread]: 
[0m00:29:43.705315 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:29:43.716564 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m00:29:43.801415 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m00:29:43.802594 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m00:29:43.803400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:43.924785 [debug] [ThreadPool]: SQL status: OK in 0.121 seconds
[0m00:29:43.929113 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m00:29:43.940232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m00:29:43.942075 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m00:29:43.957316 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m00:29:43.958902 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m00:29:43.960032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:44.092790 [debug] [ThreadPool]: SQL status: OK in 0.133 seconds
[0m00:29:44.097194 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m00:29:44.098499 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m00:29:44.101036 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:29:44.102342 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m00:29:44.103610 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m00:29:44.106289 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:29:44.109348 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m00:29:44.111049 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m00:29:44.112437 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m00:29:44.114696 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:29:44.116044 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m00:29:44.128929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m00:29:44.144758 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m00:29:44.146695 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m00:29:44.147987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:44.258626 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m00:29:44.260231 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m00:29:44.261671 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m00:29:44.316994 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m00:29:44.321635 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m00:29:44.327099 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m00:29:44.328960 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m00:29:44.341876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d8021e9c0>]}
[0m00:29:44.343995 [debug] [MainThread]: Using duckdb connection "master"
[0m00:29:44.345881 [debug] [MainThread]: On master: BEGIN
[0m00:29:44.347552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:44.460897 [debug] [MainThread]: SQL status: OK in 0.113 seconds
[0m00:29:44.462451 [debug] [MainThread]: On master: COMMIT
[0m00:29:44.463972 [debug] [MainThread]: Using duckdb connection "master"
[0m00:29:44.465379 [debug] [MainThread]: On master: COMMIT
[0m00:29:44.467386 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:29:44.468968 [debug] [MainThread]: On master: Close
[0m00:29:44.512395 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m00:29:44.513906 [info ] [Thread-1 (]: 1 of 8 START sql view model prod.dim_zones ..................................... [RUN]
[0m00:29:44.515556 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m00:29:44.516729 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m00:29:44.530302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m00:29:44.551971 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m00:29:44.605339 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m00:29:44.651252 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:29:44.652923 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m00:29:44.654331 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:29:44.790352 [debug] [Thread-1 (]: SQL status: OK in 0.136 seconds
[0m00:29:44.791876 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:29:44.794860 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."prod"."taxi_zone_lookup"
  );

[0m00:29:44.804670 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m00:29:44.819349 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:29:44.820981 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones" rename to "dim_zones__dbt_backup"
[0m00:29:44.824040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:29:44.829896 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:29:44.831104 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m00:29:44.833127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:29:44.855233 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m00:29:44.856660 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:29:44.857826 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m00:29:44.869762 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m00:29:44.876860 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m00:29:44.878091 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."prod"."dim_zones__dbt_backup" cascade
[0m00:29:44.883404 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:29:44.886647 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m00:29:45.475205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d5a6ca660>]}
[0m00:29:45.477213 [info ] [Thread-1 (]: 1 of 8 OK created sql view model prod.dim_zones ................................ [[32mOK[0m in 0.96s]
[0m00:29:45.478887 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m00:29:45.479961 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m00:29:45.481128 [info ] [Thread-1 (]: 2 of 8 START sql view model prod.stg_green_tripdata ............................ [RUN]
[0m00:29:45.482367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.stg_green_tripdata)
[0m00:29:45.483501 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m00:29:45.495290 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m00:29:45.515432 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m00:29:45.524389 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m00:29:45.544334 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:29:45.545783 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m00:29:45.546743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:45.628444 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m00:29:45.629818 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:29:45.630858 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m00:29:45.632899 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:29:45.637049 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:29:45.637898 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m00:29:45.639369 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:29:45.644935 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:29:45.646272 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m00:29:45.648557 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:29:45.650781 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m00:29:45.652084 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:29:45.653055 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m00:29:45.694494 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m00:29:45.698514 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m00:29:45.699572 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_backup" cascade
[0m00:29:45.706769 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:29:45.709811 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m00:29:46.382295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d80174860>]}
[0m00:29:46.385055 [info ] [Thread-1 (]: 2 of 8 OK created sql view model prod.stg_green_tripdata ....................... [[32mOK[0m in 0.90s]
[0m00:29:46.387445 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m00:29:46.389667 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m00:29:46.391778 [info ] [Thread-1 (]: 3 of 8 START sql view model prod.stg_yellow_tripdata ........................... [RUN]
[0m00:29:46.395266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m00:29:46.398128 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m00:29:46.409724 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m00:29:46.435452 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m00:29:46.462286 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m00:29:46.486683 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:29:46.488235 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m00:29:46.489562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:46.566183 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m00:29:46.567616 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:29:46.569760 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m00:29:46.574017 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:29:46.584404 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:29:46.586057 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m00:29:46.588970 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:29:46.597733 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:29:46.599151 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m00:29:46.601447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:29:46.603434 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m00:29:46.604382 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:29:46.605280 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m00:29:46.645642 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m00:29:46.651767 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m00:29:46.653390 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_backup" cascade
[0m00:29:46.659988 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:29:46.663199 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m00:29:47.346361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d5a639c40>]}
[0m00:29:47.348858 [info ] [Thread-1 (]: 3 of 8 OK created sql view model prod.stg_yellow_tripdata ...................... [[32mOK[0m in 0.95s]
[0m00:29:47.351139 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m00:29:47.354530 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m00:29:47.356213 [info ] [Thread-1 (]: 4 of 8 START sql view model prod.int_trips_unioned ............................. [RUN]
[0m00:29:47.361173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now model.dbt_project.int_trips_unioned)
[0m00:29:47.363451 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m00:29:47.381112 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m00:29:47.439951 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m00:29:47.546102 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m00:29:47.564586 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:29:47.565966 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m00:29:47.567086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:47.650829 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m00:29:47.652768 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:29:47.654425 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."prod"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m00:29:47.661812 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:29:47.670594 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:29:47.672358 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned" rename to "int_trips_unioned__dbt_backup"
[0m00:29:47.675962 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:29:47.684302 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:29:47.686567 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m00:29:47.689823 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:29:47.695702 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m00:29:47.697715 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:29:47.699280 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m00:29:47.745433 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m00:29:47.752581 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m00:29:47.754239 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips_unioned__dbt_backup" cascade
[0m00:29:47.762372 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:29:47.766661 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m00:29:48.448583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d5a63a210>]}
[0m00:29:48.451366 [info ] [Thread-1 (]: 4 of 8 OK created sql view model prod.int_trips_unioned ........................ [[32mOK[0m in 1.09s]
[0m00:29:48.453647 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m00:29:48.456708 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m00:29:48.459733 [info ] [Thread-1 (]: 5 of 8 START sql view model prod.int_trips ..................................... [RUN]
[0m00:29:48.462288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now model.dbt_project.int_trips)
[0m00:29:48.464277 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m00:29:48.517589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m00:29:48.545572 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m00:29:48.554590 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m00:29:48.581527 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:29:48.582961 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m00:29:48.584218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:48.677219 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m00:29:48.679129 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:29:48.680626 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m00:29:48.688785 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:29:48.697584 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:29:48.699331 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips" rename to "int_trips__dbt_backup"
[0m00:29:48.702326 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:29:48.713415 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:29:48.715385 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" rename to "int_trips"
[0m00:29:48.718568 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:29:48.722250 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m00:29:48.724023 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:29:48.726182 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m00:29:48.774166 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m00:29:48.782301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m00:29:48.784088 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips__dbt_backup" cascade
[0m00:29:48.793859 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m00:29:48.799225 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m00:29:49.647095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d5a6c81a0>]}
[0m00:29:49.649794 [info ] [Thread-1 (]: 5 of 8 OK created sql view model prod.int_trips ................................ [[32mOK[0m in 1.18s]
[0m00:29:49.652288 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m00:29:49.654709 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m00:29:49.656726 [info ] [Thread-1 (]: 6 of 8 START sql incremental model prod.fct_trips .............................. [RUN]
[0m00:29:49.658573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now model.dbt_project.fct_trips)
[0m00:29:49.660154 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_trips
[0m00:29:49.687998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_trips"
[0m00:29:49.714886 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_trips
[0m00:29:49.844816 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m00:29:49.846678 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:29:49.848347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:49.945705 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m00:29:49.984084 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m00:29:49.986391 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m00:29:49.988184 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as TEXT)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as TEXT)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as TEXT)
 as pickup_borough, 
      
    cast(null as TEXT)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as TEXT)
 as dropoff_borough, 
      
    cast(null as TEXT)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as TEXT)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as TEXT)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:29:49.993300 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:29:50.035964 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_trips"
[0m00:29:50.063676 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m00:29:50.065068 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: BEGIN
[0m00:29:50.067321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:29:50.068527 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m00:29:50.069814 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."prod"."fct_trips"
  
  (
    trip_id TEXT,
    vendor_id integer,
    service_type TEXT,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough TEXT,
    pickup_zone TEXT,
    dropoff_location_id integer,
    dropoff_borough TEXT,
    dropoff_zone TEXT,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag TEXT,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description TEXT
    
    )
 ;
    insert into "taxi_rides_ny"."prod"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m00:34:35.118964 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."prod"."fct_trips"
  
  (
    trip_id TEXT,
    vendor_id integer,
    service_type TEXT,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough TEXT,
    pickup_zone TEXT,
    dropoff_location_id integer,
    dropoff_borough TEXT,
    dropoff_zone TEXT,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag TEXT,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description TEXT
    
    )
 ;
    insert into "taxi_rides_ny"."prod"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m00:34:35.122030 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:34:35.125941 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: ROLLBACK
[0m00:34:35.149495 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.fct_trips'
[0m00:34:35.151062 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: Close
[0m00:34:35.546042 [debug] [Thread-1 (]: Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m00:34:35.548243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '994a7b72-a2d9-4a5c-9f9f-0b523a4c087d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d5b03a3f0>]}
[0m00:34:35.550246 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model prod.fct_trips ..................... [[31mERROR[0m in 285.89s]
[0m00:34:35.552532 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m00:34:35.554546 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_trips' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads.
[0m00:34:35.560240 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m00:34:35.561751 [info ] [Thread-1 (]: 7 of 8 SKIP relation prod.dim_vendors .......................................... [[33mSKIP[0m]
[0m00:34:35.564229 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m00:34:35.565832 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m00:34:35.567375 [info ] [Thread-1 (]: 8 of 8 SKIP relation prod.fct_monthly_zone_revenue ............................. [[33mSKIP[0m]
[0m00:34:35.569206 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m00:34:35.577602 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:35.578971 [debug] [MainThread]: On master: BEGIN
[0m00:34:35.580261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:34:35.672713 [debug] [MainThread]: SQL status: OK in 0.092 seconds
[0m00:34:35.674555 [debug] [MainThread]: On master: COMMIT
[0m00:34:35.676061 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:35.677391 [debug] [MainThread]: On master: COMMIT
[0m00:34:35.679314 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:35.680580 [debug] [MainThread]: On master: Close
[0m00:34:35.688590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:35.691401 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m00:34:35.692538 [debug] [MainThread]: Connection 'model.dbt_project.fct_trips' was properly closed.
[0m00:34:35.693730 [info ] [MainThread]: 
[0m00:34:35.695052 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 4 minutes and 51.99 seconds (291.99s).
[0m00:34:35.698929 [debug] [MainThread]: Command end result
[0m00:34:35.858702 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m00:34:35.875932 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m00:34:35.907835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m00:34:35.909445 [info ] [MainThread]: 
[0m00:34:35.911646 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:34:35.913577 [info ] [MainThread]: 
[0m00:34:35.915288 [error] [MainThread]: [31mFailure in model fct_trips (models/marts/reporting/fct_trips.sql)[0m
[0m00:34:35.917421 [error] [MainThread]:   Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  Out of Memory Error: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m00:34:35.921625 [info ] [MainThread]: 
[0m00:34:35.926768 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/reporting/fct_trips.sql
[0m00:34:35.928861 [info ] [MainThread]: 
[0m00:34:35.931962 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=8
[0m00:34:35.939053 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 298.15494, "process_in_blocks": "176784", "process_kernel_time": 93.3755, "process_mem_max_rss": "4521980", "process_out_blocks": "0", "process_user_time": 748.5983}
[0m00:34:35.942789 [debug] [MainThread]: Command `dbt run` failed at 00:34:35.942194 after 298.16 seconds
[0m00:34:35.944713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d806dd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d5a78f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8d5a7bd010>]}
[0m00:34:35.946533 [debug] [MainThread]: Flushing usage events
[0m00:34:36.901410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:14.001082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d6da5ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d6d642960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d6d6437a0>]}


============================== 01:06:14.019113 | 58e84f35-58f7-49ae-91f3-96965c9492e2 ==============================
[0m01:06:14.019113 [info ] [MainThread]: Running with dbt=1.11.6
[0m01:06:14.021964 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/logs', 'static_parser': 'True', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'write_json': 'True', 'empty': 'False', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run -t prod', 'version_check': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False'}
[0m01:06:14.827104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d6ff59160>]}
[0m01:06:14.981979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d657f6d80>]}
[0m01:06:14.985181 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m01:06:15.314027 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m01:06:15.659097 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:06:15.660771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d6446a270>]}
[0m01:06:24.874107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d46eee3c0>]}
[0m01:06:25.192313 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:06:25.209006 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:06:25.302208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d4705f770>]}
[0m01:06:25.303599 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m01:06:25.304860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d47049550>]}
[0m01:06:25.311692 [info ] [MainThread]: 
[0m01:06:25.313254 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:06:25.316806 [info ] [MainThread]: 
[0m01:06:25.319049 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:06:25.332919 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m01:06:25.451604 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m01:06:25.453611 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m01:06:25.455064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:27.335686 [debug] [ThreadPool]: SQL status: OK in 1.881 seconds
[0m01:06:27.341140 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m01:06:27.355709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m01:06:27.357405 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m01:06:27.392264 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:06:27.399143 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m01:06:27.404966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:27.512861 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m01:06:27.519097 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:06:27.520711 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m01:06:27.523459 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:06:27.524926 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:06:27.526016 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m01:06:27.528538 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:06:27.531530 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m01:06:27.533830 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:06:27.535478 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m01:06:27.538229 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:06:27.539826 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m01:06:27.558803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m01:06:27.582899 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m01:06:27.584961 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m01:06:27.586744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:27.684163 [debug] [ThreadPool]: SQL status: OK in 0.098 seconds
[0m01:06:27.685822 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m01:06:27.687107 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m01:06:27.730957 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m01:06:27.738325 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m01:06:27.743294 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m01:06:27.744789 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m01:06:27.761317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d470378c0>]}
[0m01:06:27.763572 [debug] [MainThread]: Using duckdb connection "master"
[0m01:06:27.764832 [debug] [MainThread]: On master: BEGIN
[0m01:06:27.766918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:06:27.875107 [debug] [MainThread]: SQL status: OK in 0.108 seconds
[0m01:06:27.876949 [debug] [MainThread]: On master: COMMIT
[0m01:06:27.878523 [debug] [MainThread]: Using duckdb connection "master"
[0m01:06:27.879613 [debug] [MainThread]: On master: COMMIT
[0m01:06:27.881682 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:06:27.883517 [debug] [MainThread]: On master: Close
[0m01:06:27.908017 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m01:06:27.909817 [info ] [Thread-1 (]: 1 of 8 START sql view model prod.dim_zones ..................................... [RUN]
[0m01:06:27.912253 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m01:06:27.914038 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m01:06:27.936813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m01:06:27.971794 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m01:06:28.085726 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m01:06:28.119190 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:06:28.120832 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m01:06:28.122266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:06:28.211653 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m01:06:28.213420 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:06:28.215121 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."prod"."taxi_zone_lookup"
  );

[0m01:06:28.218261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:06:28.235464 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:06:28.237279 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones" rename to "dim_zones__dbt_backup"
[0m01:06:28.240114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:06:28.248710 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:06:28.250915 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m01:06:28.253446 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:06:28.296603 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m01:06:28.299150 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:06:28.301267 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m01:06:28.315908 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m01:06:28.330684 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:06:28.334075 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."prod"."dim_zones__dbt_backup" cascade
[0m01:06:28.342084 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:06:28.352981 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m01:06:29.501450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d464ae9f0>]}
[0m01:06:29.503995 [info ] [Thread-1 (]: 1 of 8 OK created sql view model prod.dim_zones ................................ [[32mOK[0m in 1.59s]
[0m01:06:29.507553 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m01:06:29.509555 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m01:06:29.512158 [info ] [Thread-1 (]: 2 of 8 START sql view model prod.stg_green_tripdata ............................ [RUN]
[0m01:06:29.516147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.stg_green_tripdata)
[0m01:06:29.518858 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m01:06:29.535591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m01:06:29.564505 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m01:06:29.574276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m01:06:29.605472 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:06:29.607006 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m01:06:29.608505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:29.720345 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m01:06:29.722083 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:06:29.723839 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m01:06:29.728645 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:06:29.739537 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:06:29.741418 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m01:06:29.744986 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:06:29.758538 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:06:29.760086 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m01:06:29.762638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:06:29.769762 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m01:06:29.772398 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:06:29.774350 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m01:06:29.795340 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m01:06:29.809776 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:06:29.811559 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_backup" cascade
[0m01:06:29.821904 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m01:06:29.826522 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m01:06:30.813818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d463a59a0>]}
[0m01:06:30.817388 [info ] [Thread-1 (]: 2 of 8 OK created sql view model prod.stg_green_tripdata ....................... [[32mOK[0m in 1.30s]
[0m01:06:30.820093 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m01:06:30.821910 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m01:06:30.824301 [info ] [Thread-1 (]: 3 of 8 START sql view model prod.stg_yellow_tripdata ........................... [RUN]
[0m01:06:30.829568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m01:06:30.835299 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m01:06:30.851291 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m01:06:30.873864 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m01:06:30.885663 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m01:06:30.915362 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:06:30.917211 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m01:06:30.918663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:31.015641 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m01:06:31.018376 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:06:31.020285 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m01:06:31.024531 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:06:31.037888 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:06:31.039755 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m01:06:31.043801 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:06:31.058904 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:06:31.061230 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m01:06:31.064486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:06:31.071719 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m01:06:31.074638 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:06:31.076422 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m01:06:31.094028 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m01:06:31.102991 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:06:31.104660 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_backup" cascade
[0m01:06:31.111646 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:06:31.119288 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m01:06:32.272270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d4648b2c0>]}
[0m01:06:32.274882 [info ] [Thread-1 (]: 3 of 8 OK created sql view model prod.stg_yellow_tripdata ...................... [[32mOK[0m in 1.45s]
[0m01:06:32.278116 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m01:06:32.281760 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m01:06:32.283890 [info ] [Thread-1 (]: 4 of 8 START sql view model prod.int_trips_unioned ............................. [RUN]
[0m01:06:32.285548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now model.dbt_project.int_trips_unioned)
[0m01:06:32.287010 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m01:06:32.300044 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m01:06:32.324563 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m01:06:32.335520 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m01:06:32.366174 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:06:32.367664 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m01:06:32.369234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:32.472500 [debug] [Thread-1 (]: SQL status: OK in 0.103 seconds
[0m01:06:32.473985 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:06:32.475493 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."prod"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m01:06:32.486146 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m01:06:32.501331 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:06:32.503276 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned" rename to "int_trips_unioned__dbt_backup"
[0m01:06:32.506621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:06:32.521784 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:06:32.523691 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m01:06:32.526908 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:06:32.533261 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m01:06:32.535289 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:06:32.536515 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m01:06:32.553711 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m01:06:32.559860 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:06:32.561295 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips_unioned__dbt_backup" cascade
[0m01:06:32.567568 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:06:32.571225 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m01:06:33.510313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d463e9610>]}
[0m01:06:33.513171 [info ] [Thread-1 (]: 4 of 8 OK created sql view model prod.int_trips_unioned ........................ [[32mOK[0m in 1.22s]
[0m01:06:33.516898 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m01:06:33.525772 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m01:06:33.528705 [info ] [Thread-1 (]: 5 of 8 START sql view model prod.int_trips ..................................... [RUN]
[0m01:06:33.531931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now model.dbt_project.int_trips)
[0m01:06:33.533935 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m01:06:33.555841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m01:06:33.586081 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m01:06:33.594874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m01:06:33.656306 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m01:06:33.658808 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m01:06:33.660658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:33.937743 [debug] [Thread-1 (]: SQL status: OK in 0.277 seconds
[0m01:06:33.940739 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m01:06:33.947378 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
  create view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" as (
    -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
  );

[0m01:06:33.983839 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m01:06:34.040091 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m01:06:34.044577 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips" rename to "int_trips__dbt_backup"
[0m01:06:34.060500 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:06:34.099370 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m01:06:34.106269 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips__dbt_tmp" rename to "int_trips"
[0m01:06:34.116432 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:06:34.135867 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m01:06:34.145539 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m01:06:34.150504 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m01:06:34.187683 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m01:06:34.211055 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m01:06:34.214796 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips__dbt_backup" cascade
[0m01:06:34.226767 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m01:06:34.235195 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m01:06:35.261151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d4648b830>]}
[0m01:06:35.263465 [info ] [Thread-1 (]: 5 of 8 OK created sql view model prod.int_trips ................................ [[32mOK[0m in 1.73s]
[0m01:06:35.265794 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m01:06:35.269299 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m01:06:35.271546 [info ] [Thread-1 (]: 6 of 8 START sql incremental model prod.fct_trips .............................. [RUN]
[0m01:06:35.273856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips, now model.dbt_project.fct_trips)
[0m01:06:35.275903 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_trips
[0m01:06:35.295058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_trips"
[0m01:06:35.326104 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_trips
[0m01:06:35.481558 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m01:06:35.483679 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as __dbt_sbq
    where false
    limit 0
)
[0m01:06:35.486961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:35.608230 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m01:06:35.667000 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m01:06:35.684318 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m01:06:35.692123 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as TEXT)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as TEXT)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as TEXT)
 as pickup_borough, 
      
    cast(null as TEXT)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as TEXT)
 as dropoff_borough, 
      
    cast(null as TEXT)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as TEXT)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as TEXT)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m01:06:35.698119 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:06:35.796503 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_trips"
[0m01:06:35.831212 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m01:06:35.832613 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: BEGIN
[0m01:06:35.835449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:06:35.838222 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m01:06:35.840702 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."prod"."fct_trips"
  
  (
    trip_id TEXT,
    vendor_id integer,
    service_type TEXT,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough TEXT,
    pickup_zone TEXT,
    dropoff_location_id integer,
    dropoff_borough TEXT,
    dropoff_zone TEXT,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag TEXT,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description TEXT
    
    )
 ;
    insert into "taxi_rides_ny"."prod"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m01:12:46.781806 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."prod"."fct_trips"
  
  (
    trip_id TEXT,
    vendor_id integer,
    service_type TEXT,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough TEXT,
    pickup_zone TEXT,
    dropoff_location_id integer,
    dropoff_borough TEXT,
    dropoff_zone TEXT,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag TEXT,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description TEXT
    
    )
 ;
    insert into "taxi_rides_ny"."prod"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m01:12:46.786796 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:12:46.789308 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: ROLLBACK
[0m01:12:46.812410 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.fct_trips'
[0m01:12:46.813854 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: Close
[0m01:12:47.291829 [debug] [Thread-1 (]: Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  Out of Memory Error: failed to pin block of size 256.0 KiB (11.1 GiB/11.1 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m01:12:47.295518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58e84f35-58f7-49ae-91f3-96965c9492e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d4638b800>]}
[0m01:12:47.299387 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model prod.fct_trips ..................... [[31mERROR[0m in 372.02s]
[0m01:12:47.302962 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m01:12:47.306230 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_trips' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  Out of Memory Error: failed to pin block of size 256.0 KiB (11.1 GiB/11.1 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads.
[0m01:12:47.314036 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_vendors
[0m01:12:47.316009 [info ] [Thread-1 (]: 7 of 8 SKIP relation prod.dim_vendors .......................................... [[33mSKIP[0m]
[0m01:12:47.319283 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_vendors
[0m01:12:47.322217 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m01:12:47.325958 [info ] [Thread-1 (]: 8 of 8 SKIP relation prod.fct_monthly_zone_revenue ............................. [[33mSKIP[0m]
[0m01:12:47.332872 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m01:12:47.348612 [debug] [MainThread]: Using duckdb connection "master"
[0m01:12:47.351618 [debug] [MainThread]: On master: BEGIN
[0m01:12:47.353719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:12:47.537299 [debug] [MainThread]: SQL status: OK in 0.184 seconds
[0m01:12:47.539047 [debug] [MainThread]: On master: COMMIT
[0m01:12:47.540545 [debug] [MainThread]: Using duckdb connection "master"
[0m01:12:47.542056 [debug] [MainThread]: On master: COMMIT
[0m01:12:47.545195 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:12:47.546835 [debug] [MainThread]: On master: Close
[0m01:12:47.560289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:12:47.562056 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m01:12:47.563459 [debug] [MainThread]: Connection 'model.dbt_project.fct_trips' was properly closed.
[0m01:12:47.566410 [info ] [MainThread]: 
[0m01:12:47.571682 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 6 minutes and 22.25 seconds (382.25s).
[0m01:12:47.578906 [debug] [MainThread]: Command end result
[0m01:12:47.832661 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:12:47.860233 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:12:47.900835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m01:12:47.903097 [info ] [MainThread]: 
[0m01:12:47.906386 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:12:47.908824 [info ] [MainThread]: 
[0m01:12:47.911723 [error] [MainThread]: [31mFailure in model fct_trips (models/marts/reporting/fct_trips.sql)[0m
[0m01:12:47.920847 [error] [MainThread]:   Runtime Error in model fct_trips (models/marts/reporting/fct_trips.sql)
  Out of Memory Error: failed to pin block of size 256.0 KiB (11.1 GiB/11.1 GiB used)
  
  Possible solutions:
  * Reducing the number of threads (SET threads=X)
  * Disabling insertion-order preservation (SET preserve_insertion_order=false)
  * Increasing the memory limit (SET memory_limit='...GB')
  
  See also https://duckdb.org/docs/stable/guides/performance/how_to_tune_workloads
[0m01:12:47.923650 [info ] [MainThread]: 
[0m01:12:47.926159 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/reporting/fct_trips.sql
[0m01:12:47.928390 [info ] [MainThread]: 
[0m01:12:47.930669 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=8
[0m01:12:47.941346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 394.44458, "process_in_blocks": "184128", "process_kernel_time": 241.88557, "process_mem_max_rss": "13124736", "process_out_blocks": "41840", "process_user_time": 1083.1788}
[0m01:12:47.944532 [debug] [MainThread]: Command `dbt run` failed at 01:12:47.944034 after 394.45 seconds
[0m01:12:47.946930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d6d7de270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d64507320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d6d6dc9e0>]}
[0m01:12:47.948715 [debug] [MainThread]: Flushing usage events
[0m01:12:48.838100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:38:13.883659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c755014ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c754fc0fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7550870d40>]}


============================== 01:38:13.899525 | 7a5fcfe0-2a50-4771-8755-549ad1f80bdb ==============================
[0m01:38:13.899525 [info ] [MainThread]: Running with dbt=1.11.6
[0m01:38:13.902128 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'static_parser': 'True', 'invocation_command': 'dbt run -t prod', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'no_print': 'None'}
[0m01:38:14.421828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7552421070>]}
[0m01:38:14.584709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c754f84a660>]}
[0m01:38:14.587234 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m01:38:14.891795 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m01:38:15.397825 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:38:15.411443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c754f843380>]}
[0m01:38:26.499979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c75455f86b0>]}
[0m01:38:26.909420 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:38:26.927365 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:38:27.017675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c75456198b0>]}
[0m01:38:27.019834 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m01:38:27.021466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c75456058b0>]}
[0m01:38:27.028641 [info ] [MainThread]: 
[0m01:38:27.030638 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:38:27.033359 [info ] [MainThread]: 
[0m01:38:27.036678 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:38:27.056455 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m01:38:27.197234 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m01:38:27.199877 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m01:38:27.202179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:27.344416 [debug] [ThreadPool]: SQL status: OK in 0.142 seconds
[0m01:38:27.354757 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m01:38:27.376631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m01:38:27.380865 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m01:38:27.425709 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:38:27.435887 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m01:38:27.439469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:38:27.584838 [debug] [ThreadPool]: SQL status: OK in 0.145 seconds
[0m01:38:27.592485 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:38:27.596157 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m01:38:27.600909 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:38:27.604090 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:38:27.606614 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m01:38:27.610913 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:38:27.614097 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m01:38:27.619721 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:38:27.622504 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m01:38:27.626075 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:38:27.628371 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m01:38:27.652093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m01:38:27.668803 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m01:38:27.670362 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m01:38:27.671516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:38:27.783270 [debug] [ThreadPool]: SQL status: OK in 0.112 seconds
[0m01:38:27.785555 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m01:38:27.787472 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m01:38:27.828492 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m01:38:27.836205 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m01:38:27.839717 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m01:38:27.841446 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m01:38:27.858508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7545607890>]}
[0m01:38:27.860451 [debug] [MainThread]: Using duckdb connection "master"
[0m01:38:27.862056 [debug] [MainThread]: On master: BEGIN
[0m01:38:27.863165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:38:27.972331 [debug] [MainThread]: SQL status: OK in 0.109 seconds
[0m01:38:27.974337 [debug] [MainThread]: On master: COMMIT
[0m01:38:27.976028 [debug] [MainThread]: Using duckdb connection "master"
[0m01:38:27.977949 [debug] [MainThread]: On master: COMMIT
[0m01:38:27.981253 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:38:27.983882 [debug] [MainThread]: On master: Close
[0m01:38:28.007395 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_zones
[0m01:38:28.009656 [info ] [Thread-1 (]: 1 of 8 START sql view model prod.dim_zones ..................................... [RUN]
[0m01:38:28.013338 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.dim_zones'
[0m01:38:28.018282 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_zones
[0m01:38:28.046565 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_zones"
[0m01:38:28.080469 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_zones
[0m01:38:28.191707 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_zones"
[0m01:38:28.232167 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:38:28.235735 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: BEGIN
[0m01:38:28.237932 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:38:28.367518 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m01:38:28.373081 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:38:28.375363 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */

  
  create view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" as (
    -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."prod"."taxi_zone_lookup"
  );

[0m01:38:28.381522 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:38:28.416456 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:38:28.420206 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones" rename to "dim_zones__dbt_backup"
[0m01:38:28.424537 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:38:28.439860 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:38:28.442328 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
alter view "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m01:38:28.446383 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:38:28.505354 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m01:38:28.507324 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:38:28.509049 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: COMMIT
[0m01:38:28.528406 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m01:38:28.557065 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.dim_zones"
[0m01:38:28.559172 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.dim_zones"} */
drop view if exists "taxi_rides_ny"."prod"."dim_zones__dbt_backup" cascade
[0m01:38:28.570029 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m01:38:28.580324 [debug] [Thread-1 (]: On model.dbt_project.dim_zones: Close
[0m01:38:29.672399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c75456071d0>]}
[0m01:38:29.675170 [info ] [Thread-1 (]: 1 of 8 OK created sql view model prod.dim_zones ................................ [[32mOK[0m in 1.66s]
[0m01:38:29.678812 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_zones
[0m01:38:29.680694 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_green_tripdata
[0m01:38:29.684237 [info ] [Thread-1 (]: 2 of 8 START sql view model prod.stg_green_tripdata ............................ [RUN]
[0m01:38:29.689314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_zones, now model.dbt_project.stg_green_tripdata)
[0m01:38:29.691223 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_green_tripdata
[0m01:38:29.709600 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_green_tripdata"
[0m01:38:29.747703 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_green_tripdata
[0m01:38:29.768163 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_green_tripdata"
[0m01:38:29.799645 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:38:29.802095 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: BEGIN
[0m01:38:29.804420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:29.921533 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m01:38:29.923725 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:38:29.925904 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        
    
        cast(ratecodeid as integer)
    
 as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        
    
        cast(trip_type as integer)
    
 as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        
    
        cast(payment_type as integer)
    
 as payment_type
    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m01:38:29.938385 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m01:38:29.950689 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:38:29.953367 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata" rename to "stg_green_tripdata__dbt_backup"
[0m01:38:29.957062 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:38:29.967961 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:38:29.970377 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m01:38:29.973953 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:38:29.978953 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m01:38:29.980920 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:38:29.984494 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: COMMIT
[0m01:38:30.006028 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m01:38:30.023506 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_green_tripdata"
[0m01:38:30.025843 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_green_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_backup" cascade
[0m01:38:30.039604 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m01:38:30.045434 [debug] [Thread-1 (]: On model.dbt_project.stg_green_tripdata: Close
[0m01:38:31.117964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7544975910>]}
[0m01:38:31.120401 [info ] [Thread-1 (]: 2 of 8 OK created sql view model prod.stg_green_tripdata ....................... [[32mOK[0m in 1.43s]
[0m01:38:31.122557 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_green_tripdata
[0m01:38:31.124460 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_yellow_tripdata
[0m01:38:31.128570 [info ] [Thread-1 (]: 3 of 8 START sql view model prod.stg_yellow_tripdata ........................... [RUN]
[0m01:38:31.131594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_green_tripdata, now model.dbt_project.stg_yellow_tripdata)
[0m01:38:31.134515 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_yellow_tripdata
[0m01:38:31.145541 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_yellow_tripdata"
[0m01:38:31.173264 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_yellow_tripdata
[0m01:38:31.184065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_yellow_tripdata"
[0m01:38:31.217532 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:38:31.219109 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: BEGIN
[0m01:38:31.220464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:31.318031 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m01:38:31.319933 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:38:31.321496 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(store_and_fwd_flag as string) as store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m01:38:31.324772 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:38:31.334152 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:38:31.335642 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m01:38:31.338418 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:38:31.345680 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:38:31.347060 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m01:38:31.350630 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:38:31.355111 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m01:38:31.356552 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:38:31.358024 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: COMMIT
[0m01:38:31.374199 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m01:38:31.381294 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_yellow_tripdata"
[0m01:38:31.385770 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_yellow_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_backup" cascade
[0m01:38:31.392994 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:38:31.396493 [debug] [Thread-1 (]: On model.dbt_project.stg_yellow_tripdata: Close
[0m01:38:32.432963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7544a6f7d0>]}
[0m01:38:32.436402 [info ] [Thread-1 (]: 3 of 8 OK created sql view model prod.stg_yellow_tripdata ...................... [[32mOK[0m in 1.30s]
[0m01:38:32.439446 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_yellow_tripdata
[0m01:38:32.443348 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips_unioned
[0m01:38:32.445909 [info ] [Thread-1 (]: 4 of 8 START sql view model prod.int_trips_unioned ............................. [RUN]
[0m01:38:32.454055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_yellow_tripdata, now model.dbt_project.int_trips_unioned)
[0m01:38:32.456536 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips_unioned
[0m01:38:32.473507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips_unioned"
[0m01:38:32.506221 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips_unioned
[0m01:38:32.525673 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips_unioned"
[0m01:38:32.558420 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:38:32.560081 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: BEGIN
[0m01:38:32.561456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:32.659955 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m01:38:32.661485 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:38:32.663159 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */

  
  create view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" as (
    -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."prod"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        cast(1 as integer) as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
  );

[0m01:38:32.670255 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:38:32.684843 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:38:32.686728 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned" rename to "int_trips_unioned__dbt_backup"
[0m01:38:32.689969 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:38:32.699631 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:38:32.703091 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
alter view "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m01:38:32.706498 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:38:32.710229 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m01:38:32.711654 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:38:32.712949 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: COMMIT
[0m01:38:32.729981 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m01:38:32.739816 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips_unioned"
[0m01:38:32.741265 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips_unioned"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips_unioned__dbt_backup" cascade
[0m01:38:32.748371 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:38:32.753656 [debug] [Thread-1 (]: On model.dbt_project.int_trips_unioned: Close
[0m01:38:33.931942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5fcfe0-2a50-4771-8755-549ad1f80bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7544a6f7a0>]}
[0m01:38:33.935770 [info ] [Thread-1 (]: 4 of 8 OK created sql view model prod.int_trips_unioned ........................ [[32mOK[0m in 1.48s]
[0m01:38:33.944490 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips_unioned
[0m01:38:33.949669 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m01:38:33.952575 [info ] [Thread-1 (]: 5 of 8 START sql table model prod.int_trips .................................... [RUN]
[0m01:38:33.955938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_trips_unioned, now model.dbt_project.int_trips)
[0m01:38:33.963173 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m01:38:33.988546 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m01:38:34.052161 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m01:38:34.154432 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m01:38:34.189442 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m01:38:34.195618 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m01:38:34.198166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:34.333528 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m01:38:34.336666 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m01:38:34.340854 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."int_trips__dbt_tmp"
  
    as (
      

-- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
    );
  
  
[0m01:48:15.677663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m01:48:16.070604 [debug] [MainThread]: DuckDB adapter: cancelling query on connection model.dbt_project.int_trips. Details: Connection(type='duckdb', name='model.dbt_project.int_trips', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x7c754494fcb0>, _credentials=DuckDBCredentials(database='taxi_rides_ny', schema='prod', path='taxi_rides_ny.duckdb', config_options=None, extensions=('parquet',), settings={'memory_limit': '18GB', 'preserve_insertion_order': False}, external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=False, module_paths=None, retries=None))
[0m01:48:16.090666 [debug] [MainThread]: DuckDB adapter: query cancelled on connection model.dbt_project.int_trips
[0m01:48:16.110773 [error] [MainThread]: CANCEL query list_taxi_rides_ny_prod ........................................... [[31mCANCEL[0m]
[0m01:48:16.138789 [error] [MainThread]: CANCEL query model.dbt_project.int_trips ....................................... [[31mCANCEL[0m]
[0m01:48:18.258376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:48:18.261270 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m01:48:18.265711 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was left open.
[0m01:48:18.269572 [debug] [MainThread]: On model.dbt_project.int_trips: ROLLBACK
[0m01:48:18.404076 [debug] [MainThread]: Failed to rollback 'model.dbt_project.int_trips'
[0m01:48:18.408428 [debug] [MainThread]: On model.dbt_project.int_trips: Close
[0m01:48:18.471743 [info ] [MainThread]: 
[0m01:48:18.492622 [info ] [MainThread]: Finished running 4 view models in 0 hours 9 minutes and 51.39 seconds (591.39s).
[0m01:48:18.518459 [error] [MainThread]: Encountered an error:

[0m01:48:18.556834 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 443, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 333, in run_queue
    self.handle_job_queue(pool, callback)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run.py", line 865, in handle_job_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/graph/queue.py", line 136, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/local/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 408, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 626, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 563, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 476, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 434, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.12/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.12/threading.py", line 1149, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.12/threading.py", line 1169, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m01:48:18.753984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 605.3433, "process_in_blocks": "7239312", "process_kernel_time": 547.3874, "process_mem_max_rss": "15282936", "process_out_blocks": "0", "process_user_time": 1264.3676}
[0m01:48:18.804506 [debug] [MainThread]: Command `dbt run` failed at 01:48:18.797634 after 605.42 seconds
[0m01:48:18.863258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c755011c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7546a1ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7545619a60>]}
[0m01:48:18.898041 [debug] [MainThread]: Flushing usage events
[0m01:49:14.825216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a7456bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a72829a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a728281d0>]}


============================== 01:49:14.839032 | 84939935-0475-4113-9ff8-3cb8dea198f0 ==============================
[0m01:49:14.839032 [info ] [MainThread]: Running with dbt=1.11.6
[0m01:49:14.840464 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -t prod -s int_trips --full-refresh', 'quiet': 'False', 'empty': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m01:49:15.409155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84939935-0475-4113-9ff8-3cb8dea198f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a6dab5460>]}
[0m01:49:15.524640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84939935-0475-4113-9ff8-3cb8dea198f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a75dd6a80>]}
[0m01:49:15.528185 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m01:49:15.805014 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m01:49:19.137960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:19.139424 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:49:19.140528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:19.219873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84939935-0475-4113-9ff8-3cb8dea198f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a71d69550>]}
[0m01:49:19.451049 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:49:19.468619 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:49:19.547589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84939935-0475-4113-9ff8-3cb8dea198f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a69956870>]}
[0m01:49:19.548983 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m01:49:19.549952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84939935-0475-4113-9ff8-3cb8dea198f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a6db3d190>]}
[0m01:49:19.554494 [info ] [MainThread]: 
[0m01:49:19.555581 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:49:19.556542 [info ] [MainThread]: 
[0m01:49:19.558325 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:49:19.560500 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m01:49:19.647461 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m01:49:19.648891 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m01:49:19.650254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:19.769702 [debug] [ThreadPool]: SQL status: OK in 0.119 seconds
[0m01:49:19.772414 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m01:49:19.781132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m01:49:19.782528 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m01:49:19.792991 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:49:19.794310 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m01:49:19.795279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:49:19.882574 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m01:49:19.889513 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:49:19.891162 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m01:49:19.893344 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:49:19.894086 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:49:19.895195 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m01:49:19.898342 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:49:19.900857 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m01:49:19.901976 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m01:49:19.902948 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m01:49:19.904595 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:49:19.905618 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m01:49:19.921039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m01:49:19.931792 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m01:49:19.933301 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m01:49:19.934264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:49:19.999389 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m01:49:20.001371 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m01:49:20.002636 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m01:49:20.026810 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m01:49:20.029782 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m01:49:20.033221 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m01:49:20.034470 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m01:49:20.042859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84939935-0475-4113-9ff8-3cb8dea198f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a71514a10>]}
[0m01:49:20.044413 [debug] [MainThread]: Using duckdb connection "master"
[0m01:49:20.045394 [debug] [MainThread]: On master: BEGIN
[0m01:49:20.046231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:49:20.121364 [debug] [MainThread]: SQL status: OK in 0.075 seconds
[0m01:49:20.122813 [debug] [MainThread]: On master: COMMIT
[0m01:49:20.124022 [debug] [MainThread]: Using duckdb connection "master"
[0m01:49:20.125205 [debug] [MainThread]: On master: COMMIT
[0m01:49:20.126885 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:49:20.128068 [debug] [MainThread]: On master: Close
[0m01:49:20.143951 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m01:49:20.145784 [info ] [Thread-1 (]: 1 of 1 START sql table model prod.int_trips .................................... [RUN]
[0m01:49:20.147188 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.int_trips'
[0m01:49:20.148287 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m01:49:20.186318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m01:49:20.218444 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m01:49:20.280040 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m01:49:20.306244 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m01:49:20.307574 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m01:49:20.308804 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:49:20.408282 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m01:49:20.409580 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m01:49:20.410795 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."int_trips__dbt_tmp"
  
    as (
      

-- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
    );
  
  
[0m01:50:44.931945 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."int_trips__dbt_tmp"
  
    as (
      

-- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
    );
  
  
[0m01:50:44.946329 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:50:44.951239 [debug] [Thread-1 (]: On model.dbt_project.int_trips: ROLLBACK
[0m01:50:44.983927 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_trips'
[0m01:50:44.985671 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m01:50:47.502867 [debug] [Thread-1 (]: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  IO Error: Could not read from file "/usr/app/taxi_rides_ny.duckdb": Cannot allocate memory
[0m01:50:47.527379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84939935-0475-4113-9ff8-3cb8dea198f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a682b72f0>]}
[0m01:50:47.534233 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model prod.int_trips ........................... [[31mERROR[0m in 87.36s]
[0m01:50:47.538223 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m01:50:47.541855 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.int_trips' to be skipped because of status 'error'.  Reason: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  IO Error: Could not read from file "/usr/app/taxi_rides_ny.duckdb": Cannot allocate memory.
[0m01:50:47.559638 [debug] [MainThread]: Using duckdb connection "master"
[0m01:50:47.561817 [debug] [MainThread]: On master: BEGIN
[0m01:50:47.563229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:50:47.699379 [debug] [MainThread]: SQL status: OK in 0.136 seconds
[0m01:50:47.700969 [debug] [MainThread]: On master: COMMIT
[0m01:50:47.702985 [debug] [MainThread]: Using duckdb connection "master"
[0m01:50:47.704325 [debug] [MainThread]: On master: COMMIT
[0m01:50:47.706377 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:50:47.707604 [debug] [MainThread]: On master: Close
[0m01:50:47.719088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:50:47.720814 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m01:50:47.722381 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was properly closed.
[0m01:50:47.728608 [info ] [MainThread]: 
[0m01:50:47.731467 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 28.17 seconds (88.17s).
[0m01:50:47.735555 [debug] [MainThread]: Command end result
[0m01:50:47.922309 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m01:50:47.945295 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m01:50:47.975484 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m01:50:47.977249 [info ] [MainThread]: 
[0m01:50:47.979500 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:50:47.981648 [info ] [MainThread]: 
[0m01:50:47.983989 [error] [MainThread]: [31mFailure in model int_trips (models/intermediate/int_trips.sql)[0m
[0m01:50:47.986412 [error] [MainThread]:   Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  IO Error: Could not read from file "/usr/app/taxi_rides_ny.duckdb": Cannot allocate memory
[0m01:50:47.987989 [info ] [MainThread]: 
[0m01:50:47.990070 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/int_trips.sql
[0m01:50:47.991745 [info ] [MainThread]: 
[0m01:50:47.994530 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:50:48.024174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 93.37622, "process_in_blocks": "95928", "process_kernel_time": 160.0604, "process_mem_max_rss": "15490620", "process_out_blocks": "0", "process_user_time": 359.06897}
[0m01:50:48.030211 [debug] [MainThread]: Command `dbt run` failed at 01:50:48.029314 after 93.38 seconds
[0m01:50:48.035688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a7199df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a71d6a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1a71d68a10>]}
[0m01:50:48.038551 [debug] [MainThread]: Flushing usage events
[0m01:50:49.835368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:02:16.825208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf95e06810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf95b2d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf95e06090>]}


============================== 02:02:16.838341 | b7c08d8c-08e7-4e28-9fb0-4ea23b307def ==============================
[0m02:02:16.838341 [info ] [MainThread]: Running with dbt=1.11.6
[0m02:02:16.840100 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run -t prod -s int_trips --full-refresh', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/root/.dbt', 'printer_width': '80', 'static_parser': 'True', 'log_path': '/usr/app/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False'}
[0m02:02:17.456038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7c08d8c-08e7-4e28-9fb0-4ea23b307def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf95cb40e0>]}
[0m02:02:17.620510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7c08d8c-08e7-4e28-9fb0-4ea23b307def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf91289f10>]}
[0m02:02:17.624292 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m02:02:17.912168 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m02:02:20.845440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:02:20.847775 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/intermediate/int_trips.sql
[0m02:02:22.190778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7c08d8c-08e7-4e28-9fb0-4ea23b307def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf77ce66f0>]}
[0m02:02:22.632722 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:02:22.649666 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:02:22.737809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7c08d8c-08e7-4e28-9fb0-4ea23b307def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf77b09580>]}
[0m02:02:22.739448 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m02:02:22.740728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7c08d8c-08e7-4e28-9fb0-4ea23b307def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf8c0aac90>]}
[0m02:02:22.745546 [info ] [MainThread]: 
[0m02:02:22.747382 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m02:02:22.750816 [info ] [MainThread]: 
[0m02:02:22.753545 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:02:22.756021 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m02:02:22.869372 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m02:02:22.870905 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m02:02:22.872242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:02:22.974234 [debug] [ThreadPool]: SQL status: OK in 0.102 seconds
[0m02:02:22.981222 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m02:02:22.994629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m02:02:22.997412 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m02:02:23.023036 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:02:23.024465 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m02:02:23.025686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:02:23.131838 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m02:02:23.136511 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:02:23.137934 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m02:02:23.140868 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:02:23.142083 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:02:23.143558 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m02:02:23.145936 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:02:23.151141 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m02:02:23.152437 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:02:23.153471 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m02:02:23.155615 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:02:23.157261 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m02:02:23.183211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m02:02:23.200249 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m02:02:23.201689 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m02:02:23.202757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:02:23.295939 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m02:02:23.298590 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m02:02:23.300271 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m02:02:23.362668 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m02:02:23.369864 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m02:02:23.373795 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m02:02:23.375405 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m02:02:23.395519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7c08d8c-08e7-4e28-9fb0-4ea23b307def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf77cb17c0>]}
[0m02:02:23.397087 [debug] [MainThread]: Using duckdb connection "master"
[0m02:02:23.398462 [debug] [MainThread]: On master: BEGIN
[0m02:02:23.399969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:02:23.495355 [debug] [MainThread]: SQL status: OK in 0.095 seconds
[0m02:02:23.498028 [debug] [MainThread]: On master: COMMIT
[0m02:02:23.500418 [debug] [MainThread]: Using duckdb connection "master"
[0m02:02:23.501808 [debug] [MainThread]: On master: COMMIT
[0m02:02:23.503993 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:02:23.505257 [debug] [MainThread]: On master: Close
[0m02:02:23.535276 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m02:02:23.537627 [info ] [Thread-1 (]: 1 of 1 START sql table model prod.int_trips .................................... [RUN]
[0m02:02:23.540573 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.int_trips'
[0m02:02:23.542828 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m02:02:23.570829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m02:02:23.602166 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m02:02:23.688566 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m02:02:23.717869 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m02:02:23.719477 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m02:02:23.720769 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:02:23.829820 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m02:02:23.832787 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m02:02:23.835196 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."int_trips__dbt_tmp"
  
    as (
      

-- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

-- select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
-- qualify row_number() over(
--    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
--     order by dropoff_datetime
-- ) = 1


dedup_keys as (

    select
        vendor_id,
        pickup_datetime,
        pickup_location_id,
        service_type,
        min(dropoff_datetime) as dropoff_datetime
    from cleaned_and_enriched
    group by 1,2,3,4

)

select c.*
from cleaned_and_enriched c
join dedup_keys d
    on c.vendor_id = d.vendor_id
   and c.pickup_datetime = d.pickup_datetime
   and c.pickup_location_id = d.pickup_location_id
   and c.service_type = d.service_type
   and c.dropoff_datetime = d.dropoff_datetime
    );
  
  
[0m02:02:23.844696 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."int_trips__dbt_tmp"
  
    as (
      

-- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

-- select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
-- qualify row_number() over(
--    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
--     order by dropoff_datetime
-- ) = 1


dedup_keys as (

    select
        vendor_id,
        pickup_datetime,
        pickup_location_id,
        service_type,
        min(dropoff_datetime) as dropoff_datetime
    from cleaned_and_enriched
    group by 1,2,3,4

)

select c.*
from cleaned_and_enriched c
join dedup_keys d
    on c.vendor_id = d.vendor_id
   and c.pickup_datetime = d.pickup_datetime
   and c.pickup_location_id = d.pickup_location_id
   and c.service_type = d.service_type
   and c.dropoff_datetime = d.dropoff_datetime
    );
  
  
[0m02:02:23.847672 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:02:23.850260 [debug] [Thread-1 (]: On model.dbt_project.int_trips: ROLLBACK
[0m02:02:23.859912 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_trips'
[0m02:02:23.862661 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m02:02:23.883393 [debug] [Thread-1 (]: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Parser Error: syntax error at or near "dedup_keys"
  
  LINE 77: dedup_keys as (
           ^
[0m02:02:23.888385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7c08d8c-08e7-4e28-9fb0-4ea23b307def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf95c7cad0>]}
[0m02:02:23.890675 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model prod.int_trips ........................... [[31mERROR[0m in 0.35s]
[0m02:02:23.893359 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m02:02:23.895951 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.int_trips' to be skipped because of status 'error'.  Reason: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Parser Error: syntax error at or near "dedup_keys"
  
  LINE 77: dedup_keys as (
           ^.
[0m02:02:23.903298 [debug] [MainThread]: Using duckdb connection "master"
[0m02:02:23.904767 [debug] [MainThread]: On master: BEGIN
[0m02:02:23.905960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:02:23.995422 [debug] [MainThread]: SQL status: OK in 0.089 seconds
[0m02:02:23.997717 [debug] [MainThread]: On master: COMMIT
[0m02:02:23.999298 [debug] [MainThread]: Using duckdb connection "master"
[0m02:02:24.000705 [debug] [MainThread]: On master: COMMIT
[0m02:02:24.003099 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:02:24.004269 [debug] [MainThread]: On master: Close
[0m02:02:24.012984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:02:24.015063 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m02:02:24.016533 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was properly closed.
[0m02:02:24.018047 [info ] [MainThread]: 
[0m02:02:24.019669 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m02:02:24.022962 [debug] [MainThread]: Command end result
[0m02:02:24.200726 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:02:24.215589 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:02:24.245487 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:02:24.246778 [info ] [MainThread]: 
[0m02:02:24.248715 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:02:24.250416 [info ] [MainThread]: 
[0m02:02:24.252575 [error] [MainThread]: [31mFailure in model int_trips (models/intermediate/int_trips.sql)[0m
[0m02:02:24.254377 [error] [MainThread]:   Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  Parser Error: syntax error at or near "dedup_keys"
  
  LINE 77: dedup_keys as (
           ^
[0m02:02:24.256066 [info ] [MainThread]: 
[0m02:02:24.258001 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/int_trips.sql
[0m02:02:24.259675 [info ] [MainThread]: 
[0m02:02:24.261185 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m02:02:24.265280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.590898, "process_in_blocks": "85600", "process_kernel_time": 0.855042, "process_mem_max_rss": "159552", "process_out_blocks": "0", "process_user_time": 7.046033}
[0m02:02:24.268419 [debug] [MainThread]: Command `dbt run` failed at 02:02:24.267633 after 7.59 seconds
[0m02:02:24.270146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf953669c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf77c0e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bf77c2e7b0>]}
[0m02:02:24.271463 [debug] [MainThread]: Flushing usage events
[0m02:02:25.015467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:14.087873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9935f95100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9936324080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9936a096a0>]}


============================== 02:03:14.100003 | a011ea24-c7a7-4e9b-a234-3dcd231f15dc ==============================
[0m02:03:14.100003 [info ] [MainThread]: Running with dbt=1.11.6
[0m02:03:14.101580 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'log_path': '/usr/app/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -t prod -s int_trips --full-refresh', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default'}
[0m02:03:14.499365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a011ea24-c7a7-4e9b-a234-3dcd231f15dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9931cd2780>]}
[0m02:03:14.614254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a011ea24-c7a7-4e9b-a234-3dcd231f15dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99366a9af0>]}
[0m02:03:14.616368 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m02:03:14.841689 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m02:03:17.874629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:03:17.876318 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/intermediate/int_trips.sql
[0m02:03:18.654154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a011ea24-c7a7-4e9b-a234-3dcd231f15dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a992c6f5640>]}
[0m02:03:18.968791 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:03:18.984994 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:03:19.045688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a011ea24-c7a7-4e9b-a234-3dcd231f15dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a992c5abcb0>]}
[0m02:03:19.047068 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m02:03:19.048114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a011ea24-c7a7-4e9b-a234-3dcd231f15dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a992c94e0f0>]}
[0m02:03:19.052280 [info ] [MainThread]: 
[0m02:03:19.053412 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m02:03:19.055367 [info ] [MainThread]: 
[0m02:03:19.057399 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:03:19.059388 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m02:03:19.126645 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m02:03:19.128006 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m02:03:19.129507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:19.206773 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m02:03:19.209656 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m02:03:19.217488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m02:03:19.218846 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m02:03:19.231310 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:03:19.232815 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m02:03:19.233957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:19.321292 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m02:03:19.324146 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:03:19.325267 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m02:03:19.326878 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:19.327970 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:03:19.329259 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m02:03:19.331367 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:19.333574 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m02:03:19.334790 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:03:19.335812 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m02:03:19.337923 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:19.339149 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m02:03:19.357350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m02:03:19.371523 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m02:03:19.373058 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m02:03:19.373930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:19.450110 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m02:03:19.451292 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m02:03:19.452337 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m02:03:19.478078 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m02:03:19.481050 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m02:03:19.483461 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m02:03:19.484527 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m02:03:19.494207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a011ea24-c7a7-4e9b-a234-3dcd231f15dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99381bd790>]}
[0m02:03:19.495433 [debug] [MainThread]: Using duckdb connection "master"
[0m02:03:19.496398 [debug] [MainThread]: On master: BEGIN
[0m02:03:19.497278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:19.574565 [debug] [MainThread]: SQL status: OK in 0.077 seconds
[0m02:03:19.575830 [debug] [MainThread]: On master: COMMIT
[0m02:03:19.577059 [debug] [MainThread]: Using duckdb connection "master"
[0m02:03:19.578210 [debug] [MainThread]: On master: COMMIT
[0m02:03:19.579841 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:03:19.580813 [debug] [MainThread]: On master: Close
[0m02:03:19.596259 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m02:03:19.597863 [info ] [Thread-1 (]: 1 of 1 START sql table model prod.int_trips .................................... [RUN]
[0m02:03:19.599327 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.int_trips'
[0m02:03:19.600601 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m02:03:19.617471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m02:03:19.645102 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m02:03:19.706403 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m02:03:19.738913 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m02:03:19.740406 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m02:03:19.741801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:03:19.836514 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m02:03:19.838059 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m02:03:19.839447 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."int_trips__dbt_tmp"
  
    as (
      

-- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
),

-- select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
-- qualify row_number() over(
--    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
--     order by dropoff_datetime
-- ) = 1


dedup_keys as (

    select
        vendor_id,
        pickup_datetime,
        pickup_location_id,
        service_type,
        min(dropoff_datetime) as dropoff_datetime
    from cleaned_and_enriched
    group by 1,2,3,4

)

select c.*
from cleaned_and_enriched c
join dedup_keys d
    on c.vendor_id = d.vendor_id
   and c.pickup_datetime = d.pickup_datetime
   and c.pickup_location_id = d.pickup_location_id
   and c.service_type = d.service_type
   and c.dropoff_datetime = d.dropoff_datetime
    );
  
  
[0m02:04:32.327728 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."int_trips__dbt_tmp"
  
    as (
      

-- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
),

-- select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
-- qualify row_number() over(
--    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
--     order by dropoff_datetime
-- ) = 1


dedup_keys as (

    select
        vendor_id,
        pickup_datetime,
        pickup_location_id,
        service_type,
        min(dropoff_datetime) as dropoff_datetime
    from cleaned_and_enriched
    group by 1,2,3,4

)

select c.*
from cleaned_and_enriched c
join dedup_keys d
    on c.vendor_id = d.vendor_id
   and c.pickup_datetime = d.pickup_datetime
   and c.pickup_location_id = d.pickup_location_id
   and c.service_type = d.service_type
   and c.dropoff_datetime = d.dropoff_datetime
    );
  
  
[0m02:04:32.430423 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:04:32.517244 [debug] [Thread-1 (]: On model.dbt_project.int_trips: ROLLBACK
[0m02:04:32.702910 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_trips'
[0m02:04:32.706566 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m02:04:35.422182 [debug] [Thread-1 (]: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  IO Error: Could not read from file "/usr/app/taxi_rides_ny.duckdb": Cannot allocate memory
[0m02:04:35.653013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a011ea24-c7a7-4e9b-a234-3dcd231f15dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a992c63d9d0>]}
[0m02:04:35.740120 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model prod.int_trips ........................... [[31mERROR[0m in 75.83s]
[0m02:04:35.759062 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m02:04:35.797807 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.int_trips' to be skipped because of status 'error'.  Reason: Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  IO Error: Could not read from file "/usr/app/taxi_rides_ny.duckdb": Cannot allocate memory.
[0m02:04:36.024656 [debug] [MainThread]: Using duckdb connection "master"
[0m02:04:36.030791 [debug] [MainThread]: On master: BEGIN
[0m02:04:36.033751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:04:36.726359 [debug] [MainThread]: SQL status: OK in 0.694 seconds
[0m02:04:36.755130 [debug] [MainThread]: On master: COMMIT
[0m02:04:36.757566 [debug] [MainThread]: Using duckdb connection "master"
[0m02:04:36.759792 [debug] [MainThread]: On master: COMMIT
[0m02:04:36.763370 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:04:36.765434 [debug] [MainThread]: On master: Close
[0m02:04:36.842026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:36.847879 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m02:04:36.849735 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was properly closed.
[0m02:04:36.881962 [info ] [MainThread]: 
[0m02:04:36.890542 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 17.80 seconds (77.80s).
[0m02:04:36.924447 [debug] [MainThread]: Command end result
[0m02:04:37.761912 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:04:37.913920 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:04:38.038520 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:04:38.042683 [info ] [MainThread]: 
[0m02:04:38.057344 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:04:38.061872 [info ] [MainThread]: 
[0m02:04:38.069593 [error] [MainThread]: [31mFailure in model int_trips (models/intermediate/int_trips.sql)[0m
[0m02:04:38.081328 [error] [MainThread]:   Runtime Error in model int_trips (models/intermediate/int_trips.sql)
  IO Error: Could not read from file "/usr/app/taxi_rides_ny.duckdb": Cannot allocate memory
[0m02:04:38.086408 [info ] [MainThread]: 
[0m02:04:38.095171 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/int_trips.sql
[0m02:04:38.101063 [info ] [MainThread]: 
[0m02:04:38.110845 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m02:04:38.213927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 84.32064, "process_in_blocks": "116312", "process_kernel_time": 145.26596, "process_mem_max_rss": "15525096", "process_out_blocks": "0", "process_user_time": 305.05807}
[0m02:04:38.235399 [debug] [MainThread]: Command `dbt run` failed at 02:04:38.231873 after 84.35 seconds
[0m02:04:38.261323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9939f8ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9935f33e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a992ca5d610>]}
[0m02:04:38.263771 [debug] [MainThread]: Flushing usage events
[0m02:04:39.492159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:09:18.867120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e6974d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e6880fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e68741400>]}


============================== 02:09:18.881447 | 57ad00ae-04ae-4dd9-89c6-c881cef9cdaf ==============================
[0m02:09:18.881447 [info ] [MainThread]: Running with dbt=1.11.6
[0m02:09:18.883444 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/app/logs', 'use_colors': 'True', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run -t prod -s int_trips --full-refresh', 'quiet': 'False'}
[0m02:09:19.433225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57ad00ae-04ae-4dd9-89c6-c881cef9cdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e62e7a330>]}
[0m02:09:19.588361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57ad00ae-04ae-4dd9-89c6-c881cef9cdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e69514f50>]}
[0m02:09:19.591517 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m02:09:19.907448 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m02:09:20.324073 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:09:20.325776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57ad00ae-04ae-4dd9-89c6-c881cef9cdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e67113440>]}
[0m02:09:28.473688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57ad00ae-04ae-4dd9-89c6-c881cef9cdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e5c609970>]}
[0m02:09:28.828833 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:09:28.845240 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:09:28.951916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57ad00ae-04ae-4dd9-89c6-c881cef9cdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e5c8de990>]}
[0m02:09:28.953419 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m02:09:28.955215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ad00ae-04ae-4dd9-89c6-c881cef9cdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e5c86db50>]}
[0m02:09:28.960703 [info ] [MainThread]: 
[0m02:09:28.962384 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m02:09:28.964289 [info ] [MainThread]: 
[0m02:09:28.967319 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:09:28.970426 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m02:09:29.074530 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m02:09:29.076028 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m02:09:29.077287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:29.182122 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m02:09:29.186883 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m02:09:29.195940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m02:09:29.198134 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m02:09:29.213884 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:09:29.215273 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m02:09:29.216613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:29.320133 [debug] [ThreadPool]: SQL status: OK in 0.103 seconds
[0m02:09:29.323889 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:09:29.325081 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m02:09:29.327132 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:09:29.328158 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:09:29.329200 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m02:09:29.332661 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m02:09:29.335316 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m02:09:29.337179 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m02:09:29.338441 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m02:09:29.340729 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:09:29.342173 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m02:09:29.365492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m02:09:29.377263 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m02:09:29.378963 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m02:09:29.380235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:29.460455 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m02:09:29.461988 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m02:09:29.463291 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m02:09:29.493663 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m02:09:29.497026 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m02:09:29.502314 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m02:09:29.503577 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m02:09:29.516417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ad00ae-04ae-4dd9-89c6-c881cef9cdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e6734eae0>]}
[0m02:09:29.518072 [debug] [MainThread]: Using duckdb connection "master"
[0m02:09:29.519423 [debug] [MainThread]: On master: BEGIN
[0m02:09:29.520449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:09:29.606126 [debug] [MainThread]: SQL status: OK in 0.086 seconds
[0m02:09:29.607432 [debug] [MainThread]: On master: COMMIT
[0m02:09:29.608874 [debug] [MainThread]: Using duckdb connection "master"
[0m02:09:29.610019 [debug] [MainThread]: On master: COMMIT
[0m02:09:29.612423 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:09:29.613497 [debug] [MainThread]: On master: Close
[0m02:09:29.632413 [debug] [Thread-1 (]: Began running node model.dbt_project.int_trips
[0m02:09:29.634192 [info ] [Thread-1 (]: 1 of 1 START sql table model prod.int_trips .................................... [RUN]
[0m02:09:29.636010 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.int_trips'
[0m02:09:29.637673 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_trips
[0m02:09:29.659634 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_trips"
[0m02:09:29.684552 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_trips
[0m02:09:29.762545 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_trips"
[0m02:09:29.788658 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m02:09:29.790627 [debug] [Thread-1 (]: On model.dbt_project.int_trips: BEGIN
[0m02:09:29.791998 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:09:29.884405 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m02:09:29.886134 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m02:09:29.887651 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."int_trips__dbt_tmp"
  
    as (
      

-- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
),

-- select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
-- qualify row_number() over(
--    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
--     order by dropoff_datetime
-- ) = 1


dedup_keys as (

    select
        vendor_id,
        pickup_datetime,
        pickup_location_id,
        service_type,
        min(dropoff_datetime) as dropoff_datetime
    from cleaned_and_enriched
    group by 1,2,3,4

)

select c.*
from cleaned_and_enriched c
join dedup_keys d
    on c.vendor_id = d.vendor_id
   and c.pickup_datetime = d.pickup_datetime
   and c.pickup_location_id = d.pickup_location_id
   and c.service_type = d.service_type
   and c.dropoff_datetime = d.dropoff_datetime
    );
  
  
[0m02:56:27.680196 [debug] [Thread-1 (]: SQL status: OK in 2818.973 seconds
[0m02:56:28.244907 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m02:56:28.248619 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter view "taxi_rides_ny"."prod"."int_trips" rename to "int_trips__dbt_backup"
[0m02:56:28.292688 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m02:56:28.315774 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m02:56:28.321169 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
alter table "taxi_rides_ny"."prod"."int_trips__dbt_tmp" rename to "int_trips"
[0m02:56:28.327584 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:56:28.464307 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m02:56:28.470844 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m02:56:28.472830 [debug] [Thread-1 (]: On model.dbt_project.int_trips: COMMIT
[0m02:56:31.415601 [debug] [Thread-1 (]: SQL status: OK in 2.940 seconds
[0m02:56:31.448510 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_trips"
[0m02:56:31.452777 [debug] [Thread-1 (]: On model.dbt_project.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.int_trips"} */
drop view if exists "taxi_rides_ny"."prod"."int_trips__dbt_backup" cascade
[0m02:56:31.483049 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m02:56:31.578129 [debug] [Thread-1 (]: On model.dbt_project.int_trips: Close
[0m02:56:34.484937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ad00ae-04ae-4dd9-89c6-c881cef9cdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e5c843bf0>]}
[0m02:56:34.500518 [info ] [Thread-1 (]: 1 of 1 OK created sql table model prod.int_trips ............................... [[32mOK[0m in 2824.83s]
[0m02:56:34.510175 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_trips
[0m02:56:34.620757 [debug] [MainThread]: Using duckdb connection "master"
[0m02:56:34.624410 [debug] [MainThread]: On master: BEGIN
[0m02:56:34.626971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:56:35.020654 [debug] [MainThread]: SQL status: OK in 0.394 seconds
[0m02:56:35.022944 [debug] [MainThread]: On master: COMMIT
[0m02:56:35.024844 [debug] [MainThread]: Using duckdb connection "master"
[0m02:56:35.026881 [debug] [MainThread]: On master: COMMIT
[0m02:56:35.030834 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:56:35.032423 [debug] [MainThread]: On master: Close
[0m02:56:35.057028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:56:35.059395 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m02:56:35.061371 [debug] [MainThread]: Connection 'model.dbt_project.int_trips' was properly closed.
[0m02:56:35.065986 [info ] [MainThread]: 
[0m02:56:35.073605 [info ] [MainThread]: Finished running 1 table model in 0 hours 47 minutes and 6.10 seconds (2826.10s).
[0m02:56:35.081633 [debug] [MainThread]: Command end result
[0m02:56:35.404746 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m02:56:35.475020 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m02:56:35.527199 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m02:56:35.529731 [info ] [MainThread]: 
[0m02:56:35.537719 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:56:35.543826 [info ] [MainThread]: 
[0m02:56:35.548297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:56:35.626075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2838.1746, "process_in_blocks": "89472", "process_kernel_time": 1017.25336, "process_mem_max_rss": "7077592", "process_out_blocks": "0", "process_user_time": 5032.071}
[0m02:56:35.642248 [debug] [MainThread]: Command `dbt run` succeeded at 02:56:35.640887 after 2838.20 seconds
[0m02:56:35.650525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e672cdca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e5c40fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e5c40fdd0>]}
[0m02:56:35.660766 [debug] [MainThread]: Flushing usage events
[0m02:56:37.542819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:06:24.315783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c9935f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c9b5b8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c9995e480>]}


============================== 03:06:24.329488 | 10eb89b7-ac61-4923-8bc8-d3408c1aa513 ==============================
[0m03:06:24.329488 [info ] [MainThread]: Running with dbt=1.11.6
[0m03:06:24.331287 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'empty': 'False', 'invocation_command': 'dbt run -t prod -s fct_monthly_zone_revenue', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'profiles_dir': '/root/.dbt', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True'}
[0m03:06:24.838616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10eb89b7-ac61-4923-8bc8-d3408c1aa513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c99022b40>]}
[0m03:06:24.980615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10eb89b7-ac61-4923-8bc8-d3408c1aa513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c99ee87a0>]}
[0m03:06:24.983248 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m03:06:25.263706 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m03:06:28.220417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:06:28.221795 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:06:28.222840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:06:28.351527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10eb89b7-ac61-4923-8bc8-d3408c1aa513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c913c6240>]}
[0m03:06:28.663478 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:06:28.679896 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:06:28.754914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10eb89b7-ac61-4923-8bc8-d3408c1aa513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c913c63c0>]}
[0m03:06:28.756112 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m03:06:28.757351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10eb89b7-ac61-4923-8bc8-d3408c1aa513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c99020920>]}
[0m03:06:28.761806 [info ] [MainThread]: 
[0m03:06:28.763201 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m03:06:28.764661 [info ] [MainThread]: 
[0m03:06:28.766632 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:06:28.769499 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m03:06:28.883413 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m03:06:28.887655 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m03:06:28.888717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:06:29.022654 [debug] [ThreadPool]: SQL status: OK in 0.134 seconds
[0m03:06:29.026871 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m03:06:29.035016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m03:06:29.037017 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m03:06:29.053364 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:06:29.054873 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m03:06:29.056412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:29.164374 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m03:06:29.168866 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:06:29.170493 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m03:06:29.172680 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:06:29.173969 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:06:29.175263 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m03:06:29.177468 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:06:29.179695 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m03:06:29.180847 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:06:29.181752 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m03:06:29.184105 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:06:29.185672 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m03:06:29.204420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m03:06:29.218848 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m03:06:29.219960 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m03:06:29.220709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:29.317628 [debug] [ThreadPool]: SQL status: OK in 0.097 seconds
[0m03:06:29.318970 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m03:06:29.320038 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m03:06:29.360461 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m03:06:29.364186 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m03:06:29.369618 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m03:06:29.370996 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m03:06:29.381936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10eb89b7-ac61-4923-8bc8-d3408c1aa513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c99043a70>]}
[0m03:06:29.383577 [debug] [MainThread]: Using duckdb connection "master"
[0m03:06:29.384788 [debug] [MainThread]: On master: BEGIN
[0m03:06:29.385863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:06:29.503451 [debug] [MainThread]: SQL status: OK in 0.117 seconds
[0m03:06:29.504789 [debug] [MainThread]: On master: COMMIT
[0m03:06:29.505720 [debug] [MainThread]: Using duckdb connection "master"
[0m03:06:29.506629 [debug] [MainThread]: On master: COMMIT
[0m03:06:29.508111 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:06:29.509282 [debug] [MainThread]: On master: Close
[0m03:06:29.522703 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m03:06:29.524521 [info ] [Thread-1 (]: 1 of 1 START sql view model prod.fct_monthly_zone_revenue ...................... [RUN]
[0m03:06:29.526142 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.fct_monthly_zone_revenue'
[0m03:06:29.527928 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_monthly_zone_revenue
[0m03:06:29.546106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_monthly_zone_revenue"
[0m03:06:29.576707 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_monthly_zone_revenue
[0m03:06:29.655243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_monthly_zone_revenue"
[0m03:06:29.690761 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m03:06:29.692068 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: BEGIN
[0m03:06:29.693566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:06:29.794621 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m03:06:29.796463 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m03:06:29.797936 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */

  
  create view "taxi_rides_ny"."prod"."fct_monthly_zone_revenue__dbt_tmp" as (
    -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime)
     as revenue_month,
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."prod"."fct_trips"
group by pickup_zone, revenue_month, service_type
  );

[0m03:06:29.832254 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */

  
  create view "taxi_rides_ny"."prod"."fct_monthly_zone_revenue__dbt_tmp" as (
    -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime)
     as revenue_month,
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."prod"."fct_trips"
group by pickup_zone, revenue_month, service_type
  );

[0m03:06:29.834671 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:06:29.836505 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: ROLLBACK
[0m03:06:29.855064 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.fct_monthly_zone_revenue'
[0m03:06:29.856866 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: Close
[0m03:06:29.869911 [debug] [Thread-1 (]: Runtime Error in model fct_monthly_zone_revenue (models/marts/reporting/fct_monthly_zone_revenue.sql)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "dev.fct_trips"?
  
  LINE 31: from "taxi_rides_ny"."prod"."fct_trips"
                ^
[0m03:06:29.873858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10eb89b7-ac61-4923-8bc8-d3408c1aa513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c95564740>]}
[0m03:06:29.875887 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model prod.fct_monthly_zone_revenue ............. [[31mERROR[0m in 0.35s]
[0m03:06:29.878094 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m03:06:29.880370 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fct_monthly_zone_revenue' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_monthly_zone_revenue (models/marts/reporting/fct_monthly_zone_revenue.sql)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "dev.fct_trips"?
  
  LINE 31: from "taxi_rides_ny"."prod"."fct_trips"
                ^.
[0m03:06:29.886682 [debug] [MainThread]: Using duckdb connection "master"
[0m03:06:29.888465 [debug] [MainThread]: On master: BEGIN
[0m03:06:29.889943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:06:29.996184 [debug] [MainThread]: SQL status: OK in 0.106 seconds
[0m03:06:29.997544 [debug] [MainThread]: On master: COMMIT
[0m03:06:29.998843 [debug] [MainThread]: Using duckdb connection "master"
[0m03:06:30.001520 [debug] [MainThread]: On master: COMMIT
[0m03:06:30.004158 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:06:30.005352 [debug] [MainThread]: On master: Close
[0m03:06:30.013038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:06:30.014548 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m03:06:30.016145 [debug] [MainThread]: Connection 'model.dbt_project.fct_monthly_zone_revenue' was properly closed.
[0m03:06:30.020748 [info ] [MainThread]: 
[0m03:06:30.022742 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m03:06:30.026647 [debug] [MainThread]: Command end result
[0m03:06:30.176957 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:06:30.191971 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:06:30.225511 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m03:06:30.226593 [info ] [MainThread]: 
[0m03:06:30.227990 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:06:30.229512 [info ] [MainThread]: 
[0m03:06:30.232124 [error] [MainThread]: [31mFailure in model fct_monthly_zone_revenue (models/marts/reporting/fct_monthly_zone_revenue.sql)[0m
[0m03:06:30.236944 [error] [MainThread]:   Runtime Error in model fct_monthly_zone_revenue (models/marts/reporting/fct_monthly_zone_revenue.sql)
  Catalog Error: Table with name fct_trips does not exist!
  Did you mean "dev.fct_trips"?
  
  LINE 31: from "taxi_rides_ny"."prod"."fct_trips"
                ^
[0m03:06:30.238508 [info ] [MainThread]: 
[0m03:06:30.240398 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/marts/reporting/fct_monthly_zone_revenue.sql
[0m03:06:30.241811 [info ] [MainThread]: 
[0m03:06:30.243548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m03:06:30.247616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.118339, "process_in_blocks": "2344", "process_kernel_time": 0.72934, "process_mem_max_rss": "158988", "process_out_blocks": "0", "process_user_time": 5.634352}
[0m03:06:30.253089 [debug] [MainThread]: Command `dbt run` failed at 03:06:30.252629 after 6.12 seconds
[0m03:06:30.254601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c9ae02de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c9ae01220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787c9024e2a0>]}
[0m03:06:30.256190 [debug] [MainThread]: Flushing usage events
[0m03:06:30.976955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:07:03.457348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c79b31070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7c1bd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7a045e20>]}


============================== 03:07:03.472945 | ac28e3cb-bae6-4d88-9116-976b8907005a ==============================
[0m03:07:03.472945 [info ] [MainThread]: Running with dbt=1.11.6
[0m03:07:03.476102 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -t prod -s fct_trips', 'quiet': 'False', 'log_format': 'default', 'log_path': '/usr/app/logs', 'empty': 'False', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'debug': 'False', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m03:07:03.955102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac28e3cb-bae6-4d88-9116-976b8907005a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7174d070>]}
[0m03:07:04.097463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac28e3cb-bae6-4d88-9116-976b8907005a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7937ea80>]}
[0m03:07:04.099624 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m03:07:04.369219 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m03:07:07.308219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:07:07.309578 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:07:07.310739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:07:07.444390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac28e3cb-bae6-4d88-9116-976b8907005a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7052ff20>]}
[0m03:07:07.733064 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:07:07.748537 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:07:07.821372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac28e3cb-bae6-4d88-9116-976b8907005a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c71683d40>]}
[0m03:07:07.822870 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m03:07:07.824017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac28e3cb-bae6-4d88-9116-976b8907005a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c716329f0>]}
[0m03:07:07.828389 [info ] [MainThread]: 
[0m03:07:07.830181 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m03:07:07.833363 [info ] [MainThread]: 
[0m03:07:07.837918 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:07:07.842278 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m03:07:07.917005 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m03:07:07.918304 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m03:07:07.919483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:08.030751 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m03:07:08.034238 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m03:07:08.042003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m03:07:08.043619 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m03:07:08.058186 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:07:08.059342 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m03:07:08.060512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:08.146133 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m03:07:08.149538 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:07:08.150569 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m03:07:08.152361 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:07:08.153363 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:07:08.154336 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m03:07:08.155952 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:07:08.157907 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m03:07:08.159001 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:07:08.159868 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m03:07:08.161360 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:07:08.162721 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m03:07:08.180369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m03:07:08.194533 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m03:07:08.196003 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m03:07:08.197281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:08.294327 [debug] [ThreadPool]: SQL status: OK in 0.097 seconds
[0m03:07:08.296097 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m03:07:08.298530 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m03:07:08.327608 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m03:07:08.333017 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m03:07:08.335807 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m03:07:08.337223 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m03:07:08.352132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac28e3cb-bae6-4d88-9116-976b8907005a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7be0cc20>]}
[0m03:07:08.353489 [debug] [MainThread]: Using duckdb connection "master"
[0m03:07:08.354794 [debug] [MainThread]: On master: BEGIN
[0m03:07:08.355570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:07:08.462688 [debug] [MainThread]: SQL status: OK in 0.107 seconds
[0m03:07:08.464329 [debug] [MainThread]: On master: COMMIT
[0m03:07:08.465485 [debug] [MainThread]: Using duckdb connection "master"
[0m03:07:08.466393 [debug] [MainThread]: On master: COMMIT
[0m03:07:08.467866 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:07:08.468623 [debug] [MainThread]: On master: Close
[0m03:07:08.481244 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_trips
[0m03:07:08.483248 [info ] [Thread-1 (]: 1 of 1 START sql incremental model prod.fct_trips .............................. [RUN]
[0m03:07:08.486607 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.fct_trips'
[0m03:07:08.488054 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_trips
[0m03:07:08.527670 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_trips"
[0m03:07:08.555162 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_trips
[0m03:07:08.705342 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m03:07:08.707134 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as __dbt_sbq
    where false
    limit 0
)
[0m03:07:08.708875 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:07:08.809597 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m03:07:08.848978 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m03:07:08.851438 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m03:07:08.853107 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as TEXT)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as TEXT)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as TEXT)
 as pickup_borough, 
      
    cast(null as TEXT)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as TEXT)
 as dropoff_borough, 
      
    cast(null as TEXT)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as TEXT)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as TEXT)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m03:07:08.856321 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:07:08.911201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_trips"
[0m03:07:08.942031 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m03:07:08.943463 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: BEGIN
[0m03:07:08.946324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:07:08.948092 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m03:07:08.949398 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."prod"."fct_trips"
  
  (
    trip_id TEXT,
    vendor_id integer,
    service_type TEXT,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough TEXT,
    pickup_zone TEXT,
    dropoff_location_id integer,
    dropoff_borough TEXT,
    dropoff_zone TEXT,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag TEXT,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description TEXT
    
    )
 ;
    insert into "taxi_rides_ny"."prod"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

--  incremental_strategy='merge',
--    on_schema_change='append_new_columns' 

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp )
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m03:12:14.018876 [debug] [Thread-1 (]: SQL status: OK in 305.132 seconds
[0m03:12:14.091557 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m03:12:14.093556 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_trips"
[0m03:12:14.095387 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: COMMIT
[0m03:12:17.054526 [debug] [Thread-1 (]: SQL status: OK in 2.957 seconds
[0m03:12:17.066965 [debug] [Thread-1 (]: On model.dbt_project.fct_trips: Close
[0m03:12:17.968363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac28e3cb-bae6-4d88-9116-976b8907005a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7bf84500>]}
[0m03:12:17.972747 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model prod.fct_trips ......................... [[32mOK[0m in 309.48s]
[0m03:12:17.975285 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_trips
[0m03:12:17.986383 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:17.988017 [debug] [MainThread]: On master: BEGIN
[0m03:12:17.989246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:18.125245 [debug] [MainThread]: SQL status: OK in 0.136 seconds
[0m03:12:18.127134 [debug] [MainThread]: On master: COMMIT
[0m03:12:18.128643 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:18.130479 [debug] [MainThread]: On master: COMMIT
[0m03:12:18.133884 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:12:18.135747 [debug] [MainThread]: On master: Close
[0m03:12:18.146979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:18.149948 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m03:12:18.151380 [debug] [MainThread]: Connection 'model.dbt_project.fct_trips' was properly closed.
[0m03:12:18.153008 [info ] [MainThread]: 
[0m03:12:18.154751 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 5 minutes and 10.32 seconds (310.32s).
[0m03:12:18.161194 [debug] [MainThread]: Command end result
[0m03:12:18.703247 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:12:18.719939 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:12:18.753491 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m03:12:18.755073 [info ] [MainThread]: 
[0m03:12:18.756650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:18.758695 [info ] [MainThread]: 
[0m03:12:18.761353 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:12:18.773560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 315.57724, "process_in_blocks": "680", "process_kernel_time": 205.42532, "process_mem_max_rss": "6575100", "process_out_blocks": "0", "process_user_time": 1450.6761}
[0m03:12:18.776367 [debug] [MainThread]: Command `dbt run` succeeded at 03:12:18.775773 after 315.58 seconds
[0m03:12:18.778205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c79892330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c70219b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7021aa80>]}
[0m03:12:18.782530 [debug] [MainThread]: Flushing usage events
[0m03:12:19.562706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:12:35.656844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583ce8438c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583cbc94da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583cbe1e120>]}


============================== 03:12:35.686772 | 9e25f8f0-a9fc-4c7f-b28c-884c85176c2c ==============================
[0m03:12:35.686772 [info ] [MainThread]: Running with dbt=1.11.6
[0m03:12:35.696692 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -t prod -s fct_monthly_zone_revenue', 'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs'}
[0m03:12:36.485922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e25f8f0-a9fc-4c7f-b28c-884c85176c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583ce1f3fb0>]}
[0m03:12:37.092904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e25f8f0-a9fc-4c7f-b28c-884c85176c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583cba73950>]}
[0m03:12:37.096583 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m03:12:37.617967 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m03:12:41.226613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:41.228878 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m03:12:41.230225 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:41.441759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e25f8f0-a9fc-4c7f-b28c-884c85176c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583c3d2a900>]}
[0m03:12:41.947199 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:12:41.965757 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:12:42.076845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e25f8f0-a9fc-4c7f-b28c-884c85176c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583c2a23da0>]}
[0m03:12:42.079274 [info ] [MainThread]: Found 8 models, 2 seeds, 33 data tests, 2 sources, 601 macros
[0m03:12:42.081607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e25f8f0-a9fc-4c7f-b28c-884c85176c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583c29d5400>]}
[0m03:12:42.093745 [info ] [MainThread]: 
[0m03:12:42.096159 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m03:12:42.098621 [info ] [MainThread]: 
[0m03:12:42.103143 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:12:42.114334 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m03:12:42.295933 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m03:12:42.298296 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m03:12:42.300172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:42.431290 [debug] [ThreadPool]: SQL status: OK in 0.131 seconds
[0m03:12:42.436752 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m03:12:42.446988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m03:12:42.448932 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m03:12:42.469350 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:12:42.472847 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m03:12:42.474516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:42.608290 [debug] [ThreadPool]: SQL status: OK in 0.134 seconds
[0m03:12:42.612779 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:12:42.614678 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m03:12:42.616790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:42.617814 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:12:42.619123 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m03:12:42.622828 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:42.625800 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m03:12:42.627229 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m03:12:42.628426 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m03:12:42.630727 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:42.631814 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m03:12:42.659482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m03:12:42.682733 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m03:12:42.684274 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m03:12:42.685576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:42.815418 [debug] [ThreadPool]: SQL status: OK in 0.130 seconds
[0m03:12:42.817500 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m03:12:42.819102 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m03:12:42.875101 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m03:12:42.880404 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m03:12:42.883851 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m03:12:42.885160 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m03:12:42.900889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e25f8f0-a9fc-4c7f-b28c-884c85176c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583c3c17bf0>]}
[0m03:12:42.902789 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:42.904183 [debug] [MainThread]: On master: BEGIN
[0m03:12:42.906671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:43.065365 [debug] [MainThread]: SQL status: OK in 0.159 seconds
[0m03:12:43.067189 [debug] [MainThread]: On master: COMMIT
[0m03:12:43.072796 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:43.074889 [debug] [MainThread]: On master: COMMIT
[0m03:12:43.077796 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:12:43.079461 [debug] [MainThread]: On master: Close
[0m03:12:43.108393 [debug] [Thread-1 (]: Began running node model.dbt_project.fct_monthly_zone_revenue
[0m03:12:43.110655 [info ] [Thread-1 (]: 1 of 1 START sql view model prod.fct_monthly_zone_revenue ...................... [RUN]
[0m03:12:43.113535 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.fct_monthly_zone_revenue'
[0m03:12:43.115496 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fct_monthly_zone_revenue
[0m03:12:43.153274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fct_monthly_zone_revenue"
[0m03:12:43.190065 [debug] [Thread-1 (]: Began executing node model.dbt_project.fct_monthly_zone_revenue
[0m03:12:43.342092 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fct_monthly_zone_revenue"
[0m03:12:43.384868 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m03:12:43.389278 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: BEGIN
[0m03:12:43.391501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:12:43.559245 [debug] [Thread-1 (]: SQL status: OK in 0.168 seconds
[0m03:12:43.562730 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m03:12:43.567229 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */

  
  create view "taxi_rides_ny"."prod"."fct_monthly_zone_revenue__dbt_tmp" as (
    -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime)
     as revenue_month,
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."prod"."fct_trips"
group by pickup_zone, revenue_month, service_type
  );

[0m03:12:43.577375 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m03:12:43.598582 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m03:12:43.600236 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
alter view "taxi_rides_ny"."prod"."fct_monthly_zone_revenue__dbt_tmp" rename to "fct_monthly_zone_revenue"
[0m03:12:43.606596 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m03:12:43.666830 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: COMMIT
[0m03:12:43.673031 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m03:12:43.675625 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: COMMIT
[0m03:12:43.693423 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m03:12:43.715419 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.fct_monthly_zone_revenue"
[0m03:12:43.717315 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.fct_monthly_zone_revenue"} */
drop view if exists "taxi_rides_ny"."prod"."fct_monthly_zone_revenue__dbt_backup" cascade
[0m03:12:43.723517 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m03:12:43.735623 [debug] [Thread-1 (]: On model.dbt_project.fct_monthly_zone_revenue: Close
[0m03:12:48.291183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e25f8f0-a9fc-4c7f-b28c-884c85176c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583ce4ec2c0>]}
[0m03:12:48.294678 [info ] [Thread-1 (]: 1 of 1 OK created sql view model prod.fct_monthly_zone_revenue ................. [[32mOK[0m in 5.17s]
[0m03:12:48.298910 [debug] [Thread-1 (]: Finished running node model.dbt_project.fct_monthly_zone_revenue
[0m03:12:48.307001 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:48.308930 [debug] [MainThread]: On master: BEGIN
[0m03:12:48.310822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:48.470718 [debug] [MainThread]: SQL status: OK in 0.160 seconds
[0m03:12:48.473638 [debug] [MainThread]: On master: COMMIT
[0m03:12:48.478416 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:48.482440 [debug] [MainThread]: On master: COMMIT
[0m03:12:48.485869 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:12:48.488291 [debug] [MainThread]: On master: Close
[0m03:12:48.500950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:48.503490 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m03:12:48.505511 [debug] [MainThread]: Connection 'model.dbt_project.fct_monthly_zone_revenue' was properly closed.
[0m03:12:48.507185 [info ] [MainThread]: 
[0m03:12:48.509146 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m03:12:48.518041 [debug] [MainThread]: Command end result
[0m03:12:48.923228 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m03:12:48.944762 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m03:12:48.993750 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m03:12:48.995490 [info ] [MainThread]: 
[0m03:12:48.998000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:49.000633 [info ] [MainThread]: 
[0m03:12:49.006996 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:12:49.017143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.606144, "process_in_blocks": "0", "process_kernel_time": 6.426907, "process_mem_max_rss": "307064", "process_out_blocks": "0", "process_user_time": 18.807388}
[0m03:12:49.022666 [debug] [MainThread]: Command `dbt run` succeeded at 03:12:49.021963 after 13.61 seconds
[0m03:12:49.025486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583cbf8fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583cc305c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583c1dd4ec0>]}
[0m03:12:49.030293 [debug] [MainThread]: Flushing usage events
[0m03:12:49.738195 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:54:58.550695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839ffa67b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839fddc64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839fddc6570>]}


============================== 04:54:58.571446 | c1bb862e-5b3c-4b4d-94f3-997105ce641a ==============================
[0m04:54:58.571446 [info ] [MainThread]: Running with dbt=1.11.6
[0m04:54:58.574025 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'introspect': 'True', 'printer_width': '80', 'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'version_check': 'True', 'log_path': '/usr/app/logs', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'profiles_dir': '/root/.dbt', 'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt run -t prod -s stg_fhv_tripdata', 'use_colors': 'True', 'fail_fast': 'False'}
[0m04:54:59.070614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1bb862e-5b3c-4b4d-94f3-997105ce641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839f4fd0a40>]}
[0m04:54:59.230956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1bb862e-5b3c-4b4d-94f3-997105ce641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839fcef9be0>]}
[0m04:54:59.234182 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m04:54:59.665446 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m04:55:02.919625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m04:55:02.922490 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/stg_fhv_tripdata.sql
[0m04:55:02.943011 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/sources.yml
[0m04:55:02.949296 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/schema.yml
[0m04:55:05.350996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1bb862e-5b3c-4b4d-94f3-997105ce641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839dfaf19a0>]}
[0m04:55:05.667257 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:55:05.684828 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:55:05.770919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1bb862e-5b3c-4b4d-94f3-997105ce641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839dfbd1010>]}
[0m04:55:05.772402 [info ] [MainThread]: Found 9 models, 2 seeds, 34 data tests, 3 sources, 601 macros
[0m04:55:05.773565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1bb862e-5b3c-4b4d-94f3-997105ce641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839f4fb4860>]}
[0m04:55:05.778696 [info ] [MainThread]: 
[0m04:55:05.780045 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m04:55:05.781616 [info ] [MainThread]: 
[0m04:55:05.785008 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:55:05.788529 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m04:55:05.904546 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m04:55:05.906288 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m04:55:05.907670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:55:06.058882 [debug] [ThreadPool]: SQL status: OK in 0.151 seconds
[0m04:55:06.062687 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m04:55:06.074505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m04:55:06.076417 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m04:55:06.090074 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m04:55:06.091765 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m04:55:06.093371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:55:06.219585 [debug] [ThreadPool]: SQL status: OK in 0.126 seconds
[0m04:55:06.223284 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m04:55:06.224701 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m04:55:06.226878 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:55:06.228134 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m04:55:06.229417 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m04:55:06.231773 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:55:06.234132 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m04:55:06.235530 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m04:55:06.236860 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m04:55:06.238866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:55:06.240192 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m04:55:06.258556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m04:55:06.269716 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m04:55:06.271388 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m04:55:06.272795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:55:06.405915 [debug] [ThreadPool]: SQL status: OK in 0.133 seconds
[0m04:55:06.407491 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m04:55:06.409182 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m04:55:06.442471 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m04:55:06.446592 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m04:55:06.451587 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m04:55:06.453171 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m04:55:06.465202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1bb862e-5b3c-4b4d-94f3-997105ce641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839dfbed7c0>]}
[0m04:55:06.467632 [debug] [MainThread]: Using duckdb connection "master"
[0m04:55:06.468946 [debug] [MainThread]: On master: BEGIN
[0m04:55:06.470278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:55:06.604844 [debug] [MainThread]: SQL status: OK in 0.134 seconds
[0m04:55:06.606299 [debug] [MainThread]: On master: COMMIT
[0m04:55:06.607568 [debug] [MainThread]: Using duckdb connection "master"
[0m04:55:06.608951 [debug] [MainThread]: On master: COMMIT
[0m04:55:06.610785 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:55:06.611987 [debug] [MainThread]: On master: Close
[0m04:55:06.631036 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_fhv_tripdata
[0m04:55:06.633698 [info ] [Thread-1 (]: 1 of 1 START sql view model prod.stg_fhv_tripdata .............................. [RUN]
[0m04:55:06.635414 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_fhv_tripdata'
[0m04:55:06.636539 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_fhv_tripdata
[0m04:55:06.651170 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_fhv_tripdata"
[0m04:55:06.686320 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_fhv_tripdata
[0m04:55:06.741262 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_fhv_tripdata"
[0m04:55:06.769553 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m04:55:06.770932 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: BEGIN
[0m04:55:06.772001 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:55:06.897223 [debug] [Thread-1 (]: SQL status: OK in 0.125 seconds
[0m04:55:06.898736 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m04:55:06.900184 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_fhv_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_fhv_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."fhv_tripdata"
),

renamed as (

    select
        cast(dispatching_base_num as varchar) as vendor_id,
        cast(pickup_datetime as timestamp) as pickup_datetime,
        cast(dropOff_datetime as timestamp) as dropoff_datetime,
        cast(PUlocationID as integer) as pickup_location_id,
        cast(DOlocationID as integer) as dropoff_location_id,
        cast(SR_Flag as varchar) as sr_flag,
        cast(Affiliated_base_number as varchar) as affiliated_base_number,
        'fhv' as service_type

    from source
    where dispatching_base_num is not null

)

select * from renamed



  );

[0m04:55:06.903832 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:55:06.918699 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m04:55:06.920248 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_fhv_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_fhv_tripdata__dbt_tmp" rename to "stg_fhv_tripdata"
[0m04:55:06.922698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:55:06.946162 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: COMMIT
[0m04:55:06.947932 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m04:55:06.949143 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: COMMIT
[0m04:55:06.966291 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m04:55:06.974787 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m04:55:06.976241 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_fhv_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_fhv_tripdata__dbt_backup" cascade
[0m04:55:06.978485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:55:06.983891 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: Close
[0m04:55:23.989237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bb862e-5b3c-4b4d-94f3-997105ce641a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839ff6fc860>]}
[0m04:55:23.991365 [info ] [Thread-1 (]: 1 of 1 OK created sql view model prod.stg_fhv_tripdata ......................... [[32mOK[0m in 17.35s]
[0m04:55:23.993422 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_fhv_tripdata
[0m04:55:24.002976 [debug] [MainThread]: Using duckdb connection "master"
[0m04:55:24.004204 [debug] [MainThread]: On master: BEGIN
[0m04:55:24.005341 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:55:24.123972 [debug] [MainThread]: SQL status: OK in 0.119 seconds
[0m04:55:24.125415 [debug] [MainThread]: On master: COMMIT
[0m04:55:24.126406 [debug] [MainThread]: Using duckdb connection "master"
[0m04:55:24.131138 [debug] [MainThread]: On master: COMMIT
[0m04:55:24.133384 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m04:55:24.134425 [debug] [MainThread]: On master: Close
[0m04:55:24.142491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:55:24.144053 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m04:55:24.145544 [debug] [MainThread]: Connection 'model.dbt_project.stg_fhv_tripdata' was properly closed.
[0m04:55:24.146954 [info ] [MainThread]: 
[0m04:55:24.148275 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 18.36 seconds (18.36s).
[0m04:55:24.152047 [debug] [MainThread]: Command end result
[0m04:55:24.308348 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:55:24.326683 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:55:24.351453 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m04:55:24.352693 [info ] [MainThread]: 
[0m04:55:24.354420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:55:24.356301 [info ] [MainThread]: 
[0m04:55:24.357870 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m04:55:24.362438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.007778, "process_in_blocks": "0", "process_kernel_time": 12.927448, "process_mem_max_rss": "1099172", "process_out_blocks": "0", "process_user_time": 57.627228}
[0m04:55:24.364449 [debug] [MainThread]: Command `dbt run` succeeded at 04:55:24.364070 after 26.01 seconds
[0m04:55:24.366289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839fcef7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839df9e6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7839df9e4110>]}
[0m04:55:24.367757 [debug] [MainThread]: Flushing usage events
[0m04:55:25.121883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:03:03.503030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7258504c5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72584f941b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72585106a930>]}


============================== 05:03:03.519124 | 2c180afc-2a0a-4b64-bd9c-73b78fb12216 ==============================
[0m05:03:03.519124 [info ] [MainThread]: Running with dbt=1.11.6
[0m05:03:03.521455 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -t prod -s stg_fhv_tripdata', 'version_check': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'target_path': 'None'}
[0m05:03:04.009838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c180afc-2a0a-4b64-bd9c-73b78fb12216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72584b909430>]}
[0m05:03:04.149816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c180afc-2a0a-4b64-bd9c-73b78fb12216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72584f481f70>]}
[0m05:03:04.152548 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m05:03:04.413363 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m05:03:07.678042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:03:07.679508 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m05:03:07.680909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:03:07.775999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c180afc-2a0a-4b64-bd9c-73b78fb12216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72584f4771a0>]}
[0m05:03:08.027477 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:03:08.041421 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:03:08.103478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c180afc-2a0a-4b64-bd9c-73b78fb12216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725847764410>]}
[0m05:03:08.105116 [info ] [MainThread]: Found 9 models, 2 seeds, 34 data tests, 3 sources, 601 macros
[0m05:03:08.106314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c180afc-2a0a-4b64-bd9c-73b78fb12216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7258463487a0>]}
[0m05:03:08.111149 [info ] [MainThread]: 
[0m05:03:08.112594 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m05:03:08.113768 [info ] [MainThread]: 
[0m05:03:08.117562 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:03:08.120764 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m05:03:08.193911 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m05:03:08.195564 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m05:03:08.196919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:03:08.305525 [debug] [ThreadPool]: SQL status: OK in 0.109 seconds
[0m05:03:08.308315 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m05:03:08.318516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m05:03:08.320218 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m05:03:08.331724 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m05:03:08.333207 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m05:03:08.334313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:03:08.439257 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m05:03:08.442305 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m05:03:08.443723 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m05:03:08.445566 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:03:08.447065 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m05:03:08.448525 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m05:03:08.450939 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:03:08.453289 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m05:03:08.454549 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m05:03:08.455705 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m05:03:08.458154 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:03:08.459209 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m05:03:08.479305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m05:03:08.491604 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m05:03:08.492895 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m05:03:08.493926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:03:08.600505 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m05:03:08.601844 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m05:03:08.602874 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'prod'
    and table_catalog = 'taxi_rides_ny'
  
[0m05:03:08.627494 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m05:03:08.632204 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m05:03:08.634937 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m05:03:08.635972 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m05:03:08.646851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c180afc-2a0a-4b64-bd9c-73b78fb12216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72584f487b60>]}
[0m05:03:08.648200 [debug] [MainThread]: Using duckdb connection "master"
[0m05:03:08.649400 [debug] [MainThread]: On master: BEGIN
[0m05:03:08.650408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:03:08.738247 [debug] [MainThread]: SQL status: OK in 0.088 seconds
[0m05:03:08.739344 [debug] [MainThread]: On master: COMMIT
[0m05:03:08.740248 [debug] [MainThread]: Using duckdb connection "master"
[0m05:03:08.741115 [debug] [MainThread]: On master: COMMIT
[0m05:03:08.742823 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:03:08.743596 [debug] [MainThread]: On master: Close
[0m05:03:08.756949 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_fhv_tripdata
[0m05:03:08.758644 [info ] [Thread-1 (]: 1 of 1 START sql view model prod.stg_fhv_tripdata .............................. [RUN]
[0m05:03:08.760066 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_fhv_tripdata'
[0m05:03:08.761015 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_fhv_tripdata
[0m05:03:08.778009 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_fhv_tripdata"
[0m05:03:08.802862 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_fhv_tripdata
[0m05:03:08.863175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_fhv_tripdata"
[0m05:03:08.889868 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:03:08.891482 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: BEGIN
[0m05:03:08.892910 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:03:08.987345 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m05:03:08.988538 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:03:08.989675 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_fhv_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_fhv_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."fhv_tripdata"
),

renamed as (

    select
        cast(dispatching_base_num as varchar) as vendor_id,
        cast(pickup_datetime as timestamp) as pickup_datetime,
        cast(dropOff_datetime as timestamp) as dropoff_datetime,
        cast(PUlocationID as integer) as pickup_location_id,
        cast(DOlocationID as integer) as dropoff_location_id,
        cast(SR_Flag as varchar) as sr_flag,
        cast(Affiliated_base_number as varchar) as affiliated_base_number,
        'fhv' as service_type

    from source
    where dispatching_base_num is not null

)

select * from renamed



  );

[0m05:03:08.992144 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:03:09.005958 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:03:09.007318 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_fhv_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_fhv_tripdata" rename to "stg_fhv_tripdata__dbt_backup"
[0m05:03:09.009705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:03:09.016854 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:03:09.018118 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_fhv_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_fhv_tripdata__dbt_tmp" rename to "stg_fhv_tripdata"
[0m05:03:09.020858 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:03:09.053867 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: COMMIT
[0m05:03:09.055222 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:03:09.056256 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: COMMIT
[0m05:03:09.071103 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m05:03:09.085656 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:03:09.087188 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "prod", "node_id": "model.dbt_project.stg_fhv_tripdata"} */
drop view if exists "taxi_rides_ny"."prod"."stg_fhv_tripdata__dbt_backup" cascade
[0m05:03:09.094426 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m05:03:09.101175 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: Close
[0m05:03:26.800742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c180afc-2a0a-4b64-bd9c-73b78fb12216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725851fec0b0>]}
[0m05:03:26.802824 [info ] [Thread-1 (]: 1 of 1 OK created sql view model prod.stg_fhv_tripdata ......................... [[32mOK[0m in 18.04s]
[0m05:03:26.804554 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_fhv_tripdata
[0m05:03:26.809705 [debug] [MainThread]: Using duckdb connection "master"
[0m05:03:26.810972 [debug] [MainThread]: On master: BEGIN
[0m05:03:26.812255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:03:26.907530 [debug] [MainThread]: SQL status: OK in 0.095 seconds
[0m05:03:26.908907 [debug] [MainThread]: On master: COMMIT
[0m05:03:26.909923 [debug] [MainThread]: Using duckdb connection "master"
[0m05:03:26.911158 [debug] [MainThread]: On master: COMMIT
[0m05:03:26.913306 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:03:26.914415 [debug] [MainThread]: On master: Close
[0m05:03:26.922141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:03:26.923376 [debug] [MainThread]: Connection 'list_taxi_rides_ny_prod' was properly closed.
[0m05:03:26.924430 [debug] [MainThread]: Connection 'model.dbt_project.stg_fhv_tripdata' was properly closed.
[0m05:03:26.925560 [info ] [MainThread]: 
[0m05:03:26.926947 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 18.81 seconds (18.81s).
[0m05:03:26.931761 [debug] [MainThread]: Command end result
[0m05:03:27.163576 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:03:27.178998 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:03:27.200964 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:03:27.202137 [info ] [MainThread]: 
[0m05:03:27.204068 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:03:27.205402 [info ] [MainThread]: 
[0m05:03:27.206818 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m05:03:27.209821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.983454, "process_in_blocks": "0", "process_kernel_time": 12.920244, "process_mem_max_rss": "1045248", "process_out_blocks": "0", "process_user_time": 53.588352}
[0m05:03:27.212928 [debug] [MainThread]: Command `dbt run` succeeded at 05:03:27.212481 after 23.99 seconds
[0m05:03:27.214267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7258459b24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72585015b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7258457eb5c0>]}
[0m05:03:27.215474 [debug] [MainThread]: Flushing usage events
[0m05:03:28.052992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:11:27.878390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779ab59113d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779ab3390710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779ab3390dd0>]}


============================== 05:11:27.893187 | 59f5a1f7-edca-4387-bc8b-efb016f6b119 ==============================
[0m05:11:27.893187 [info ] [MainThread]: Running with dbt=1.11.6
[0m05:11:27.894840 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_path': '/usr/app/logs', 'static_parser': 'True', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'invocation_command': 'dbt run --select stg_fhv_tripdata --full-refresh', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80'}
[0m05:11:28.378398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59f5a1f7-edca-4387-bc8b-efb016f6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779ab2a20cb0>]}
[0m05:11:28.530260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59f5a1f7-edca-4387-bc8b-efb016f6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779ab2b12750>]}
[0m05:11:28.532430 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m05:11:28.788617 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m05:11:29.130107 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m05:11:29.132382 [debug] [MainThread]: previous checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, current checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4
[0m05:11:29.134567 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:11:29.136084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59f5a1f7-edca-4387-bc8b-efb016f6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779ab3253650>]}
[0m05:11:36.382551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f5a1f7-edca-4387-bc8b-efb016f6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779aa876dfd0>]}
[0m05:11:36.732592 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:11:36.750677 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:11:36.828483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f5a1f7-edca-4387-bc8b-efb016f6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779aa8938f50>]}
[0m05:11:36.830266 [info ] [MainThread]: Found 9 models, 2 seeds, 34 data tests, 3 sources, 601 macros
[0m05:11:36.833576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f5a1f7-edca-4387-bc8b-efb016f6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779ab41129c0>]}
[0m05:11:36.839077 [info ] [MainThread]: 
[0m05:11:36.840541 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:11:36.841966 [info ] [MainThread]: 
[0m05:11:36.843757 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:11:36.846799 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m05:11:36.927986 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m05:11:36.929701 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"taxi_rides_ny"'
    
  
  
[0m05:11:36.932041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:11:37.053176 [debug] [ThreadPool]: SQL status: OK in 0.121 seconds
[0m05:11:37.056456 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m05:11:37.066990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m05:11:37.069267 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m05:11:37.084387 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m05:11:37.085866 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where database_name='taxi_rides_ny'
        and type='sqlite'
    
  
[0m05:11:37.086813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:11:37.187644 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m05:11:37.192730 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m05:11:37.194013 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m05:11:37.196362 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:11:37.197762 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m05:11:37.199207 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m05:11:37.201131 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:11:37.203421 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m05:11:37.204607 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m05:11:37.205793 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m05:11:37.208021 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:11:37.209258 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m05:11:37.229015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m05:11:37.243814 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m05:11:37.245059 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m05:11:37.246170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:11:37.357290 [debug] [ThreadPool]: SQL status: OK in 0.111 seconds
[0m05:11:37.358532 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m05:11:37.359864 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'taxi_rides_ny'
  
[0m05:11:37.389710 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m05:11:37.393021 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m05:11:37.396115 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m05:11:37.397554 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m05:11:37.409775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f5a1f7-edca-4387-bc8b-efb016f6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779aa898d610>]}
[0m05:11:37.411622 [debug] [MainThread]: Using duckdb connection "master"
[0m05:11:37.412547 [debug] [MainThread]: On master: BEGIN
[0m05:11:37.413652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:11:37.518916 [debug] [MainThread]: SQL status: OK in 0.105 seconds
[0m05:11:37.520348 [debug] [MainThread]: On master: COMMIT
[0m05:11:37.521570 [debug] [MainThread]: Using duckdb connection "master"
[0m05:11:37.522981 [debug] [MainThread]: On master: COMMIT
[0m05:11:37.524896 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:11:37.526020 [debug] [MainThread]: On master: Close
[0m05:11:37.544173 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_fhv_tripdata
[0m05:11:37.545740 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_fhv_tripdata ............................... [RUN]
[0m05:11:37.549531 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.dbt_project.stg_fhv_tripdata'
[0m05:11:37.551220 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_fhv_tripdata
[0m05:11:37.567957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_fhv_tripdata"
[0m05:11:37.594666 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_fhv_tripdata
[0m05:11:37.669054 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_fhv_tripdata"
[0m05:11:37.694074 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:11:37.695625 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: BEGIN
[0m05:11:37.696880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:11:37.795143 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m05:11:37.796788 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:11:37.798405 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_fhv_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_fhv_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."fhv_tripdata"
),

renamed as (

    select
        cast(dispatching_base_num as varchar) as vendor_id,
        cast(pickup_datetime as timestamp) as pickup_datetime,
        cast(dropOff_datetime as timestamp) as dropoff_datetime,
        cast(PUlocationID as integer) as pickup_location_id,
        cast(DOlocationID as integer) as dropoff_location_id,
        cast(SR_Flag as varchar) as sr_flag,
        cast(Affiliated_base_number as varchar) as affiliated_base_number,
        'fhv' as service_type

    from source
    where dispatching_base_num is not null

)

select * from renamed



where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m05:11:37.801661 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:11:37.814726 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:11:37.816881 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_fhv_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_fhv_tripdata__dbt_tmp" rename to "stg_fhv_tripdata"
[0m05:11:37.819449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:11:37.855463 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: COMMIT
[0m05:11:37.857398 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:11:37.858749 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: COMMIT
[0m05:11:37.876171 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m05:11:37.889585 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.stg_fhv_tripdata"
[0m05:11:37.890990 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_fhv_tripdata"} */
drop view if exists "taxi_rides_ny"."dev"."stg_fhv_tripdata__dbt_backup" cascade
[0m05:11:37.893304 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m05:11:37.900147 [debug] [Thread-1 (]: On model.dbt_project.stg_fhv_tripdata: Close
[0m05:11:53.607471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f5a1f7-edca-4387-bc8b-efb016f6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779ab56e41a0>]}
[0m05:11:53.609506 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.stg_fhv_tripdata .......................... [[32mOK[0m in 16.06s]
[0m05:11:53.612810 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_fhv_tripdata
[0m05:11:53.618648 [debug] [MainThread]: Using duckdb connection "master"
[0m05:11:53.619772 [debug] [MainThread]: On master: BEGIN
[0m05:11:53.620839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:11:53.751525 [debug] [MainThread]: SQL status: OK in 0.130 seconds
[0m05:11:53.754274 [debug] [MainThread]: On master: COMMIT
[0m05:11:53.755877 [debug] [MainThread]: Using duckdb connection "master"
[0m05:11:53.757541 [debug] [MainThread]: On master: COMMIT
[0m05:11:53.761324 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:11:53.766506 [debug] [MainThread]: On master: Close
[0m05:11:53.781699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:11:53.783387 [debug] [MainThread]: Connection 'list_taxi_rides_ny_dev' was properly closed.
[0m05:11:53.786338 [debug] [MainThread]: Connection 'model.dbt_project.stg_fhv_tripdata' was properly closed.
[0m05:11:53.788942 [info ] [MainThread]: 
[0m05:11:53.790583 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 16.95 seconds (16.95s).
[0m05:11:53.798089 [debug] [MainThread]: Command end result
[0m05:11:54.137549 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:11:54.155402 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:11:54.187331 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:11:54.188736 [info ] [MainThread]: 
[0m05:11:54.190509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:11:54.192237 [info ] [MainThread]: 
[0m05:11:54.195598 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m05:11:54.199392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.5047, "process_in_blocks": "0", "process_kernel_time": 12.194046, "process_mem_max_rss": "1006296", "process_out_blocks": "0", "process_user_time": 53.442127}
[0m05:11:54.201175 [debug] [MainThread]: Command `dbt run` succeeded at 05:11:54.200908 after 26.51 seconds
[0m05:11:54.202452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779ab3a1e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779aa8976960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779aa8976a80>]}
[0m05:11:54.203712 [debug] [MainThread]: Flushing usage events
[0m05:11:54.897192 [debug] [MainThread]: An error was encountered while trying to flush usage events
